<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Python Selenium</title>
  
  <!-- Meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
    <meta name="keywords" content="python,selenium">
  
  

  <!-- Feed -->
  
    <link rel="alternative" href="/atom.xml" title="SixDegree" type="application/atom+xml">
  

  <!-- CSS -->
  <link rel="stylesheet" href="/bootstrap/dist/css/bootstrap.css">
  
	
		<link rel="stylesheet" href="/highlight/styles/tomorrow-night-bright.css">
	
    
  
  <link rel="stylesheet" href="/css/fontello.css">
  <link rel="stylesheet" href="/css/style.css">

  <!-- Site Analyse -->
  
	<script>
	var userID='2bbb83cc0f781dd7502e9d5e19661866';
	var _hmt = _hmt || [];
	(function() {
	  var hm = document.createElement("script");
	  hm.src = "//hm.baidu.com/hm.js?"+userID;
	  var s = document.getElementsByTagName("script")[0]; 
	  s.parentNode.insertBefore(hm, s);
	})();
	</script>


</head>

<body data-spy="scroll" data-target="#nav-catalog">
  <div id="top-push"></div>
<a href="#top-push" id="go-top">
	<span class="glyphicon glyphicon-chevron-up"></span>
</a>
  <aside id="sidebar">
    <section class="sidebar-header">Catalog</section>
     <nav id="nav-catalog">
        <ol class="sidebar-nav nav"><li class="sidebar-nav nav-item sidebar-nav nav-level-2"><a class="sidebar-nav nav-link" href="#header-1"><span class="sidebar-nav nav-text">Install</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-2"><a class="sidebar-nav nav-link" href="#header-2"><span class="sidebar-nav nav-text">browser</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-2"><a class="sidebar-nav nav-link" href="#header-3"><span class="sidebar-nav nav-text">查找元素</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-2"><a class="sidebar-nav nav-link" href="#header-4"><span class="sidebar-nav nav-text">交互操作</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-2"><a class="sidebar-nav nav-link" href="#header-5"><span class="sidebar-nav nav-text">执行Javascript</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-2"><a class="sidebar-nav nav-link" href="#header-6"><span class="sidebar-nav nav-text">切换</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-2"><a class="sidebar-nav nav-link" href="#header-7"><span class="sidebar-nav nav-text">异常处理</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-2"><a class="sidebar-nav nav-link" href="#header-8"><span class="sidebar-nav nav-text">Cookie</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-2"><a class="sidebar-nav nav-link" href="#header-9"><span class="sidebar-nav nav-text">等待元素</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-2"><a class="sidebar-nav nav-link" href="#header-10"><span class="sidebar-nav nav-text">Reference</span></a></li></ol>
    </nav>
  </aside>
  <span id="sidebar-ctrl" class="glyphicon glyphicon-list-alt circle"></span>
  <div id="wrapper">
    <header>
  <nav class="navbar navbar-default">
    <div class="container-fluid">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#nav-menu" aria-expanded="false">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="/">SixDegree</a>
      </div>
      <div class="collapse navbar-collapse" id="nav-menu">
        <ul class="nav navbar-nav navbar-right">
          
              <li  >
                <a href="/">Blogs</a>
              </li>
          
              <li  >
                <a href="/tags.html">Tags</a>
              </li>
          
              <li  >
                <a href="/about.html">About</a>
              </li>
          
          
              <li>
                <a href="/atom.xml" target="_blank">
                  <span class="icon-rss"></span>
                </a>
              </li>
          
              <li>
                <a href="http://github.com/sixdegree" target="_blank">
                  <span class="icon-github"></span>
                </a>
              </li>
          
        </ul>
      </div>
    </div>
  </nav>
</header>



    <div class="container">
      <article class="detail" role="main">
  <section class="post-header">
    <h1 class="post-title">Python Selenium</h1>
    <ul class="post-meta">
      <li>
        <span class="glyphicon glyphicon-calendar"></span>
        <time datetime="2019-03-24T16:00:00.000Z">2019-03-25</time>
      </li>
      
        <li>
         <span class="glyphicon glyphicon-tags"></span>
          
            <a href="/tags.html#tag-Python">Python</a>
          
        </li>
      
    </ul>
  </section>
  <section class="post-content">
    <h2 id="header-1">Install</h2>
<ul>
<li><p>安装<code>selenium</code></p>
<pre><code class="lang-bash">  $ pip install selenium
  # check:
  $ python3
  &gt;&gt;&gt; from selenium import webdriver
  &gt;&gt;&gt; help(webdriver)
</code></pre>
</li>
<li><p>安装browser驱动程序,eg: chrome的<code>chromedrive</code></p>
<ul>
<li><a href="http://chromedriver.chromium.org/">download</a></li>
<li>copy to path,eg: mac <code>/usr/local/bin</code></li>
<li>check: <code>chromedriver -v</code></li>
</ul>
</li>
</ul>
<h2 id="header-2">browser</h2>
<pre><code class="lang-python">def get_browser(slience=False):
    if not slience:
        return webdriver.Chrome()                           # 会弹出一个 chrome 浏览器
    else:
        chrome_options=Options()
        chrome_options.add_argument(&#39;--headless&#39;) 
        chrome_options.add_argument(&#39;--disable-gpu&#39;)
        browser=webdriver.Chrome(options=chrome_options)    # 创建的chrome浏览器是不可见的
        return browser

def test_browser(slience=False):
    browser=get_browser(slience)
    browser.get(&#39;http://www.baidu.com&#39;)
    print(browser.page_source)
    browser.close()

if __name__==&#39;__main__&#39;:
    test_browser()
    # test_browser(slience=True)
</code></pre>
<h2 id="header-3">查找元素</h2>
<ul>
<li><code>find_element_by_xxx(...)</code>,<code>find_element(By.xxx,xxx)</code>: 返回匹配的第一个元素（<code>WebElement</code>类型对象），找不到则抛出异常</li>
<li><code>find_elements_by_xxx(...)</code>,<code>find_elements(By.xxx,xxx)</code>: 返回所有匹配的元素列表，找不到则返回空列表</li>
<li>eg: <code>find_elements(By.CSS_SELECTOR,&#39;.service-bd li&#39;)</code> = <code>find_elements_by_css_selector(&quot;.service-bd li&quot;)</code></li>
<li><code>WebElement</code>类型对象：<ul>
<li><code>.text</code> 获取文本值（它与它的所有子孙节点的文字的组合，无则返回空字符串）</li>
<li><code>.id</code></li>
<li><code>.tag_name</code></li>
<li><code>.location</code></li>
<li><code>.size</code></li>
<li><code>.get_attribute(attrName)</code> 获取属性值（无则返回None）</li>
<li><code>find_element_by_xxx / find_elements_by_xxx(...)</code></li>
<li><code>find_element / find_elements(By.xxx,xxx)</code></li>
</ul>
</li>
<li>使用:<ul>
<li>XPath<ul>
<li><code>find_element_by_xpath / find_elements_by_xpath(xpath)</code></li>
<li>eg: <code>find_element_by_xpath(&quot;//div[@class=&#39;detail&#39;]/a&quot;)</code></li>
</ul>
</li>
<li>CSS Selector<ul>
<li><code>find_element_by_css_selector / find_elements_by_css_selector(css)</code></li>
<li>eg: <code>find_element_by_css_selector(&quot;div[class=&#39;detail&#39;] &gt; div span&quot;)</code></li>
</ul>
</li>
<li>Tag<ul>
<li><code>find_element_by_id(id)</code>: 一个或异常</li>
<li><code>find_element_by_tag_name / find_elements_by_tag_name(tagName)</code></li>
<li><code>find_element_by_class_name / find_elements_by_class_name(classValue)</code>: 使用元素的class值查找元素</li>
<li><code>find_element_by_name / find_elements_by_name(name)</code>: 通过<code>name</code>属性查找</li>
<li><code>find_element_by_link_text / find_elements_by_link_text(linkText)</code>: 文本值为linkText的超级链接元素<code>&lt;a&gt;</code></li>
<li><code>find_element_by_partial_link_text / find_elements_by_partial_link_text(linkText)</code>: 文本值包含linkText的超级链接元素<code>&lt;a&gt;</code></li>
<li>eg: <code>find_element_by_class_name(&quot;p1&quot;)</code> = <code>find_elements_by_xpath(&quot;//*[@class=&#39;p1&#39;]&quot;)</code> = <code>find_elements_by_css_selector(&quot;*[class=&#39;p1&#39;]&quot;)</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code class="lang-python">def test_element():
    browser=get_browser(slience=True)
    browser.get(&#39;http://www.baidu.com&#39;)

    print(&#39;--- input ---&#39;)
    input= browser.find_element_by_id(&#39;kw&#39;)
    print_element(input)

    print(&#39;--- searchBtn ---&#39;)
    #searchBtn = browser.find_element_by_id(&#39;su&#39;)
    searchBtn=browser.find_element(By.ID,&#39;su&#39;)
    print_element(searchBtn)

def print_element(ele):
    print(&quot;id:&quot;,ele.id)
    print(&quot;tag_name:&quot;,ele.tag_name)
    print(&quot;location:&quot;,ele.location)
    print(&quot;size:&quot;,ele.size)
    print(&quot;text:&quot;,ele.text)
    print(&quot;class:&quot;,ele.get_attribute(&quot;class&quot;))
    print(&quot;name:&quot;,ele.get_attribute(&quot;name&quot;))
    print(&quot;type:&quot;,ele.get_attribute(&quot;type&quot;))
    print(&quot;value:&quot;,ele.get_attribute(&quot;value&quot;))
    print(&quot;id:&quot;,ele.get_attribute(&quot;id&quot;))
</code></pre>
<h2 id="header-4">交互操作</h2>
<p><a href="https://selenium-python.readthedocs.io/api.html#module-selenium.webdriver.common.action_chains">Refer to Action Chains</a></p>
<ul>
<li>click,click_and_hold,double_click,context_click</li>
<li>drag_and_drop,drag_and_drop_by_offset</li>
<li>key_down,key_up</li>
<li>move_by_offset,move_to_element,move_to_element_with_offset</li>
<li>pause,perform,release,reset_actions</li>
<li>send_keys,send_keys_to_element</li>
</ul>
<p><strong> Sample1: action </strong></p>
<pre><code class="lang-python">browser=webdriver.Chrome()
input= browser.find_element_by_id(&#39;kw&#39;)
input.send_keys(&quot;MakBook&quot;)
searchBtn = browser.find_element_by_id(&#39;su&#39;)
searchBtn.click()
time.sleep(2)
input.clear()
input.send_keys(&quot;ipad&quot;)
</code></pre>
<p><strong> Sample2: action_chains </strong></p>
<pre><code class="lang-python">from selenium.webdriver import ActionChains

browser=webdriver.Chrome()
browser.get(&quot;http://www.runoob.com/try/try.php?filename=jqueryui-api-droppable&quot;)
time.sleep(1)

browser.switch_to.frame(&#39;iframeResult&#39;)
source = browser.find_element_by_css_selector(&#39;#draggable&#39;)
target = browser.find_element_by_css_selector(&#39;#droppable&#39;)

actions = ActionChains(browser)
actions.drag_and_drop(source, target)
actions.perform()
time.sleep(1)
</code></pre>
<h2 id="header-5">执行Javascript</h2>
<p><code>execute_script(script)</code></p>
<pre><code class="lang-python">browser=webdriver.Chrome()
browser.execute_script(&#39;window.scrollTo(0, document.body.scrollHeight)&#39;)
browser.execute_script(&#39;alert(&quot;To Bottom&quot;)&#39;)
</code></pre>
<h2 id="header-6">切换</h2>
<ul>
<li><code>switch_to.xxx</code><ul>
<li><code>window(windowName)</code></li>
<li><code>frame(frameName)</code></li>
<li><code>parent_frame()</code></li>
<li><code>active_element()</code></li>
<li><code>default_content()</code></li>
<li><code>alert()</code></li>
</ul>
</li>
<li><code>back()</code>,<code>forward()</code></li>
</ul>
<p><strong> Sample1: window tab切换 </strong></p>
<pre><code class="lang-python"># 1. window tab切换：
# 执行js命令`window.open()`打开选项卡
# 不同的选项卡是存在`browser.window_handles`列表中
# eg: 通过`browser.window_handles[0]`可以操作第一个选项卡
def test_window():
    browser=get_browser()
    browser.get(&#39;https://www.baidu.com&#39;)
    browser.execute_script(&#39;window.open()&#39;)
    print(browser.window_handles)

    browser.switch_to.window(browser.window_handles[1])
    browser.get(&#39;https://www.douban.com/&#39;)
    time.sleep(1)

    browser.switch_to.window(browser.window_handles[0])
    browser.get(&#39;https://python.org&#39;)
    time.sleep(1)

    # 浏览器的前进和后退: back(),forward()
    browser.back()
    time.sleep(1)
    browser.forward()
    time.sleep(1)

    browser.close()
</code></pre>
<p><strong> Sample2: frame切换 </strong></p>
<pre><code class="lang-python">def test_frame():
    browser=get_browser(slience=True)
    browser.get(&#39;http://www.runoob.com/try/try.php?filename=jqueryui-api-droppable&#39;)

    browser.switch_to.frame(&#39;iframeResult&#39;)
    source = browser.find_element_by_css_selector(&#39;div#draggable&#39;)
    print(source)
    print(source.text)
    try:
        logo = browser.find_element_by_class_name(&#39;logo&#39;)
    except NoSuchElementException:
        print(&#39;NO LOGO&#39;)

    browser.switch_to.parent_frame()
    logo = browser.find_element_by_class_name(&#39;logo&#39;)
    print(logo)
    print(logo.text)
</code></pre>
<h2 id="header-7">异常处理</h2>
<p><code>selenium.common.exceptions</code></p>
<pre><code class="lang-python">from selenium import webdriver
from selenium.common.exceptions import TimeoutException, NoSuchElementException

browser=webdriver.Chrome()
try:
    browser.get(&#39;http://www.baidu.com&#39;)
    input= browser.find_element_by_id(&#39;kw&#39;)
    input.send_keys(&quot;MakBook&quot;)
    searchBtn = browser.find_element_by_id(&#39;su&#39;)
    searchBtn.click()
    print(&quot;clicked!&quot;)
    span=browser.find_element_by_xpath(&quot;//div[@id=&#39;container&#39;]//div[@class=&#39;nums&#39;]/span[@class=&#39;nums_text&#39;]&quot;)
    print(&quot;result:&quot;,span.text)
except (TimeoutException,NoSuchElementException) as e:
    print(&quot;Occur Exception:&quot;,e)
except Exception as e:
    print(&quot;Unknow Exception:&quot;,type(e),e)
finally:
    print(&quot;close!&quot;)
    browser.close()
</code></pre>
<h2 id="header-8">Cookie</h2>
<ul>
<li><code>get_cookie(name)</code></li>
<li><code>add_cookie(dict)</code>: required keys “name” and “value”</li>
<li><code>delete_cookie(name)</code></li>
<li><code>get_cookies()</code></li>
<li><code>delete_all_cookes()</code></li>
</ul>
<pre><code class="lang-python">def test_cookie():
    browser=get_browser(slience=True)
    browser.get(&#39;http://www.baidu.com&#39;)
    cookies=browser.get_cookies()
    print(cookies)
    browser.add_cookie({&#39;name&#39;:&#39;user&#39;,&#39;value&#39;:&#39;Tom&#39;})
    print(browser.get_cookie(&#39;user&#39;))
</code></pre>
<h2 id="header-9">等待元素</h2>
<ul>
<li>强制等待 <code>time.sleep(seconds)</code></li>
<li><p>隐式等待 <code>browser.implicitly_wait(seconds)</code></p>
<pre><code class="lang-python">  browser=get_browser()
  browser.get(&#39;http://www.baidu.com&#39;)
  input= browser.find_element_by_id(&#39;kw&#39;)
  input.send_keys(&quot;MakBook&quot;)
  searchBtn = browser.find_element_by_id(&#39;su&#39;)
  searchBtn.click()

  browser.implicitly_wait(3)
  span=browser.find_element_by_xpath(&quot;//div[@id=&#39;container&#39;]//div[@class=&#39;nums&#39;]/span[@class=&#39;nums_text&#39;]&quot;)
  print(span.text)
  browser.close()
</code></pre>
</li>
<li><p>显示等待</p>
<pre><code class="lang-python">  from selenium.webdriver.support.wait import WebDriverWait
  from selenium.webdriver.support import expected_conditions as EC

  browser=get_browser()
  browser.get(&#39;http://www.baidu.com&#39;)
  input= browser.find_element_by_id(&#39;kw&#39;)
  input.send_keys(&quot;MakBook&quot;)
  searchBtn = browser.find_element_by_id(&#39;su&#39;)
  searchBtn.click()

  wait=WebDriverWait(browser,10, 0.5)

  optionLocator = (By.XPATH, &quot;//select/option&quot;)
  option=wait.until(EC.presence_of_element_located(optionLocator))
  print(option)

  btnLocator=(By.CSS_SELECTOR, &#39;.btn-search&#39;)
  btn=wait.until(EC.element_to_be_clickable(btnLocator))
  print(btn)

  browser.close()
</code></pre>
<ul>
<li>EC 常用的判断条件：<ul>
<li><code>title_is</code> : 标题是某内容</li>
<li><code>title_contains</code> : 标题包含某内容</li>
<li><code>visibility_of</code> : 可见，传入元素对象</li>
<li><code>staleness_of</code> : 判断一个元素是否仍在DOM，可判断页面是否已经刷新</li>
<li><code>alert_is_present</code> : 是否出现Alert</li>
<li><code>frame_to_be_available_and_switch_to_it</code> : frame加载并切换</li>
<li><code>element_selection_state_to_be</code> : 传入元素对象以及状态，相等返回True，否则返回False</li>
<li><code>element_located_selection_state_to_be</code> : 传入定位元组以及状态，相等返回True，否则返回False</li>
<li><code>presence_of_element_located(locator)</code> : 指定元素出现，传入定位元组，如(By.ID, &#39;p&#39;)</li>
<li><code>presence_of_all_elements_located(locator)</code></li>
<li><code>invisibility/visibility_of_element_located(locator)</code>: 指定元素不可见／可见</li>
<li><code>element_to_be_clickable(locator)</code> : 指定元素可点击</li>
<li><code>element_located_to_be_selected(locator)</code> : 指定元素可选择</li>
<li><code>element_to_be_selected(element)</code></li>
<li><code>text_to_be_present_in_element(locator,text)</code> : 指定元素的文本包含指定文本</li>
<li><code>text_to_be_present_in_element_value(locator,text)</code> : 指定元素值包含某文字</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="header-10">Reference</h2>
<ul>
<li><a href="https://github.com/sixDegree/python-basic-demo">My Demo</a></li>
<li><a href="https://selenium-python.readthedocs.io/">Selenium Doc</a></li>
<li><a href="https://www.cnblogs.com/zhaof/p/6953241.html">python爬虫从入门到放弃（八）之 Selenium库的使用</a></li>
<li><a href="https://www.cnblogs.com/LOVEYU/p/8392269.html">selenium+python自动化测试系列(一)：登录</a></li>
</ul>
  </section>
</article>

      <hr/>
      
<section class="post-comment">
	
		<div id="gitment_container"></div>

<link rel="stylesheet" href="/gitment/default.css">
<script src="/gitment/gitment.browser.js"></script>


<script type="text/javascript">
	var gitment = new Gitment({
	  id: document.location.pathname,
	  owner: 'chenjin-zero',
	  repo: 'blogComment',
	  oauth: {
	    client_id: '36a09bb7399efe69c6ce',
	    client_secret: 'ad9ad546b23b708c71d92e513dc36e0486179dea',
	  }
	})
      
	gitment.render('gitment_container')
</script>
	
</section>

    </div>
  </div>
</body>

<script src="/jquery/dist/jquery.min.js"></script>
<script src="/bootstrap/dist/js/bootstrap.min.js"></script>


	<script src="/highlight/highlight.pack.js"></script>
	<script type="text/javascript">
		hljs.initHighlightingOnLoad();
	</script>






<script type="text/javascript">

  $(document).ready(function(){
    var sidebarCtrl=$("#sidebar-ctrl");
    var sidebar=$("#sidebar");
    var wrapper=$("#wrapper");
    sidebarCtrl.on("click",function(event){
        //alert("click");
        sidebar.toggleClass("sidebar-toggle");
        wrapper.toggleClass("sidebar-toggle");
        sidebarCtrl.toggleClass("sidebar-toggle");
        sidebarCtrl.toggleClass("active");
    })
  });
</script>


</html>
