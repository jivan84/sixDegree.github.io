<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Linux</title>
  
  <!-- Meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
    <meta name="keywords" content="linux,pipe,vi,shell,cmd,mount,xargs,awk,find,cut,crontab">
  
  
    <meta name="description" content="Linux and Shell Introduce">
  

  <!-- Feed -->
  
    <link rel="alternative" href="/atom.xml" title="SixDegree" type="application/atom+xml">
  

  <!-- CSS -->
  <link rel="stylesheet" href="/bootstrap/dist/css/bootstrap.css">
  
    <link rel="stylesheet" href="/highlight/demo/styles/tomorrow-night-bright.css">
  
  <link rel="stylesheet" href="/css/fontello.css">
  <link rel="stylesheet" href="/css/style.css">

  <!-- Site Analyse -->
  
	<script>
	var userID='2bbb83cc0f781dd7502e9d5e19661866';
	var _hmt = _hmt || [];
	(function() {
	  var hm = document.createElement("script");
	  hm.src = "//hm.baidu.com/hm.js?"+userID;
	  var s = document.getElementsByTagName("script")[0]; 
	  s.parentNode.insertBefore(hm, s);
	})();
	</script>


</head>

<body data-spy="scroll" data-target="#nav-catalog">
  <div id="top-push"></div>
<a href="#top-push" id="go-top">
	<span class="glyphicon glyphicon-chevron-up"></span>
</a>
  <aside id="sidebar">
    <section class="sidebar-header">Catalog</section>
     <nav id="nav-catalog">
        <ol class="sidebar-nav nav"><li class="sidebar-nav nav-item sidebar-nav nav-level-2"><a class="sidebar-nav nav-link" href="#header-1"><span class="sidebar-nav nav-text">Starter</span></a><ol class="sidebar-nav nav-child"><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-2"><span class="sidebar-nav nav-text">特点</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-3"><span class="sidebar-nav nav-text">历史</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-4"><span class="sidebar-nav nav-text">运行级别</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-5"><span class="sidebar-nav nav-text">分区</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-6"><span class="sidebar-nav nav-text">文件系统</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-7"><span class="sidebar-nav nav-text">管道</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-8"><span class="sidebar-nav nav-text">环境变量</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-9"><span class="sidebar-nav nav-text">vi 编辑器</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-10"><span class="sidebar-nav nav-text">Shell</span></a></li></ol></li><li class="sidebar-nav nav-item sidebar-nav nav-level-2"><a class="sidebar-nav nav-link" href="#header-11"><span class="sidebar-nav nav-text">常用命令</span></a><ol class="sidebar-nav nav-child"><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-12"><span class="sidebar-nav nav-text">ls mv rm</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-13"><span class="sidebar-nav nav-text">tar,gzip,zip</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-14"><span class="sidebar-nav nav-text">ps,kill</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-15"><span class="sidebar-nav nav-text">jobs,fg,bg</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-16"><span class="sidebar-nav nav-text">du,mount</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-17"><span class="sidebar-nav nav-text">重执行命令</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-18"><span class="sidebar-nav nav-text">cut</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-19"><span class="sidebar-nav nav-text">find</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-20"><span class="sidebar-nav nav-text">xargs</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-21"><span class="sidebar-nav nav-text">awk</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-22"><span class="sidebar-nav nav-text">crontab</span></a></li></ol></li><li class="sidebar-nav nav-item sidebar-nav nav-level-2"><a class="sidebar-nav nav-link" href="#header-23"><span class="sidebar-nav nav-text">Shell</span></a><ol class="sidebar-nav nav-child"><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-24"><span class="sidebar-nav nav-text">C Shell</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-25"><span class="sidebar-nav nav-text">K Shell</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-26"><span class="sidebar-nav nav-text">B Shell</span></a></li></ol></li></ol>
    </nav>
  </aside>
  <span id="sidebar-ctrl" class="glyphicon glyphicon-list-alt circle"></span>
  <div id="wrapper">
    <header>
  <nav class="navbar navbar-default">
    <div class="container-fluid">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#nav-menu" aria-expanded="false">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="/">SixDegree</a>
      </div>
      <div class="collapse navbar-collapse" id="nav-menu">
        <ul class="nav navbar-nav navbar-right">
          
              <li  >
                <a href="/">Blogs</a>
              </li>
          
              <li  >
                <a href="/tags.html">Tags</a>
              </li>
          
              <li  >
                <a href="/about.html">About</a>
              </li>
          
          
              <li>
                <a href="/atom.xml" target="_blank">
                  <span class="icon-rss"></span>
                </a>
              </li>
          
              <li>
                <a href="http://github.com/sixdegree" target="_blank">
                  <span class="icon-github"></span>
                </a>
              </li>
          
        </ul>
      </div>
    </div>
  </nav>
</header>



    <div class="container">
      <article class="detail" role="main">
  <section class="post-header">
    <h1 class="post-title">Linux</h1>
    <ul class="post-meta">
      <li>
        <span class="glyphicon glyphicon-calendar"></span>
        <time datetime="2014-06-30T16:00:00.000Z">2014-07-01</time>
      </li>
      
        <li>
         <span class="glyphicon glyphicon-tags"></span>
          
            <a href="/tags.html#tag-Linux">Linux</a>
          
        </li>
      
    </ul>
  </section>
  <section class="post-content">
    <h2 id="header-1">Starter</h2>
<h3 id="header-2">特点</h3>
<ul>
<li>优点：<ul>
<li>免费，开源</li>
<li>支持多线程，多用户</li>
<li>安全性好</li>
<li>对内存和文件管理优越</li>
<li>linux 最小只需 4M    =&gt; 嵌入式开发</li>
</ul>
</li>
<li>缺点：<ul>
<li>操作相对困难</li>
</ul>
</li>
</ul>
<h3 id="header-3">历史</h3>
<ol>
<li>1960 麻省理工学院 30 个人同时使用</li>
<li>1965 mit,ge,bell 30 =&gt;300 个人分时操作，multis计划【火星计划】</li>
<li>1969 火星计划失败，ken开发了一个file server system【文件系统】</li>
<li>1973 unix诞生 开源<ul>
<li>IBM：        aix</li>
<li>Sun：         solaris</li>
<li>Hp：         hp-Unix</li>
<li>伯克利分校： bsd</li>
</ul>
</li>
<li>minix系统</li>
<li>linus 芬兰 PC386 =&gt; 将minix移植到PC,1991=&gt; 1994(1.0) linux[linus is not unix]</li>
<li>RedHat红帽子公司<ul>
<li>s.u.s.e</li>
<li>红旗linux</li>
<li>Ubuntu</li>
</ul>
</li>
</ol>
<h3 id="header-4">运行级别</h3>
<ul>
<li>运行级别：<ul>
<li>0    关机</li>
<li>1    单用户</li>
<li>2    多用户，无网络服务</li>
<li>3    多用户，有网络服务</li>
<li>4    系统未使用，保留给用户</li>
<li>5    图形界面</li>
<li>6    系统重启</li>
</ul>
</li>
<li>常用运行级别 3/5</li>
<li><code>init[0123456]</code> 启动</li>
<li>修改运行级别 <code>/etc/inittab</code> =&gt; <code>id:5:initdefault</code> 修改这行中的数字</li>
<li>解决错误配置后无法启动：<ul>
<li>在进入grub引导程序时，按e</li>
<li>选择第二行，输入e</li>
<li>在最后输入 1 回车，代表单用户级别（ 因为单用户模式不读取 <code>/etc/inittab</code>文件 ）</li>
<li>按 b ，重新启动进入了单用户模式，再修改该配置文件</li>
</ul>
</li>
</ul>
<h3 id="header-5">分区</h3>
<ul>
<li>基本分区（Primary Partion）<ul>
<li>可以马上使用，单不能在分区</li>
</ul>
</li>
<li>扩展分区（Extension Partion）<ul>
<li>需进行二次分区后才可使用</li>
<li>即逻辑分区（Logical Partion），且无数量限制</li>
</ul>
</li>
<li>硬盘<ul>
<li>一块硬盘上： 基本分区（主分区）+扩展分区个数&lt;=4</li>
<li>硬盘分两种：IDE/SCSI （”sdx~” / “hdx~”）<ul>
<li><code>sd</code> :SCSI硬盘(较好)</li>
<li><code>hd</code> :IDE硬盘</li>
<li><code>x</code>  :盘号 (a 基本盘，b基本从属盘，c铺助盘，d铺助从属盘 )</li>
<li><code>~</code>  :分区 ( 1-4 主分区或扩展盘 ,5 开始为逻辑分区 )</li>
</ul>
</li>
</ul>
</li>
<li>相关命令：<ul>
<li><code>mount [-参数] [设备名称] [挂载点]</code></li>
<li><code>umount [设备名称]</code></li>
<li><code>df</code>           【查看磁盘使用情况】</li>
<li><code>df -l</code>        【查看某个目录在哪个分区】</li>
<li><code>df -h</code></li>
<li><code>fdisk -l</code>    【查看linux系统分区具体情况】</li>
</ul>
</li>
</ul>
<h3 id="header-6">文件系统</h3>
<p>级层式的树状目录结构，根目录 <code>/</code></p>
<ul>
<li><code>root</code> 【存放root用户的相关文件】</li>
<li><code>home</code> 【存放普通用户的相关文件】</li>
<li><code>bin</code> 【存放常用命令】</li>
<li><code>sbin</code> 【存放需具有一定权限才可使用的命令】</li>
<li><code>mnt</code>     【默认挂载软驱，光驱的目录】</li>
<li><code>etc</code>     【存放系统配置与管理的相关文件】</li>
<li><code>var</code> 【存放经常变化的文件，具有变动性质的相关程序目录】</li>
<li><code>boot</code> 【存放系统启动时的引导文件】</li>
<li><code>usr</code>     【程序默认安装处】</li>
<li><code>dev</code>     【接口设备文件目录，如had表示硬盘】</li>
<li><code>proc</code> 【目前系统核心与程序执行的信息】</li>
</ul>
<pre><code class="nullbash">&gt; ls -l
-rw-r--r--| 1 | tom | policeman  |    11 |  Dec 9 09:32   | myTest.java
</code></pre>
<ul>
<li><code>-|rw-|r--|r--</code> 文件类型及权限<ul>
<li>文件类型<ul>
<li><code>-</code>代表普通文件</li>
<li><code>d</code>代表文件夹 (其实也是个文件)</li>
<li><code>l</code>代表链接</li>
</ul>
</li>
<li>文件的所有者对该文件的权限</li>
<li>文件所在组的其他用户对该文件的权限</li>
<li>其他组的用户对该文件的权限</li>
</ul>
</li>
<li><code>1</code><ul>
<li>若myTest.java是个文件，则为 1</li>
<li>若myTest.java是个文件夹，则表示次文件夹下有多少个文件</li>
</ul>
</li>
<li><code>tom</code> 文件所有者</li>
<li><code>policeman</code> 文件所在组</li>
<li><code>11</code> 文件大小</li>
<li><code>Dec 9 09:32</code> 最后修改日期</li>
<li><code>myTest.java</code> 文件名</li>
</ul>
<p>文件使用：</p>
<ol>
<li><p>组</p>
<ul>
<li><code>groupadd policeman</code>        【添加组】</li>
<li><code>cat /etc/group | more</code>    【查看所有linux中所有组信息】</li>
<li>eg：<code>policeman:x:503</code><ul>
<li>x   ：密码（加密了）</li>
<li>503 ：代表policeman这个组的id</li>
</ul>
</li>
</ul>
</li>
<li><p>用户</p>
<ul>
<li><code>useradd -g 组名 用户名</code> 【创建用户，并将该用户分配到指定组中】</li>
<li><code>passwd xxxxx</code>                【设置密码】</li>
<li><code>usermod -g 组名 用户名</code> 【改变某个用户所在组（root才可操作）】</li>
<li><code>userdel 用户名</code>    【删除用户】</li>
<li><code>userdel -r tom</code>        【删除用户以及该用户主目录】</li>
<li><p>eg：</p>
<pre><code class="nullbash">&gt; useradd -g policeman tom`
&gt; cat /ect/password | more

tom:x:503:503::/home/tom:/bin/bash
(用户名):(密码):(用户ID):(用户所在组ID)::(用户主目录):(此用户使用的Shell解析器)
</code></pre>
</li>
</ul>
</li>
<li><p>文件owner</p>
<ul>
<li><code>chown 用户名 文件名</code>【修改文件的所有者】</li>
<li><code>chgrp 组名 文件名</code>    【修改文件的所在组】<br>+<code>ls -ahl</code>     【查看文件的所有者】</li>
<li><code>who am i</code>【查看当前用户】</li>
<li>eg:<pre><code class="nullbash">&gt; chown wang myTest.java
&gt; chown root ./tom
&gt; chown -R root ./tom    【改变tom这个目录及其下所有文件和目录的所有者为root】
</code></pre>
</li>
</ul>
</li>
<li><p>文件访问权限（只有 root 和此文件的所有者可修改）</p>
<ul>
<li>权限分三组：<ul>
<li>文件所有者(o)</li>
<li>同组用户(g)</li>
<li>其余用户(a)</li>
</ul>
</li>
<li>每组权限分为3位：<ul>
<li>r(read) 可读，用 4 表示</li>
<li>w(write) 可写，用 2 表示</li>
<li>x(execute) 可执行，用 1 表示</li>
</ul>
</li>
<li>权限是相加的，例如：<ul>
<li>rwx是7</li>
<li>rw是6</li>
</ul>
</li>
<li>当对文件进行访问时，内核就检查进程关联的ID和该ID对应的权限位是否符合要求</li>
<li>操作与权限<table class="table">
<thead>
<tr>
<th>操作</th>
<th>需要的权限</th>
</tr>
</thead>
<tbody>
<tr>
<td>创建/删除/改名 文件</td>
<td>对父目录的w和x权限，以及所有祖先目录的x权限</td>
</tr>
<tr>
<td>修改文件权限</td>
<td>有效用户ID是文件所有者，或者拥有root权限</td>
</tr>
<tr>
<td>修改文件内容</td>
<td>对父目录的x权限，以及所有祖先目录的x权限</td>
</tr>
<tr>
<td>列出目录的文件列表</td>
<td>对父目录的rx权限，以及所有祖先目录的x权限</td>
</tr>
<tr>
<td>修改文件的所有者</td>
<td>拥有root权限</td>
</tr>
</tbody>
</table>
</li>
<li>对于目录文件(文件夹)<ul>
<li>读取权限：列出文件夹里文件列表的权限</li>
<li>写入权限：修改文件夹里的文件的名字的权限</li>
<li>执行权限：进入文件夹的权限</li>
</ul>
</li>
<li>eg:<pre><code class="nullbash">&gt; chmod 777 tom
&gt; chmod 770 tom
&gt; chmod u=rwx,g=rx,o=rx tom
&gt; chmod u-x,g+w tom
&gt; chmod a+r tom
</code></pre>
</li>
<li>注意：修改某文件夹的权限，不代表该文件夹下的文件的权限也跟着修改</li>
</ul>
</li>
<li><p>文件三个主要的变动时间：</p>
<ul>
<li>modification time (mtime)：<ul>
<li>当该文件的『内容数据』变更时，就会升级这个时间</li>
<li>内容数据指的是文件的内容，而不是文件的属性或权限</li>
</ul>
</li>
<li>status time (ctime)：<ul>
<li>当该文件的『状态 (status)』改变时，就会升级这个时间</li>
<li>举例来说，像是权限与属性被更改了，都会升级这个时间</li>
</ul>
</li>
<li>access time (atime)：<ul>
<li>当『该文件的内容被取用』时，就会升级这个读取时间 (access)</li>
<li>举例来说，我们使用 cat 去读取 /etc/man.config，就会升级该文件的 atime</li>
</ul>
</li>
<li>示例:<pre><code class="nullbash">&gt; ls -l /etc/man.config
-rw-r--r-- 1 root root 4617 Jan  6  2007 /etc/man.config
&gt; ls -l --time=atime /etc/man.config
-rw-r--r-- 1 root root 4617 Sep 25 17:54 /etc/man.config
&gt; ls -l --time=ctime /etc/man.config
-rw-r--r-- 1 root root 4617 Sep  4 18:03 /etc/man.config
</code></pre>
</li>
</ul>
</li>
<li><p>修改文件时间或建置新档： <code>touch</code></p>
</li>
<li><p>共享</p>
<ul>
<li>windows &lt;=&gt; windows 使用网络邻居实现文件共享</li>
<li>windows &lt;=&gt; linux 使用samba服务</li>
</ul>
</li>
</ol>
<h3 id="header-7">管道</h3>
<ul>
<li><code>stdin(fd=0)</code> 标准输入 （文件描述符为0）</li>
<li><code>stdout(fd=1)</code> 标准输出（文件描述符为1）</li>
<li><code>stderr(fd=2)</code> 标准错误输出 （文件描述符为2）</li>
<li><code>&gt;</code> 将stdout定向输出到文件<ul>
<li>如果文件不存在，就创建文件；</li>
<li>如果文件存在，就将其清空；</li>
<li>相当于 <code>1&gt;</code>，不包括stderr</li>
<li><code>&gt;&amp;</code> 将stdout与stderr一起导向</li>
<li><code>(command &gt; stdout_file) &gt; &amp;stderr_file</code> 把stderr和stdout分开导向<pre><code>2 &gt; file.txt    # 将文件句柄2(即stderr)重定向到文件file.txt中
2 &gt; &amp;1          # 将文件句柄2(即stderr)重定向到文件句柄1(即stdout)指向的文件中
test.sh &gt; /tmp/test.log 2&gt;&amp;1
</code></pre></li>
</ul>
</li>
<li><code>&gt;&gt;</code> 将stdout追加到目标文件中<ul>
<li>如果文件不存在，就创建文件；</li>
<li>如果文件存在，则将新的内容追加到那个文件的末尾</li>
</ul>
</li>
<li><code>|</code> 管道，连结上个指令的标准输出，做为下个指令的标准输入<ul>
<li><code>cmd1 | cmd2</code> 将cmd1 的 stdout 作为 cmd2 的 stdin</li>
<li><code>cmd1 | &amp; cmd2</code> stderr合并到stdout, 然后管道到下一条命令</li>
</ul>
</li>
</ul>
<h3 id="header-8">环境变量</h3>
<pre><code class="nullbash"><span class="hljs-comment"># 查看环境变量</span>
&gt; env

<span class="hljs-comment"># 查看某个环境变量</span>
&gt; <span class="hljs-built_in">echo</span> 变量名

<span class="hljs-comment"># 设置一个新变量</span>
&gt; <span class="hljs-built_in">export</span> 变量名=变量值

<span class="hljs-comment"># 在原变量值得基础上更新</span>
&gt; <span class="hljs-built_in">export</span> 变量名=$变量名:xxx

<span class="hljs-comment"># 清除某环境变量</span>
&gt; <span class="hljs-built_in">unset</span> 变量名
</code></pre>
<p>例如：</p>
<pre><code class="nullbash"><span class="hljs-built_in">export</span> TEST=<span class="hljs-string">"test"</span>      <span class="hljs-comment"># 增加一个变量</span>
env|grep TEST           <span class="hljs-comment"># 输出结果:   TEST=test</span>
<span class="hljs-built_in">unset</span> TEST              <span class="hljs-comment"># 删除</span>
env|grepTEST            <span class="hljs-comment"># 没有输出,证明变量TEST已不存在</span>
</code></pre>
<ul>
<li><code>/etc/profile</code> 全局的环境变量文件，只要登陆系统的用户都会执行里面的ENV环境变量设置</li>
<li><code>～/.profile</code>     用户环境变量<ul>
<li>在用户主目录下</li>
<li>用户登陆时会执行此文件里的ENV环境变量设置</li>
<li>执行<code>. ~/.profile</code>立即生效</li>
</ul>
</li>
<li><code>~/.kshrc</code>，<code>~/.bshrc</code>,<code>~/.cshrc</code> shell环境变量<ul>
<li>在用户主目录下</li>
<li>执行对应Shell下面的子shell时会执行此文件里的ENV环境变量设置</li>
<li>执行<code>. ~/.kshrc</code>/<code>~/.bshrc</code>/<code>~/.cshrc</code>立即生效</li>
</ul>
</li>
<li>注意<ul>
<li>root用户的环境变量在<code>/etc/profile</code>下</li>
<li>从普通用户su到root时，环境变量设置可能不生效，需<code>su - root</code></li>
<li>处理直接执行配置文件外，也可使用<code>source</code>命令使配置生效</li>
</ul>
</li>
</ul>
<h3 id="header-9">vi 编辑器</h3>
<ol>
<li><code>vi Hello.java</code></li>
<li><code>i</code>                    【进入到插入模式insert】</li>
<li><code>esc</code>键                 【命令模式切换】</li>
<li>输入冒号 <code>：</code></li>
<li><code>wq</code>        【保存退出】; <code>q!</code>       【退出不保存】</li>
</ol>
<p>说明：</p>
<ul>
<li><code>w</code>         【写入保存】</li>
<li><code>q</code>         【退出，若内容修改，vi会报错】 </li>
<li><code>q!</code>        【强制离开vi，并不保存文件】</li>
<li><code>wq</code>        【保存并退出vi】</li>
<li><code>set nu</code>     【在文件每行行处加入行号】</li>
<li><code>set nonu</code>     【取消行号】</li>
<li>输入数字，再按<code>esc</code>键 【将光标移至该行行首】</li>
<li><code>/字符串</code>     【查找字符串，按n键往下继续查找】</li>
<li><code>?字符串</code>     【查找字符串，按n键往上继续查找】</li>
</ul>
<h3 id="header-10">Shell</h3>
<table class="table">
<thead>
<tr>
<th>Shell名称</th>
<th>开发者</th>
<th>命令名称</th>
</tr>
</thead>
<tbody>
<tr>
<td>Bourne</td>
<td>S.R.Bourne</td>
<td>/bin/bash</td>
</tr>
<tr>
<td>C</td>
<td>Bill Joy</td>
<td>/bin/csh</td>
</tr>
<tr>
<td>Kom</td>
<td>David</td>
<td>/bin/ksh</td>
</tr>
</tbody>
</table>
<ul>
<li><code>env</code>            【显示当前操作系统的环境变量】</li>
<li><code>chsh -s 新的shell</code>    【修改当前使用的shell】<ul>
<li>eg: <code>chsh -s /bin/csh</code> (生效需注销重新登录下)</li>
</ul>
</li>
<li>修改User的默认shell,有两种方式:<ul>
<li>直接修改 <code>/etc/passwd</code> 文件（eg： <code>/sbin/sh</code> =&gt; <code>/bin/bsh</code>）</li>
<li><code>usermod -s /usr/bin/bash root</code></li>
</ul>
</li>
<li>shell 解释为内核可执行的代码<ul>
<li>命令(eg:cp,mkdir)  &lt;=&gt; Shell  &lt;=&gt;linux内核</li>
</ul>
</li>
</ul>
<h2 id="header-11">常用命令</h2>
<pre><code class="nullbash">shutdown -h now     立即进行关机
shutdown -r now     现在重新启动计算机
reboot            现在重新启动计算机
startx             进入图形界面

su -         切换用户
<span class="hljs-built_in">logout</span>    用户注销
tab 快捷键，自动补全

man         【相当于<span class="hljs-built_in">help</span>】
dir
ls -a         【显示隐藏文件】
ls -l         【显示长列表格式】
<span class="hljs-built_in">cd</span>          【改变目录】
<span class="hljs-built_in">pwd</span>       【显示当前工作目录】
mkdir     【建立目录】
rmdir     【删除空目录】
touch     【建立空文件】
more         【分页显示，上一页ctrl+pageUp】

cp              【复制命令】    
cp -r dir1 dir2     【递归复制命令】    eg:  cp a.out /home/tom/

mv
rm 
rm -rf             【删除所有内容，r表示递归，f表示强制】

ln                 【建立符合连接】
ln -s 源目标
ln -s /etc/inittab inittab 【inittab 指向实际文件 /etc/inittab】

find 目录 -name aaa.java
find 目录 -amin -10 【 10分钟内存取的文件或目录 atime小时】
find 目录 -cmin -10 【 10分钟内更改的文件或目录 ctime小时 +表示前】
find 目录 -size +10k【 大小为10k的文件 】

shell <span class="hljs-built_in">history</span> 查阅历史记录命令
<span class="hljs-built_in">history</span> 5 【 显示最近使用的5个命令 】
!5          【 执行历史编号为5的命令 】
!ls          【 执行最后一次以ls开头的命令 】
</code></pre>
<pre><code class="nullbash">&gt; uname
SunOS

&gt; uname -n
SZ1SA006

&gt; hostname
SZ1SA006

&gt; logname
cim1tdtp

&gt; <span class="hljs-built_in">echo</span> <span class="hljs-variable">$LOGNAME</span>
cim1tdtp

&gt; whoami     <span class="hljs-comment"># 显示有效的当前用户</span>
cim1tdtp
</code></pre>
<h3 id="header-12">ls mv rm</h3>
<ol>
<li><p><code>ls</code>列出文件 / 文件夾  ls</p>
<pre><code class="nullbash"> <span class="hljs-comment"># 列出文件夾個數</span>
 ls -l | grep ^d | wc -l

 <span class="hljs-comment"># 列出非文件夾個數</span>
 ls -l | grep -v ^d | wc -l

 <span class="hljs-comment"># ls -F: 把文件按照类型归类（会在末尾加上/ *等符号标识）</span>
 <span class="hljs-comment"># grep /$ 挑出以/结尾的行 ；PS:/标识是目录</span>
 ls -F | grep /$
</code></pre>
</li>
<li><p><code>mv</code> 移动/重命名</p>
<pre><code class="nullbash"> mv MCK9[1-3]* 2009\.
 cat temp.txt | xargs -n1 -i mv {} 2011/
</code></pre>
</li>
<li><p><code>rm</code> 刪除文件或目錄</p>
<pre><code class="nullbash"> rm [-dfirv][--<span class="hljs-built_in">help</span>][--version][文件或目录...]
</code></pre>
</li>
</ol>
<ul>
<li><code>-d</code>,<code>--directory</code>  删除目录。</li>
<li><code>-f</code>,<code>--force</code>    强制删除文件或目录（即使原档案属性设为唯读，也直接删除，无需逐一确认）</li>
<li><code>-i</code>，<code>--interactive</code>    删除前逐一询问确认。</li>
<li><code>-r</code>,<code>-R</code>,<code>--recursive</code>  递归处理，将指定目录下的所有文件及子目录一并处理。</li>
<li><code>-v</code>,<code>--verbose</code> 显示指令执行过程。</li>
<li><code>--help</code>  在线帮助。</li>
<li><code>--version</code> 显示版本信息</li>
<li><p>注意：删除目录必须加上参数<code>-r</code>，否则预设仅会删除文件</p>
<pre><code class="nullbash">  <span class="hljs-comment">#刪除文件</span>
  rm file

  <span class="hljs-comment">#删除所有C语言程式档；删除前逐一询问确认</span>
  rm -i *.c

  <span class="hljs-comment">#刪除文件夾</span>
  rm -r dir

  <span class="hljs-comment">#批量刪除符合條件的文件</span>
  ls -d * | grep -v tar | xargs -n5 rm -r
</code></pre>
</li>
</ul>
<h3 id="header-13">tar,gzip,zip</h3>
<pre><code class="nullbash">ls -d * | xargs -n5 -i tar -cf {}.tar {}
ls -d * | xargs -n5 -i zip -r <span class="hljs-string">"{}.zip"</span> {}
</code></pre>
<ol>
<li><p>tar</p>
<ul>
<li>参数：<ul>
<li><code>-c</code>   创建一个新归档</li>
<li><code>-x</code>   从归档中抽取文件</li>
<li><code>-f</code><ul>
<li>与 <code>-c</code> 选项一起使用时，创建的 tar 文件使用该选项指定的文件名；</li>
<li>与<code>-x</code>选项一起使用时，则解除该选项指定的归档</li>
</ul>
</li>
<li><code>-t</code>   显示包括在 tar 文件中的文件列表</li>
<li><code>-v</code>   显示文件的归档进度</li>
<li><code>-z</code>   使用 gzip 来压缩 tar 文件</li>
<li><code>-j</code>   使用 bzip2 来压缩 tar 文件</li>
</ul>
</li>
<li>包 (.tar文件)<ul>
<li>打包： <code>tar cvf FileName.tar DirName</code></li>
<li>解包： <code>tar xvf FileName.tar</code></li>
<li>注：tar是打包，不是压缩！</li>
</ul>
</li>
<li>压缩包 (.tar.Z)<ul>
<li>解压：<code>tar Zxvf FileName.tar.Z</code></li>
<li>压缩：<code>tar Zcvf FileName.tar.Z DirName</code></li>
</ul>
</li>
<li><p>示例：</p>
<pre><code class="nullbash"><span class="hljs-comment"># 将test文件夹打包为test.tar</span>
tar cvf test.tar <span class="hljs-built_in">test</span>                <span class="hljs-comment">#將test文件夾打包為test.tar</span>
<span class="hljs-comment"># 将test.tar包进行压缩为test.tar.Z文件</span>
compress test.tar

<span class="hljs-comment"># 解压FileName.Z文件</span>
uncompress FileName.Z

<span class="hljs-comment"># 一步到位，直接解压解包</span>
uncompress &lt; test.tar.Z | tar xf
</code></pre>
</li>
</ul>
</li>
<li><p>gzip</p>
<ul>
<li>参数：<ul>
<li><code>-c</code> 将输出写到标准输出上，并保留原有文件。</li>
<li><code>-d</code> 将压缩文件解压。</li>
<li><code>-l</code> 对每个压缩文件，显示下列字段：</li>
<li><code>-r</code> 递归式地查找指定目录并压缩其中的所有文件或者是解压缩。</li>
<li><code>-t</code> 测试，检查压缩文件是否完整。</li>
<li><code>-v</code> 对每一个压缩和解压的文件，显示文件名和压缩比。</li>
<li><code>-num</code> 用指定的数字num调整压缩的速度<ul>
<li><code>-1</code>或<code>--fast</code>表示最快压缩方法（低压缩比）</li>
<li><code>-9</code>或<code>--best</code>表示最慢压缩方法（高压缩比）</li>
<li>系统缺省值为6</li>
</ul>
</li>
</ul>
</li>
<li><p>示例：</p>
<pre><code class="nullbash"><span class="hljs-comment"># 压缩</span>
gzip FileName

<span class="hljs-comment"># 解压缩</span>
gzip -dv FileName
</code></pre>
</li>
</ul>
</li>
<li><p>zip/unzip</p>
<pre><code class="nullbash">zip [参数] [打包后的文件名] [打包的目录路径]
</code></pre>
</li>
</ol>
<ul>
<li>参数：<ul>
<li><code>-a</code>     将文件转成ASCII模式</li>
<li><code>-F</code>     尝试修复损坏的压缩文件</li>
<li><code>-h</code>     显示帮助界面</li>
<li><code>-m</code>     将文件压缩之后，删除源文件</li>
<li><code>-n</code> 特定字符串    不压缩具有特定字尾字符串的文件</li>
<li><code>-o</code>     将压缩文件内的所有文件的最新变动时间设为压缩时候的时间</li>
<li><code>-q</code>     安静模式，在压缩的时候不显示指令的执行过程</li>
<li><code>-r</code>     将指定的目录下的所有子目录以及文件一起处理</li>
<li><code>-S</code>     包含系统文件和隐含文件（S是大写）</li>
</ul>
</li>
<li><p>示例</p>
<pre><code class="nullbash">  <span class="hljs-comment">#压缩文件夹</span>
  zip -r test.zip <span class="hljs-built_in">test</span>

  <span class="hljs-comment">#解压</span>
  unzip test.zip
</code></pre>
</li>
<li>更多<a href="http://www.cnblogs.com/say0507/archive/2011/03/31/2001459.html" target="_blank" rel="noopener">参考</a></li>
</ul>
<h3 id="header-14">ps,kill</h3>
<p>查杀进程</p>
<pre><code class="nullbash">ps -ef | grep nationz | grep <span class="hljs-string">"sh -c"</span> | awk <span class="hljs-string">'{print $2}'</span> | xargs -i <span class="hljs-built_in">kill</span> -9 {}
ps -e -o pid -o comm
ps -ax -o pid -o comm | grep oic
ps -ax -o pid -o comm | grep oic
ps -e -o pid -o comm | grep oic | awk <span class="hljs-string">'{print $1}'</span> | xargs -n2 -i <span class="hljs-built_in">kill</span> -9 {}
<span class="hljs-built_in">kill</span> -9 `ps -a -o pid -o comm | grep oic | awk <span class="hljs-string">'{print $1}'</span>`
</code></pre>
<h3 id="header-15">jobs,fg,bg</h3>
<pre><code class="nullbash">&gt; sleep 15 &amp;
[1] 2706

<span class="hljs-comment">#列出当前活动作业</span>
&gt; <span class="hljs-built_in">jobs</span>
[1]  + Running              sleep 15

<span class="hljs-comment"># 显示作业号，PID</span>
<span class="hljs-comment"># jobs -l</span>
[1]  +  2706 Running              sleep 15

&gt; <span class="hljs-built_in">jobs</span>
[1]    Done                 sleep 15

&gt; sleep 15            <span class="hljs-comment">#按^Z停止sleep命令（sleep没有使用CPU但被挂起在后台）</span>
^Z
Stopped (user)

&gt; <span class="hljs-built_in">bg</span>                <span class="hljs-comment">#使最后一个后台作业在后台开始执行</span>
[1]  + sleep 15 &amp;
&gt; <span class="hljs-built_in">jobs</span>
[1]  + Running              sleep 15

&gt; <span class="hljs-built_in">fg</span> %1            <span class="hljs-comment">#将编号为[1]的作业拿到前台</span>
sleep 15
</code></pre>
<h3 id="header-16">du,mount</h3>
<ol>
<li><p><code>du</code> 查看文件或者目录大小</p>
<ul>
<li><code>-a</code>：显示全部目录和其次目录下的每个档案所占的磁盘空间 </li>
<li><code>-b</code>：大小用bytes来表示 (默认值为k bytes) </li>
<li><code>-c</code>：最后再加上总计 (默认值) </li>
<li><code>-s</code>：只显示各档案大小的总合 (summarize) </li>
<li><code>-x</code>：只计算同属同一个档案系统的档案 </li>
<li><code>-L</code>：计算所有的档案大小</li>
<li>常用：<code>du -sm</code>，<code>du -sh</code>. 查询档案或目录的磁盘使用空间</li>
<li><code>fdisk</code>: 查看硬件分区的大小的<ul>
<li>一般使用：<code>fdisk -l</code></li>
<li>如果挂载了多块硬盘，每个硬盘有多个分区，就是用fdisk</li>
</ul>
</li>
<li>eg:<pre><code class="nullbash">du -a
du -h | awk <span class="hljs-string">'$1 ~ /G/'</span>
du -h | awk <span class="hljs-string">'$1 ~ /M/'</span>
du -ks /tmp
df -k
</code></pre>
</li>
</ul>
</li>
<li><p>装载 mount</p>
<pre><code class="nullbash"> <span class="hljs-comment"># 装载</span>
 mount [-t vfstype] [-o options] device dir

 <span class="hljs-comment"># 卸载</span>
 umount dir
</code></pre>
</li>
</ol>
<ul>
<li><code>-a</code> 将 <code>/etc/fstab</code> 中定义的所有档案系统挂上</li>
<li><code>-f</code>伪装mount，作出检查设备和目录的样子，但并不真正挂载文件系统。</li>
<li><code>-n</code> 不把安装记录在/etc/mtab 文件中。</li>
<li><code>-r</code> 讲文件系统安装为只读。</li>
<li><code>-v</code> 详细显示安装信息。</li>
<li><code>-w</code> 将文件系统安装为可写，为命令默认情况。</li>
<li><code>-t</code>  指定设备的文件系统类型<ul>
<li><code>ext2</code>  linux目前常用的文件系统 </li>
<li><code>msdos</code>  MS-DOS的fat，就是fat16 </li>
<li><code>vfat</code>  windows98常用的fat32 </li>
<li><code>nfs</code>  网络文件系统 </li>
<li><code>iso9660</code>  CD-ROM光盘标准文件系统 </li>
<li><code>ntfs</code>  windows NT/2000/XP的文件系统 </li>
<li><code>auto</code> 自动检测文件系统 </li>
</ul>
</li>
<li><p><code>-o</code>  指定挂载文件系统时的选项，有些也可写到在/etc/fstab中</p>
<ul>
<li><code>defaults</code> 使用所有选项的默认值（auto、nouser、rw、suid）</li>
<li><code>auto</code>/<code>noauto</code> 允许/不允许以 –a选项进行安装</li>
<li><code>dev</code>/<code>nodev</code> 对/不对文件系统上的特殊设备进行解释</li>
<li><code>exec</code>/<code>noexe</code>c 允许/不允许执行二进制代码</li>
<li><code>suid</code>/<code>nosuid</code> 确认/不确认suid和sgid位</li>
<li><code>user</code> /<code>nouser</code> 允许/不允许一般用户挂载</li>
<li><code>codepage=XXX</code> 代码页 </li>
<li><code>iocharset=XXX</code> 字符集 </li>
<li><code>ro</code> 以只读方式挂载 </li>
<li><code>rw</code> 以读写方式挂载 </li>
<li><code>remount</code> 重新安装已经安装了的文件系统</li>
</ul>
</li>
<li><p>例如：</p>
<pre><code class="nullbash">  mount 10.7.33.25:/cim1_release /cim
  umount /cim
</code></pre>
</li>
<li><p>注意：</p>
<ul>
<li>挂载点(dir)：必须是一个已经存在的目录（目录可以不为空，但挂载后原内容将不可用，umount后恢复正常）</li>
<li>开机重启后自动挂载，需将挂载设置在<code>/etc/vfstab</code>文件中<ul>
<li>例如：将<code>10.7.33.25:/cim1_release/ - /cim nfs - yes bg,soft</code>添加到文件中</li>
</ul>
</li>
</ul>
</li>
<li><p>更多<a href="http://www.cnblogs.com/xd502djj/p/3809375.html" target="_blank" rel="noopener">参考</a></p>
</li>
</ul>
<h3 id="header-17">重执行命令</h3>
<ul>
<li><p><code>!</code>  执行来自历史清单的一个命令</p>
<ul>
<li><code>!^</code> 取得第1个变元</li>
<li><code>!$</code> 取得最后一个变元</li>
<li><code>!*</code> 取得所有变元</li>
<li><p><code>!:2</code> 取得第2个变元</p>
<pre><code class="nullbash">cat file1 file2 file3
( 0     1        2     3   )

ls !:2    <span class="hljs-comment"># ls file2</span>
ls !^    <span class="hljs-comment"># ls file1</span>
ls !$    <span class="hljs-comment"># ls file3</span>
ls !*    <span class="hljs-comment"># ls file1 file2 file3</span>
!!:p        <span class="hljs-comment"># ls file1 file2 file3     (打印但不执行历史清单中的最后一个命令，更新历史清单)</span>
</code></pre>
<pre><code class="nullbash"><span class="hljs-comment"># 从历史清单中取得最后一个命令重新执行</span>
!!

<span class="hljs-comment"># 重新执行历史清单中的第三个命令</span>
!3

<span class="hljs-comment"># 重新执行历史清单中以d开头的最后一个命令</span>
!d
</code></pre>
</li>
</ul>
</li>
<li><code>^</code> 编辑前一个命令的一种快捷方法<pre><code class="nullbash"><span class="hljs-comment"># 替换历史清单中最后一个命令中的字母</span>
<span class="hljs-comment"># 用一个t取得第一次出现的r</span>
^r^t
</code></pre>
</li>
</ul>
<h3 id="header-18">cut</h3>
<pre><code class="nullbash">cut -b|c|f list [-d delim][-s][file ...]
</code></pre>
<p>从指定的范围中提取信息</p>
<ul>
<li><p>提取形式：</p>
<ul>
<li><code>-b</code>    表示字节，即byte</li>
<li><code>-c</code>    表示字符，即character</li>
<li><code>-f</code>     表示字段，即field</li>
</ul>
</li>
<li><p>提取范围（具体数字，从1开始计数）：</p>
<ul>
<li><code>m</code> 第m个字节或字符或字段</li>
<li><code>m-</code> 从第m个字节或字符或字段到文件结束</li>
<li><code>m-n</code> 从第m个到第n个字节或字符或字段</li>
<li><code>-n</code> 从第1个到第n个字节或字符或字段</li>
</ul>
</li>
<li><p>提取设置：</p>
<ul>
<li><code>-d</code> 用来定义分隔符(delimiter)，默认为tab键</li>
<li><code>-s</code> 表示不包括哪些不含分隔符的行（有利于去掉注释和标题）</li>
</ul>
</li>
</ul>
<p>示例：</p>
<pre><code class="nullbash">cut -c 1-5,10-14 <span class="hljs-built_in">test</span>
cut -f 1,3 <span class="hljs-built_in">test</span>
cut -d<span class="hljs-string">'|'</span> -f2  1.test &gt; 2.test
cut -d<span class="hljs-string">':'</span> -f1,2  1.test &gt; 2.test 
cut -d<span class="hljs-string">':'</span> -f1-4 /etc/passwd | head -10
cut -d<span class="hljs-string">':'</span> -f 1-4 /etc/passwd | head -10
</code></pre>
<h3 id="header-19">find</h3>
<pre><code class="nullbash">find  path  -option  [  -<span class="hljs-built_in">print</span> ]  [ -<span class="hljs-built_in">exec</span>|-ok  <span class="hljs-built_in">command</span> ]  {} \;
</code></pre>
<ul>
<li><p><code>path</code>:     查找目录</p>
<ul>
<li><code>~</code>表示<code>$HOME</code>目录</li>
<li><code>.</code> 当前目录</li>
<li><code>/</code> 根目录</li>
</ul>
</li>
<li><p><code>-option</code>：命令选项</p>
<ul>
<li><code>-name xxx</code> 使用某种文件名模式来匹配文件<ul>
<li><code>find . -name &quot;[A-Z]*&quot; -print</code></li>
</ul>
</li>
<li><code>-type b|d|c|p|l|f</code> 查找某一类型的文件(块设备、目录、字符设备、管道、符号链接、普通文件)<ul>
<li><code>find /etc -type d -print</code> 在/etc目录下查找所有的目录</li>
<li><code>find . ! -type d -print</code>    在当前目录下查找除目录以外的所有类型的文件</li>
<li><code>find /etc -type l -print</code> 在/etc目录下查找所有的符号链接文件</li>
</ul>
</li>
<li><code>-size  n[c]</code>  按照文件长度来查找文件查<ul>
<li>这里所指的文件长度既可以用块（block）或字节（byte）来计量</li>
<li>在按照文件长度查找文件时，一般使用以字节表示文件长度</li>
<li>在查看文件系统的大小时，一般使用块来计量</li>
<li><code>find . -size +1000000c -print</code> 在当前目录下查找文件长度大于1 M字节的文件</li>
<li><code>find /home/apache -size 100c -print</code>  在/home/apache目录下查找文件长度恰好为100字节的文件</li>
<li><code>find . -size +10 -print</code>    在当前目录下查找长度超过10块的文件（一块等于512字节）</li>
</ul>
</li>
<li><code>-perm</code> 按照文件执行权限查找<ul>
<li><code>-perm mode</code>:文件许可正好符合mode</li>
<li><code>-perm +mode</code>:文件许可部分符合mode</li>
<li><code>-perm -mode</code>: 文件许可完全符合mode</li>
<li>eg: <code>find . -perm 755 -print</code></li>
</ul>
</li>
<li><code>-prune</code> 指出需要忽略的目录<ul>
<li>如果同时使用<code>-depth</code>选项，那么<code>-prune</code>将被忽略</li>
<li><code>find [-path ..] [expression]</code> （表达式按顺序求值）</li>
<li>eg：在<code>/apps</code>目录下查找不在<code>bin</code>子目录之内的所有文件</li>
<li><code>find /apps -path &quot;/apps/bin&quot; -prune -o -print</code> 与 <code>find /apps -path &quot;/apps/bin&quot; -a -prune -o -print</code>等同</li>
<li><code>-a</code> 和 <code>-o</code> 都是短路求值，与 shell 的 <code>&amp;&amp;</code> (and)和 <code>||</code> (or)类似</li>
<li>伪码相当于: <code>if -path &quot;/usr/sam&quot;  then    -prune    else    -print</code></li>
<li><code>find /usr/sam  \(-path /usr/sam/dir1 -o -path /usr/sam/file1 \) -prune -o -name &quot;temp&quot; -print</code> 避开多个文件夹，<code>-name</code>在<code>-o</code>之后</li>
</ul>
</li>
<li><code>-depth</code>   首先匹配所有的文件然后再进入子目录中查找<ul>
<li>默认find将遍历所有子目录</li>
<li>如果只想搜索当前目录，可以添加 <code>-maxdepth 0</code> 表示只检验命令行给定的文件</li>
</ul>
</li>
<li><code>-follow</code> 跟踪符号链接所指向的文件</li>
<li><code>-mount</code>   查文件时不跨越文件系统mount点<ul>
<li><code>find . -name &quot;*.XC&quot; -mount -print</code>    从当前目录开始查找位于本文件系统中文件名以XC结尾的文件</li>
</ul>
</li>
<li><code>-newer</code>    查找比某个文件新或旧的文件<ul>
<li><code>-newer  f1 !f2</code>      #查更改时间比f1新但比f2旧的文件</li>
</ul>
</li>
<li><code>-ctime</code>,<code>-atime</code>,<code>-mtime</code> 按文件 创建|访问|更改 时间来查找文件<ul>
<li><code>-n</code>指n天以内</li>
<li><code>+n</code>指n天以前</li>
</ul>
</li>
<li><code>-user xxx</code>,<code>nouser</code>    按照文件属主来查找文件<ul>
<li><code>find ~ -user sam -print</code></li>
<li><code>find /etc -user uucp -print</code>    在/etc目录下查找文件属主为uucp的文件</li>
<li><code>find /home -nouser -print</code> 查找属主帐户已经被删除的文件（即找到那些属主在/etc/passwd文件中没有有效帐户的文件）</li>
</ul>
</li>
<li><code>-group xxx</code>,<code>nogroup</code> 按文件所属于的用户组查找文件<ul>
<li><code>find /apps -group gem -print</code></li>
<li><code>find / -nogroup -print</code> 查找无有效所属组的文件（即该文件所属的组在/etc/groups中不存在）</li>
</ul>
</li>
</ul>
</li>
<li><p><code>-print</code>:    将匹配的文件输出到标准输出</p>
<ul>
<li>只会输出从当前路径起的相对路径及文件名</li>
</ul>
</li>
<li><code>-exec</code>，<code>-ok</code>:    执行shell命令，参数为匹配的文件<ul>
<li><code>-exec  command  {} \;</code>：将查到的文件执行command操作</li>
<li><code>-ok  command  {} \;</code>: 与<code>-exec</code>一样，不过执行操作前会询问</li>
<li>注意：必须要使用<code>-print</code>选项；<code>{}</code>和<code>\</code> 间有空格</li>
<li><code>find logs -type f -mtime +5 -exec rm {  } \;</code> 在/logs目录中查找更改时间在5日以前的文件并删除它们</li>
</ul>
</li>
</ul>
<p>注意：</p>
<p>使用<code>-exec</code>时，find命令将所有匹配到的文件一起传递给exec执行<br>可能会出现溢出错误（参数列太长”，“参数列溢出”，…）<br>可能会出现进程过多，系统性能下降的问题（有些系统中会为处理每一个匹配到的文件而发起一个相应的进程）<br>建议使用<code>xargs</code>分批获取和传入参数，且只有一个进程，eg：</p>
<pre><code class="nullbash"><span class="hljs-comment"># 查找系统中的每一个普通文件，然后使用xargs命令来测试它们分别属于哪类文件</span>
&gt; find . -<span class="hljs-built_in">type</span> f -<span class="hljs-built_in">print</span> | xargs file

./.kde/Autostart/Autorun.desktop: UTF-8 Unicode English text
./.kde/Autostart/.directory:      ISO-8859 text\
......
</code></pre>
<p>使用示例：</p>
<pre><code class="nullbash"><span class="hljs-comment"># 当前目录下查找所有用户具有读、写和执行权限的文件，并收回相应的写权限</span>
find . -perm -7 -<span class="hljs-built_in">print</span> | xargs chmod o-w

<span class="hljs-comment"># 用grep命令在所有的普通文件中搜索hostname这个词</span>
find . -<span class="hljs-built_in">type</span> f -<span class="hljs-built_in">print</span> | xargs grep <span class="hljs-string">"hostname"</span>    

<span class="hljs-comment"># 查找系统中所有文件长度为0的普通文件，并列出它们的完整路径</span>
find / -<span class="hljs-built_in">type</span> f -size 0 -<span class="hljs-built_in">exec</span> ls -l {  } \;

<span class="hljs-comment"># 让当前目录中文件属主具有读、写权限，并且文件所属组的用户和其他用户具有读权限的文件</span>
find . -<span class="hljs-built_in">type</span> f -perm 644 -<span class="hljs-built_in">exec</span> ls -l {  } \;

<span class="hljs-comment"># 查找/var/logs目录中更改时间在7日以前的普通文件，并在删除之前询问它们</span>
find /var/logs -<span class="hljs-built_in">type</span> f -mtime +7 -ok rm {  } \;    

<span class="hljs-comment">#查找系统中所有属于root组的文件</span>
find . -group root -<span class="hljs-built_in">exec</span> ls -l {  } \;

<span class="hljs-comment"># 删除当目录中访问时间在7日以来、含有数字后缀的admin.log文件</span>
find . -name <span class="hljs-string">"admin.log[0-9][0-9][0-9]"</span> -atime -7  -ok rm {  } \;

<span class="hljs-comment">#查找当前文件系统中的所有目录并排序</span>
find . -<span class="hljs-built_in">type</span> d | sort

<span class="hljs-comment"># 从当前目录开始，向下扫描查找类型是普通文件的所有.html文件</span>
find -name <span class="hljs-string">"*.html"</span> -<span class="hljs-built_in">type</span> f    

<span class="hljs-comment"># 返回文件权限和时间信息(-iname：表示区分大小写)</span>
find -user chen -iname <span class="hljs-string">"*.html"</span> -ls

<span class="hljs-comment"># 在/logos 下查找5天内修改的普通日志文件并删除</span>
find /logos -<span class="hljs-built_in">type</span> f -mtime -5 -<span class="hljs-built_in">exec</span> rm {} /;

<span class="hljs-comment">#查找2004-11-30 16:36:37时更改过的文件</span>
find ./ -name <span class="hljs-string">"*php"</span> |  ls -l --full-time <span class="hljs-variable">$A</span> 2&gt;/dev/null | grep <span class="hljs-string">"2004-11-30 16:36:37"</span>

<span class="hljs-comment"># 文件查找</span>

find . -ctime +365  -<span class="hljs-built_in">type</span> d -<span class="hljs-built_in">exec</span> ls -ld {} \; &gt;test.txt
find . -ctime +365  -<span class="hljs-built_in">type</span> d -<span class="hljs-built_in">exec</span> ls -ld {} \; &gt;test.txt

find . -name <span class="hljs-string">"*.txt"</span> -<span class="hljs-built_in">print</span> 
find . -name *.* -ctime -365 -<span class="hljs-built_in">type</span> d -<span class="hljs-built_in">exec</span> mv {} temp/ \;
find . -name *.* -ctime -365 -<span class="hljs-built_in">type</span> d -<span class="hljs-built_in">exec</span> mv {} temp/ \;
find . -name *.gz -ctime -365 -<span class="hljs-built_in">exec</span> ls -l {} \

find .  -<span class="hljs-built_in">type</span> d -<span class="hljs-built_in">exec</span> ls -ld {} \; &gt;test.txt
find .  -<span class="hljs-built_in">type</span> d -<span class="hljs-built_in">exec</span> ls -ld {} \; &gt;test.txt
</code></pre>
<h3 id="header-20">xargs</h3>
<p><code>xargs [-0epns] [ command [initial-arguments] ]</code></p>
<blockquote>
<p>build and execute command lines from standard input</p>
</blockquote>
<ul>
<li>字面意义上：x 是乘号，args 是 arguments (参数) ，则xargs的意思就是产生某个指令的参数</li>
<li>xargs 可读入 stdin 的资料，以空白字元或断行字元作分辨，将 stdin 的资料分隔成 args<ul>
<li>使用其他某个命令并将前一个命令的输出作为参数</li>
<li>将参数列表转换成小块分段传递给其他命令，以避免参数列表过长的问题</li>
</ul>
</li>
<li>xargs本身虽然没有多大用处，但在与其他命令相结合时，它的功能非常强大</li>
<li>注意：因为是以空白字元作为分隔，所以如果有一些档名或者是其他意义的名词内含有空白字元的时候，xargs 可能会误判</li>
</ul>
<p>參數：</p>
<ol>
<li><p><code>-i</code> 选项告诉xargs用每项的名称替换<code>{}</code></p>
<pre><code class="nullbash"> find ./ -<span class="hljs-built_in">type</span> f -<span class="hljs-built_in">print</span> | xargs -i mv -f {} ./newdir
</code></pre>
</li>
<li><p><code>-t</code>选项指示xargs先打印要运行的命令，然后再执行</p>
<pre><code class="nullbash">  ls | xargs -t -i mv {} {}.bak
</code></pre>
</li>
<li><p><code>-0</code> 将输入的特殊字元（例如<code>,</code>, <code>\</code>, 空白键等）还原成一般字元，可用于正确地处理了新行和空格</p>
<pre><code class="nullbash"> <span class="hljs-comment"># 查找tmp目录下以core命名的文件，然后删除</span>

 <span class="hljs-comment"># 如果文件名字包含新行或者空格的话，这条命令将会被错误操作</span>
  find /tmp -name core -<span class="hljs-built_in">type</span> f -<span class="hljs-built_in">print</span> | xargs /bin/rm -f

 <span class="hljs-comment"># 这条命令就正确地处理了新行和空格，有可能带来的错误</span>
 find /tmp -name core -<span class="hljs-built_in">type</span> f -print0 | xargs -0 /bin/rm -f
</code></pre>
</li>
<li><p><code>-p</code> 它使操作具有可交互性，在执行每个指令的 argument 时，都会询问使用者的意思：</p>
<pre><code class="nullbash"><span class="hljs-comment"># xarg要求在运行每个命令之前进行确认，按下"y"，则执行</span>
file * | grep ASCII | cut -d<span class="hljs-string">":"</span> -f1 | xargs -p vi 
vi alert_DBA102.log dba102_cjq0_14493.trc dba102_mmnl_14497.trc dba102_reco_14491.trc dba102_rvwr_14518.trc ?...
</code></pre>
</li>
<li><p><code>-r</code> 如果没有要运行的内容，该命令退出：</p>
<pre><code class="nullbash">file * | grep SSSSSS | cut -d<span class="hljs-string">":"</span> -f1 | xargs -t -r wc -l $
</code></pre>
</li>
<li><p><code>-n</code> 指定每次从输入源中取几行数据（限制单个命令行的参数个数）：</p>
<pre><code class="nullbash"> <span class="hljs-comment"># 限制每个命令行仅使用两个参数</span>
 file * | grep ASCII | cut -d<span class="hljs-string">":"</span> -f1 | xargs -t -n2 ls -ltr
</code></pre>
</li>
<li><p><code>-e</code>  : EOF (end of file) 后面可接一个字串，代表结束标识（当 xargs 分析到这个字串时，就会停止继续工作）</p>
<pre><code class="nullbash"><span class="hljs-comment"># 当分析到 lp 就结束这串指令 (注意 -e'lp' 是连在一起的，中间没有空白键)</span>
cut -d<span class="hljs-string">':'</span> -f1 &lt; /etc/passwd | xargs -e<span class="hljs-string">'lp'</span> finger
</code></pre>
</li>
<li><p><code>-s</code> : 每次的输出的最大bytes</p>
</li>
</ol>
<p>示例：</p>
<ol>
<li><p>将 <code>/etc/passwd</code> 的第一栏取出，仅取三行，使用 <code>finger</code> 这个指令秀出每个帐号内容</p>
<ul>
<li>由 finger account 可以取得该帐号的相关说明内容</li>
<li>利用 cut 取出帐号名称</li>
<li>用 head 取出三个帐号</li>
<li><p>由 xargs 将三个帐号的名称变成 finger 后面需要的参数</p>
<pre><code class="nullbash">&gt; cut -d <span class="hljs-string">':'</span> -f1 &lt; /etc/passwd | head -n 3 | xargs finger    

Login name: root                        In real life: Super-User
Directory: /                            Shell: /sbin/sh
Last login Thu Jan  5 08:44 on pts/2 from 10.7.82.110
New mail received Sun Feb  5 14:00:26 2012;
unread since Thu Feb 21 11:53:16 2008
No Plan.

Login name: daemon
Directory: /
Never logged <span class="hljs-keyword">in</span>.
No unread mail
No Plan.

Login name: bin
Directory: /usr/bin
Never logged <span class="hljs-keyword">in</span>.
No unread mail
No Plan.
</code></pre>
</li>
</ul>
</li>
<li><p>删除数量比较多的文件</p>
<ul>
<li><code>ls</code> 输出所有的文件名(用空格分割) </li>
<li><code>xargs</code>将ls的输出，每20个为一组(以空格为分隔符)，作为<code>rm -rf</code>的参数</li>
<li>即将所有文件名20个为一组，由<code>rm -rf</code>删除，这样就不会超过命令行的长度了<pre><code class="nullbash">ls | xargs -n 20 rm -fr
</code></pre>
</li>
</ul>
</li>
<li><p>迁移文件</p>
<pre><code class="nullbash"> cat temp.txt | xargs -n1 -i mv {} bak/
 ls *100[9]* | xargs -t -i mv {} <span class="hljs-string">"/db/data/autoftp/sent/tsmc/stdfbak/"</span>
 ls *100[7]*.gz | xargs -t -i -n1  mv {} <span class="hljs-string">"/db/data/autoftp/sent/tsmc/stdfbak/"</span>{}
</code></pre>
</li>
<li><p><code>xargs</code>与<code>grep</code>使用比较</p>
<ul>
<li><code>XXX | grep –i ‘hello’</code>        <ul>
<li>grep通过管道读取XXX的输出结果，并在该结果中搜索hello</li>
</ul>
</li>
<li><code>XXX | xargs grep –i ‘hello’</code><ul>
<li>xargs通过管道读取XXX的输出结果，并将该结果作为grep的最后的FILE参数</li>
<li><code>grep –i ‘hello’</code> 组合成完整的命令（如 <code>grep –i ‘hello’ stdio.h stdlib.h</code>）后，执行</li>
<li>例如：<code>find . -name &quot;*.foo&quot; | xargs grep bar</code>大体等价于<code>grep bar `find . -name &quot;*.foo&quot;` </code></li>
</ul>
</li>
<li>两者对于管道的输出作不同的处理:<ul>
<li>前者是grep直接从stdin中读取管道数据，并搜索。</li>
<li>后者是xargs直接从stdin中读取管道数据，并和<code>grep –i ‘hello’</code>组合，然后调用<code>exec</code>执行该命令</li>
</ul>
</li>
</ul>
</li>
</ol>
<h3 id="header-21">awk</h3>
<p>文本分析工具</p>
<pre><code class="nullbash">nawk <span class="hljs-string">'/pattern/{action}'</span> filename
cmd | nawk <span class="hljs-string">'/pattern/{action}'</span> filename
</code></pre>
<ul>
<li>把文件逐行的读入，以空格为默认分隔符将每行切片，切开的部分再进行各种分析处理</li>
<li><code>pattern</code> 表示 AWK 在数据中查找的内容，可使用正则表达式（正则表达式需用斜杠括起来）</li>
<li><code>action</code> 是在找到匹配内容时所执行的一系列命令</li>
<li><code>-F</code> 域分隔符，默认是空格</li>
<li><p>内置变量：</p>
<ul>
<li><code>ARGC</code>               命令行参数个数</li>
<li><code>ARGV</code>              命令行参数数组</li>
<li><code>ENVIRON</code>         支持队列中系统环境变量的使用</li>
<li><code>FILENAME</code>       awk浏览的文件名</li>
<li><code>FNR</code>                浏览文件的记录数</li>
<li><code>NF</code>                当前记录中的字段数（记录域个数）</li>
<li><code>NR</code>                当前已读的记录数</li>
<li><code>OFS</code> 设置输出域分隔符，默认为空格</li>
<li><code>FS</code>   设置输入域分隔符，默认为空格，/,跳個符（等价于命令行 <code>-F</code>选项）</li>
<li><code>ORS</code>  输入记录分隔符</li>
<li><code>RS</code>     输出记录分隔符</li>
<li><code>OFMT</code>    控制打印數，默認為 <code>%.6g</code>(打印精確到小數點后6位)</li>
<li><code>$0</code>        整條記錄</li>
<li><code>$1</code> 表示当前行的第一个域</li>
</ul>
</li>
<li><p>內置函数</p>
<ul>
<li>sub,gsub,length,match,split</li>
<li>算数运算函数：int,log,sin,sqrt,rand,srand</li>
<li>打印输出函数：print，printf<ul>
<li><code>print \b,\f,\n,\r,\t,\c</code></li>
<li><code>printf %c,%d,%e,%f,%o,%s,%x</code> 格式化特制的輸出</li>
<li>eg:<pre><code class="nullbash">{<span class="hljs-built_in">print</span> <span class="hljs-string">"\t\tHave a nice day,"</span> <span class="hljs-variable">$1</span>,<span class="hljs-variable">$2</span> <span class="hljs-string">"\!"</span>}
{<span class="hljs-built_in">printf</span> <span class="hljs-string">"%The name is: -15s ;ID is %8d\n"</span>,<span class="hljs-variable">$1</span>,<span class="hljs-variable">$3</span>}
</code></pre>
</li>
</ul>
</li>
<li>用户自定义函数</li>
</ul>
</li>
<li>编程：<code>if/else</code>,<code>BEGIN/END</code>,<code>while</code>,<code>for</code></li>
<li><p>示例：</p>
<pre><code class="nullbash">  <span class="hljs-comment"># pattern</span>
  nawk <span class="hljs-string">'/Mary/'</span> file1.txt
  nawk <span class="hljs-string">'$1 ~ /[Bb]ill/'</span> file2.txt

  <span class="hljs-comment"># action：print</span>
  nawk <span class="hljs-string">'{print $1,$2}'</span> file1.txt
  nawk  <span class="hljs-string">'/^[A-Z][a-z]+/{print "Hello "$0}'</span> file1.txt

  <span class="hljs-comment"># -F</span>
  nawk -F: <span class="hljs-string">'/Tom Jones/{print $0,NF}'</span> file1.txt
  nawk -F<span class="hljs-string">'[ :\t]'</span> <span class="hljs-string">'/Tom Jones/{print $0,NF}'</span> file1.txt

  <span class="hljs-comment"># argv</span>
  nawk <span class="hljs-string">'BEGIN{print substr(ARGV[1],11,1)}'</span> <span class="hljs-variable">$argv</span>[2]

  <span class="hljs-comment"># cmd | awk</span>
  ps -ef | grep ftp | grep Feb | awk <span class="hljs-string">'{print $11}'</span> | uniq | more

  <span class="hljs-comment"># 批量重命名</span>
  ls *.tar | awk -F<span class="hljs-string">"."</span> <span class="hljs-string">'{print $1"."$2"."$3"."$4,$1"."$2"."$3".1"}'</span>| xargs -n2 mv
  ls * | awk -F<span class="hljs-string">"."</span> <span class="hljs-string">'{print $1"."$2"."$3,$1"."$2}'</span> | xargs -n2 mv
  ls * | awk -F<span class="hljs-string">"."</span> <span class="hljs-string">'{print $1"."$2"."$3,$1"."$2"."$3".1"}'</span> | xargs -n2 mv
</code></pre>
</li>
</ul>
<p>awk编程示例：</p>
<ol>
<li><p>解析文档（关联数组，统计，printf，算数运算，sort应用）</p>
<pre><code class="nullbash"> <span class="hljs-comment">#! /bin/csh</span>
  <span class="hljs-built_in">echo</span> Begin
  <span class="hljs-built_in">set</span> resultFile = myResult.txt
  <span class="hljs-comment"># get head </span>
  <span class="hljs-comment">#head -8 Testdata.log | awk -F, '{print $1":"$2}'     &gt; $resultFile</span>
  awk -F, <span class="hljs-string">'NR==1 {print $1":"$2 }'</span> Testdata.log    &gt; <span class="hljs-variable">$resultFile</span>
  nawk -F, <span class="hljs-string">'NR==2 {print $1":"tolower($2) }'</span> Testdata.log &gt;&gt; <span class="hljs-variable">$resultFile</span>
  awk -F, <span class="hljs-string">'NR==3,NR==8 {print $1":"$2 }'</span> Testdata.log &gt;&gt; <span class="hljs-variable">$resultFile</span>

  <span class="hljs-built_in">echo</span> StartDate:`awk -F, <span class="hljs-string">'NR==9{print $2}'</span> Testdata.log | cut -c1-8`  &gt;&gt; <span class="hljs-variable">$resultFile</span>
  <span class="hljs-built_in">echo</span> StartTime:`awk -F, <span class="hljs-string">'NR==9{print $2}'</span> Testdata.log | cut -c9-14` &gt;&gt; <span class="hljs-variable">$resultFile</span>

 <span class="hljs-comment"># get Passdie,Grossdie,Yeild</span>
 awk -F, <span class="hljs-string">'NR&gt;10 { grossdie++;if($5=="P") count++}END
 {printf("Passdie:%d\nGrossdie:%d\nYield:%.2f\n\n",count,grossdie,count/grossdie*100)} '</span> Testdata.log     &gt;&gt;<span class="hljs-variable">$resultFile</span>

 <span class="hljs-comment"># get x,y,bin,site,status,[ bin Summary ]</span>
 awk -F, <span class="hljs-string">'NR&gt;10{print "x="$1,"y="$2,"bin="$3,"site="$4,"status="$5}'</span> Testdata.log &gt;&gt; <span class="hljs-variable">$resultFile</span>
 <span class="hljs-built_in">echo</span> &gt;&gt; <span class="hljs-variable">$resultFile</span>
 <span class="hljs-built_in">echo</span> <span class="hljs-string">"[bin summary]"</span> &gt;&gt; <span class="hljs-variable">$resultFile</span>
 <span class="hljs-built_in">echo</span> &gt;&gt; <span class="hljs-variable">$resultFile</span>
 awk -F, <span class="hljs-string">'NR&gt;10{count[$3]++;}END{for(i in count){print "bin"i":"count[i] | "sort -t: +0.3n"}}'</span> Testdata.log      &gt;&gt; <span class="hljs-variable">$resultFile</span>
 <span class="hljs-built_in">echo</span> End\!
 <span class="hljs-built_in">exit</span>
</code></pre>
<pre><code class="nullbash"> awk -F, <span class="hljs-string">'NR&gt;10{count[$3]++; print "x="$1,"y="$2,"bin="$3,"site="$4,"status="$5 }END{ printf("\n[bin     summary]\n"); for(i in count){print "bin"i":"count[i] | "sort -t: +0.3n" };Close "sort -t: +0.3n"}'</span> Testdata.log
</code></pre>
</li>
<li><p>根据传入参数去除重复行</p>
</li>
</ol>
<ul>
<li><p>输入源</p>
<pre><code class="nullbash">  &gt; cat uniqueTest.txt

  222|15|2401668|3273877|4114|1|
  222|15|2401444|3273847|3274|1|
  222|15|2401444|32722200|4124|1|
  222|15|2401474|32253847|7419|1|
</code></pre>
</li>
<li><p>去除重复的行</p>
<pre><code class="nullbash">  <span class="hljs-comment"># 根据第三列判断重复行</span>
  &gt; awk -F<span class="hljs-string">"|"</span> <span class="hljs-string">'{a[$3]=$0}END{for (i in a) print a[i]}'</span>  uniqueTest.txt

  222|15|2401444|32722200|4124|1|
  222|15|2401474|32253847|7419|1|
  222|15|2401668|3273877|4114|1|

  <span class="hljs-comment"># 根据第三第四列组合判断重复行</span>
  &gt; awk -F<span class="hljs-string">"|"</span> <span class="hljs-string">'{a[$3$4]=$0;b[$3$4]=NR}END{for (i in a) print b[i] " " a[i]}'</span>  uniqueTest.txt

  3 222|15|2401444|32722200|4124|1|
  2 222|15|2401444|3273847|3274|1|
  4 222|15|2401474|32253847|7419|1|
  1 222|15|2401668|3273877|4114|1|
</code></pre>
</li>
<li><p>传入参数</p>
<pre><code class="nullbash">  &gt; <span class="hljs-built_in">set</span> xField = 3
  &gt; <span class="hljs-built_in">set</span> yField=4
  &gt; awk -F<span class="hljs-string">"|"</span> <span class="hljs-string">'{a[$x$y]=$0;b[$x$y]=NR}END{for (i in a) print b[i] " " a[i]}'</span> x=<span class="hljs-string">"<span class="hljs-variable">$xField</span>"</span> y=<span class="hljs-string">"<span class="hljs-variable">$yField</span>"</span> uniqueTest.txt
</code></pre>
</li>
</ul>
<h3 id="header-22">crontab</h3>
<p>基本格式：<code>M   H   D   m   d   cmd</code></p>
<ul>
<li>M:     分鐘（0-59）   </li>
<li>H:    小時（0-23）   </li>
<li>D:    天（1-31）   </li>
<li>m:     月（1-12）   </li>
<li>d:     一星期內的天（0~6，0為星期天）</li>
<li>cmd：要運行的程序，程序被送入shell執行</li>
<li>例如：<pre><code class="nullbash"><span class="hljs-comment"># MIN   HOUR   DAY   MONTH   DAYOFWEEK  COMMAND</span>
10         6          *           *           *               date       test.sh <span class="hljs-comment"># 每天早上6:10   </span>
0         */2         *           *           *               date       test.sh <span class="hljs-comment"># 每隔两小时</span>
0     23-7/2，8         *          *           *               date  test.sh <span class="hljs-comment"># 晚上11点到早上7点之间，每隔一小时</span>
0         11          4         *           mon-wed            date    test.sh <span class="hljs-comment"># 每月的4号与每星期一至星期三的早上11点</span>
</code></pre>
</li>
</ul>
<p>crontab命令：</p>
<ul>
<li><code>crontab file [-u   user]</code>    用指定的文件替代目前的crontab.</li>
<li><code>crontab    -[-u user]</code>            用標准輸入替代目前的crontab.</li>
<li><code>crontab    -l[user]</code>            列出用戶目前的crontab.</li>
<li><code>crontab    -e[user]</code>            編輯用戶目前的crontab.</li>
<li><code>crontab    -d[user]</code>            刪除用戶目前的crontab.</li>
<li><code>crontab    -c dir</code>                指定crontab的目錄</li>
<li>eg: 列出用戶目前的crontab<pre><code class="nullbash">&gt; crontab -l
10 6 * * * hello.sh
40 10 01 * * java -jar InitContract.jar &gt;/dev/null
00 16 * * * /bin/ksh leave.sh &gt; leave_update.log
</code></pre>
</li>
</ul>
<p>示例：</p>
<ol>
<li>编写shell，并赋予执行权限<pre><code class="nullbash">chmod +x file.sh
<span class="hljs-comment"># csh -x file.sh</span>
<span class="hljs-comment"># ksh -x file.sh</span>
</code></pre>
</li>
<li>导出现有crontab<pre><code class="nullbash">crontab -l &gt; test_crontab
</code></pre>
</li>
<li>编辑导出的crontab文件，添加crontab任务<pre><code class="nullbash">vi test_crontab
</code></pre>
</li>
<li>导入新的crontab文件，使其生效<pre><code class="nullbash">crontab test_crontab
</code></pre>
</li>
</ol>
<h2 id="header-23">Shell</h2>
<pre><code class="nullbash"><span class="hljs-comment"># 查看當前使用的Shell</span>
&gt; <span class="hljs-built_in">echo</span> <span class="hljs-variable">$SHELL</span>
/bin/sh

<span class="hljs-comment"># 查看当前shell的进程号</span>
&gt; <span class="hljs-built_in">echo</span> $$
12282

<span class="hljs-comment"># ps-A看自己shell的pid</span>
&gt; ps -A | grep 12282
12282 pts/19   0:00 sh

<span class="hljs-comment"># 启动一个新的K Shell进程，用exit退出</span>
&gt; ksh
&gt; <span class="hljs-built_in">exit</span>

<span class="hljs-comment"># 启动一个新的C Shell进程，用exit退出</span>
&gt; csh
&gt; <span class="hljs-built_in">exit</span>
</code></pre>
<ol>
<li><p>命令回传值 <code>$?</code></p>
<ul>
<li>若前一个命令运行的结果为正确，在 Linux 底下会回传一个 $? = 0 的值</li>
<li><code>cmd1 &amp;&amp; cmd2</code><ul>
<li>若 cmd1 运行完毕且正确运行(<code>$?=0</code>)，则开始运行 cmd2</li>
<li>若 cmd1 运行完毕且为错误 (<code>$?≠0</code>)，则 cmd2 不运行</li>
</ul>
</li>
<li><code>cmd1 || cmd2</code><ul>
<li>若 cmd1 运行完毕且正确运行(<code>$?=0</code>)，则 cmd2 不运行<br>+　若 cmd1 运行完毕且为错误 (<code>$?≠0</code>)，则开始运行 cmd2</li>
</ul>
</li>
<li><p>示例：</p>
<pre><code class="nullbash"><span class="hljs-comment"># 自动判断，如果没有该目录就给予创建</span>
ls /tmp/abc || mkdir /tmp/abc

<span class="hljs-comment"># 以 ls 测试 /tmp/vbirding 是否存在</span>
<span class="hljs-comment"># 若存在则显示 "exist"</span>
<span class="hljs-comment"># 若不存在，则显示 "not exist"</span>
ls /tmp/vbirding &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">"exist"</span> || <span class="hljs-built_in">echo</span> <span class="hljs-string">"not exist"</span>
</code></pre>
</li>
</ul>
</li>
<li><p><code>exit n</code></p>
<ul>
<li>n 是数字</li>
<li>让程序中断,并回传一个数值给系统</li>
<li>利用此功能，可以自订错误信息，并通过<code>echo $?</code>获取错误信息</li>
</ul>
</li>
<li><p>变量</p>
<ul>
<li><p>变量的测试与内容替换</p>
<table class="table">
<thead>
<tr>
<th>变量配置方式</th>
<th>str 不存在</th>
<th>str 为空字符串</th>
<th>str 为非空字符串</th>
</tr>
</thead>
<tbody>
<tr>
<td>『判断』str是否存在</td>
<td>str不存在，返回expr</td>
<td></td>
<td>str存在，返回str原值</td>
</tr>
<tr>
<td><code>var=${str-expr}</code></td>
<td>var=expr</td>
<td>var=</td>
<td>var=$str</td>
</tr>
<tr>
<td><code>var=${str:-expr}</code></td>
<td>var=expr</td>
<td>var=expr</td>
<td>var=$str</td>
</tr>
<tr>
<td>『判断』str是否不存在</td>
<td>str不存在，返回空</td>
<td></td>
<td>str存在，返回expr</td>
</tr>
<tr>
<td><code>var=${str+expr}</code></td>
<td>var=</td>
<td>var=expr</td>
<td>var=expr</td>
</tr>
<tr>
<td><code>var=${str:+expr}</code></td>
<td>var=</td>
<td>var=</td>
<td>var=expr</td>
</tr>
<tr>
<td>使用等号 <code>=</code></td>
<td>str不存在，返回expr，且置str=expr</td>
<td></td>
<td>str存在，返回str原值，str不变</td>
</tr>
<tr>
<td><code>var=${str=expr}</code></td>
<td>var=expr , str=expr</td>
<td>var= ,str 不变</td>
<td>var=$str, str 不变</td>
</tr>
<tr>
<td><code>var=${str:=expr}</code></td>
<td>var=expr ,  str=expr</td>
<td>var=expr, str=expr</td>
<td>var=$str,  str 不变</td>
</tr>
<tr>
<td>使用<code>?</code></td>
<td>str不存在，expr 输出至 stderr</td>
<td></td>
<td>str存在，返回str原值</td>
</tr>
<tr>
<td><code>var=${str?expr}</code></td>
<td>expr 输出至 stderr</td>
<td>var=</td>
<td>var=$str</td>
</tr>
<tr>
<td><code>var=${str:?expr}</code></td>
<td>expr 输出至 stderr</td>
<td>expr 输出至stderr</td>
<td>var=$str</td>
</tr>
</tbody>
</table>
</li>
<li>注意： 使用 <code>:</code> 则变量不存在或为空字符串则是一个效果</li>
<li><p>打印变量</p>
<pre><code class="nullbash">&gt; <span class="hljs-built_in">echo</span> <span class="hljs-variable">$var</span>
1

<span class="hljs-comment"># 扩展$var并添加串work</span>
<span class="hljs-comment"># {} 把该变量从给它添加的字符里分离出来</span>
&gt; <span class="hljs-built_in">echo</span> <span class="hljs-variable">${var}</span>work
1work
</code></pre>
</li>
</ul>
</li>
<li><p>日期date</p>
<pre><code class="nullbash"> &gt; date
 Tue Feb  7 15:35:15 CST 2012
 &gt; <span class="hljs-built_in">echo</span> `date +%y%m%d`
 120207
 &gt; <span class="hljs-built_in">echo</span> `date +%Y/%m/%d`
 2012/02/07
 &gt; <span class="hljs-built_in">echo</span> `date <span class="hljs-string">'+%H%M%S'</span>`
 153255
 &gt; <span class="hljs-built_in">echo</span> `date +%D`
 02/07/12
 &gt; <span class="hljs-built_in">echo</span> `date +%h`
 Feb
 &gt;  <span class="hljs-built_in">echo</span> `date <span class="hljs-string">'+%Y/%m/%d %H:%M:%S'</span>`
 2012/02/07 15:32:35
</code></pre>
<pre><code> date1=$(date --date=&#39;2 days ago&#39; +%Y%m%d)  # 前两天的日期
 date2=$(date --date=&#39;1 days ago&#39; +%Y%m%d)  # 前一天的日期
 date3=$(date +%Y%m%d)                      # 今天的日期

 # 配置档名
 file1=${filename}${date1}
 file2=${filename}${date2}
 file3=${filename}${date3}
</code></pre></li>
<li><p>命令替换：将命令放入反引号</p>
<pre><code class="nullbash"> &gt; <span class="hljs-built_in">set</span> d = `date`    <span class="hljs-comment"># 产生的值是一个数组</span>
 &gt; <span class="hljs-built_in">echo</span> <span class="hljs-variable">$d</span>[1]
 Tue

 &gt; <span class="hljs-built_in">set</span> d=<span class="hljs-string">"`date`"</span>    <span class="hljs-comment"># 输出封装在双引号里，所以是一个单串</span>
 &gt; <span class="hljs-built_in">echo</span> <span class="hljs-variable">$d</span>[1]
 Tue Feb 7 13:33:06 CST 2012
 &gt; <span class="hljs-built_in">echo</span> <span class="hljs-variable">$d</span>[2]
 Subscript out of range

 &gt; cal 2 2012
  February 2012
 S  M Tu  W Th  F  S
       1  2  3  4
 5  6  7  8  9 10 11
 12 13 14 15 16 17 18
 19 20 21 22 23 24 25
 26 27 28 29
 &gt; <span class="hljs-built_in">echo</span> Hello `cal 2 2012`        <span class="hljs-comment"># 输出每个换行符都用一个空格代替</span>
 Hello February 2012 S M Tu W Th F S 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29
</code></pre>
</li>
</ol>
<h3 id="header-24">C Shell</h3>
<ol>
<li><p><code>#!/bin/csh</code></p>
</li>
<li><p>用户接收 <code>$&lt;</code></p>
<pre><code class="nullbash"><span class="hljs-built_in">echo</span> -n <span class="hljs-string">"What is your name? "</span>    <span class="hljs-comment"># -n 取消末尾的换行</span>
<span class="hljs-built_in">set</span> name = $&lt;
</code></pre>
</li>
<li><p>测试变量是否被设置 <code>$?var</code></p>
<ul>
<li>1:设置了</li>
<li>0:未设置</li>
<li>eg: <code>echo $?hello</code></li>
</ul>
</li>
<li><p>命令行变元<code>$xxx</code></p>
<pre><code class="nullbash"><span class="hljs-variable">$0</span>,<span class="hljs-variable">$1</span>,<span class="hljs-variable">$2</span>,...
$*
<span class="hljs-variable">$argv</span>[0]
<span class="hljs-variable">$argv</span>[1],<span class="hljs-variable">$argv</span>[2],...<span class="hljs-variable">$argv</span>[<span class="hljs-variable">$#argv</span>]
<span class="hljs-variable">$argv</span>[*],<span class="hljs-variable">$argv</span>
</code></pre>
</li>
<li><p>数值运算</p>
<pre><code class="nullbash"> &gt; @ sum = 4 + 6
 &gt; <span class="hljs-built_in">echo</span> <span class="hljs-variable">$sum</span>
 10

 &gt; @ sum ++
 &gt; <span class="hljs-built_in">echo</span> <span class="hljs-variable">$sum</span>
 11

 &gt; @ sum += 3
 &gt; <span class="hljs-built_in">echo</span> <span class="hljs-variable">$sum</span>
 14
</code></pre>
</li>
<li><p>数组</p>
<ul>
<li><code>(...)</code> 创建数组</li>
<li><code>$#var</code> 数组长度</li>
<li><code>$var[*]</code> ,<code>$var</code> 打印所有元素</li>
<li><code>$var[..]</code> 获取某个数组元素（数组从1～len）</li>
<li><p><code>shift var</code> 数组左移一个元素</p>
<pre><code class="nullbash">&gt; <span class="hljs-built_in">set</span> name = <span class="hljs-string">"Hello GoodBye Sir"</span>
&gt; <span class="hljs-built_in">echo</span> <span class="hljs-variable">$name</span>[1]
Hello GoodBye Sir
&gt; <span class="hljs-built_in">echo</span> <span class="hljs-variable">$name</span>[2]
Subscript out of range

<span class="hljs-comment"># 将变量封装在()中，创建一个叫做fruit的数组</span>
&gt; <span class="hljs-built_in">set</span> fruit = (<span class="hljs-variable">$name</span>)
&gt; <span class="hljs-built_in">echo</span> <span class="hljs-variable">$fruit</span>
Hello GoodBye Sir
&gt; <span class="hljs-built_in">echo</span> <span class="hljs-variable">$fruit</span>[2]
GoodBye
</code></pre>
<pre><code class="nullbash"><span class="hljs-comment"># 创建数组</span>
&gt; <span class="hljs-built_in">set</span> fruit = ( app1 app2 app3 )
&gt; <span class="hljs-built_in">echo</span> <span class="hljs-variable">$fruit</span>
app1 app2 app3
&gt; <span class="hljs-built_in">echo</span> <span class="hljs-variable">$fruit</span>[*]
app1 app2 app3

<span class="hljs-comment"># 查询</span>
&gt; <span class="hljs-built_in">echo</span> <span class="hljs-variable">$fruit</span>[1]
app1
&gt; <span class="hljs-built_in">echo</span> <span class="hljs-variable">$fruit</span>[2-3]
app2 app3
&gt; <span class="hljs-built_in">echo</span> <span class="hljs-variable">$#fruit</span>
3
&gt; <span class="hljs-built_in">echo</span> <span class="hljs-variable">$fruit</span>[<span class="hljs-variable">$#fruit</span>]
app3

<span class="hljs-comment"># 操作</span>
&gt; <span class="hljs-built_in">set</span> fruit[2] = bana
&gt; <span class="hljs-built_in">echo</span> <span class="hljs-variable">$fruit</span>
app1 bana app3

&gt; <span class="hljs-built_in">shift</span> fruit
&gt; <span class="hljs-built_in">echo</span> <span class="hljs-variable">$fruit</span>
bana app3
</code></pre>
</li>
</ul>
</li>
<li><p>条件表达式</p>
<ul>
<li><code>==</code>,<code>!=</code>,<code>&gt;</code>,<code>&gt;=</code>,<code>&lt;</code>,<code>&lt;=</code>,<code>~</code>,<code>!~</code>,<code>!</code>,<code>||</code>,<code>&amp;&amp;</code><pre><code class="nullbash"><span class="hljs-keyword">if</span> ( <span class="hljs-variable">$answer</span> =~ [Yy]* ) <span class="hljs-keyword">then</span>
<span class="hljs-keyword">if</span> ( <span class="hljs-variable">$status</span> == 0 ) <span class="hljs-keyword">then</span>
<span class="hljs-keyword">if</span> ( $?prompt ) <span class="hljs-keyword">then</span>
<span class="hljs-keyword">if</span> ( <span class="hljs-string">"<span class="hljs-variable">$name</span>"</span> != <span class="hljs-string">"KK"</span> ) <span class="hljs-keyword">then</span>                <span class="hljs-comment">#使用“”防止name中不止一个词而发生异常</span>
<span class="hljs-keyword">if</span> ( (<span class="hljs-string">"<span class="hljs-variable">$x</span>"</span> &amp;&amp; <span class="hljs-string">"<span class="hljs-variable">$y</span>"</span> ) || ! <span class="hljs-string">"<span class="hljs-variable">$z</span>"</span> ) <span class="hljs-keyword">then</span>            <span class="hljs-comment"># ! 后面必须有一个空格</span>
</code></pre>
</li>
<li><code>-r</code>,<code>-w</code>,<code>-x</code>,<code>-o</code><pre><code class="nullbash"><span class="hljs-keyword">if</span> ( -r <span class="hljs-variable">$file</span> &amp;&amp; -w <span class="hljs-variable">$file</span> ) <span class="hljs-keyword">then</span>
</code></pre>
</li>
<li><code>-e</code>,<code>-z</code>,<code>-f</code>,<code>-d</code><pre><code class="nullbash"><span class="hljs-keyword">if</span> ( ! -d <span class="hljs-variable">$file</span> ) <span class="hljs-keyword">then</span>
</code></pre>
</li>
</ul>
</li>
<li><p>条件判断</p>
<ul>
<li><code>if/else if/else/endif</code><pre><code class="nullbash"><span class="hljs-keyword">if</span> ( exp1 ) <span class="hljs-keyword">then</span>
  <span class="hljs-built_in">echo</span> <span class="hljs-string">"case1"</span>
<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( exp2 ) <span class="hljs-keyword">then</span>
  <span class="hljs-built_in">echo</span> <span class="hljs-string">"case2"</span>
<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( exp3 ) <span class="hljs-keyword">then</span>
  <span class="hljs-built_in">echo</span> <span class="hljs-string">"case3"</span>
<span class="hljs-keyword">else</span>
  <span class="hljs-built_in">echo</span> <span class="hljs-string">"case4"</span>
endif
</code></pre>
</li>
<li><code>switch/case/breaksw/endsw</code><pre><code class="nullbash">switch ( str )
<span class="hljs-keyword">case</span> red:
  <span class="hljs-built_in">echo</span> <span class="hljs-string">"case1"</span>
  breaksw
<span class="hljs-keyword">case</span> bl*:
  <span class="hljs-built_in">echo</span> <span class="hljs-string">"case2"</span>
  breaksw
<span class="hljs-keyword">case</span> [56].c:
  <span class="hljs-built_in">echo</span> <span class="hljs-string">"case1"</span>
  breaksw
default:
  breaksw
endsw
</code></pre>
</li>
</ul>
</li>
<li><p>循环</p>
<ul>
<li><code>foreach var (list) cmd end</code><pre><code class="nullbash">  foreach person (`cat maillist`)
      <span class="hljs-built_in">echo</span> <span class="hljs-variable">$preson</span>
  end
</code></pre>
<pre><code class="nullbash">  foreach file (*.c)
      <span class="hljs-built_in">echo</span> <span class="hljs-variable">$file</span>
  end
</code></pre>
</li>
<li><code>while(exp) cmd end</code><pre><code class="nullbash">  <span class="hljs-keyword">while</span> ( <span class="hljs-variable">$num</span> &lt; 10 )
      <span class="hljs-built_in">echo</span> <span class="hljs-variable">$num</span>
      @ num++
  end
</code></pre>
<pre><code class="nullbash">  <span class="hljs-keyword">while</span> ( <span class="hljs-string">"<span class="hljs-variable">$answer</span>"</span> != <span class="hljs-string">"Bye"</span> )
      <span class="hljs-built_in">set</span> answer = $&lt;
  end
</code></pre>
<pre><code class="nullbash">  <span class="hljs-keyword">while</span> (<span class="hljs-variable">$#argv</span>)
      <span class="hljs-built_in">echo</span> <span class="hljs-variable">$argv</span>
      <span class="hljs-built_in">shift</span>
  end
</code></pre>
<pre><code class="nullbash">  <span class="hljs-keyword">while</span> (1)
      cmd
      <span class="hljs-keyword">if</span> () <span class="hljs-keyword">then</span>
          <span class="hljs-built_in">break</span>
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> () <span class="hljs-keyword">then</span>
          <span class="hljs-built_in">continue</span>
      <span class="hljs-keyword">else</span>
          cmd
      endif
  end
</code></pre>
</li>
<li><code>repeat n cmd</code><pre><code class="nullbash">  repeat 3 <span class="hljs-built_in">echo</span> hello
</code></pre>
</li>
</ul>
</li>
</ol>
<p>示例</p>
<ol>
<li><p>设置变量</p>
<pre><code class="nullbash"> <span class="hljs-built_in">set</span> FTP_FTSERVER  = (10.7.49.15 10.7.49.17 10.7.49.152 10.7.54.2) 
 <span class="hljs-built_in">set</span> ServletURL = http://10.7.33.16/cim/servlet
 <span class="hljs-built_in">set</span> Rawdata = <span class="hljs-variable">$downup</span>\/<span class="hljs-variable">$LOTNO</span>-<span class="hljs-variable">$CPNO</span>
</code></pre>
<pre><code class="nullbash"> <span class="hljs-built_in">set</span> tdtplogfile = /home/klt/<span class="hljs-built_in">log</span>/tdtp_1.`date <span class="hljs-string">'+%Y%m%d'</span>`    
 <span class="hljs-built_in">set</span> LOGS =  /db/data/autoftp/logs/pixart/`/usr/ucb/whoami`
</code></pre>
<pre><code class="nullbash"> <span class="hljs-built_in">set</span> tmpfile = /home/klt/wgetlog/$$
 <span class="hljs-built_in">set</span> TEMPLASER = /home/cim1tdtp/temp/<span class="hljs-string">"<span class="hljs-variable">$LLOTNO</span><span class="hljs-variable">$WAFNUM</span>"</span>-$$.asc
</code></pre>
<pre><code class="nullbash"> <span class="hljs-built_in">set</span> lenOfPfile = `<span class="hljs-built_in">echo</span> <span class="hljs-variable">$proberfile</span> | cut -d <span class="hljs-string">'/'</span> -f8 | awk <span class="hljs-string">'{print length($1)}'</span>`
 <span class="hljs-built_in">set</span> lenOfWno   = `<span class="hljs-built_in">echo</span> <span class="hljs-variable">$proberfile</span> | cut -d <span class="hljs-string">'/'</span> -f8 | cut -d <span class="hljs-string">'.'</span> -f1 | awk <span class="hljs-string">'{print length($1)}'</span>`
 @ lenOfWno = <span class="hljs-variable">$lenOfWno</span> + 2
 <span class="hljs-built_in">set</span> partlotno = `<span class="hljs-built_in">echo</span> <span class="hljs-variable">$proberfile</span> | cut -d <span class="hljs-string">'/'</span> -f8 | cut -c <span class="hljs-variable">$lenOfWno</span>-<span class="hljs-variable">$lenOfPfile</span>`
 <span class="hljs-built_in">echo</span> partlotno is <span class="hljs-variable">$partlotno</span>

 <span class="hljs-built_in">set</span> fproberfile = `ls /db/prober/map/<span class="hljs-variable">$testgrp</span>/<span class="hljs-variable">$Rawdata</span>/<span class="hljs-variable">$partlotno</span>=* | tail -1`      
 <span class="hljs-built_in">set</span> fpfilelength = ` <span class="hljs-built_in">echo</span> <span class="hljs-variable">$fproberfile</span> | awk <span class="hljs-string">'{print length($1)}'</span>`
</code></pre>
<pre><code class="nullbash"> <span class="hljs-built_in">set</span> cpNo = `<span class="hljs-built_in">echo</span> <span class="hljs-variable">$configArr</span>[1] | cut -c 3- `
 <span class="hljs-built_in">set</span> USER_COUNTS = `who | grep klt | wc -l`
 <span class="hljs-built_in">set</span> os = `uname`
 <span class="hljs-built_in">set</span> RETURNVALUE=`<span class="hljs-built_in">echo</span> <span class="hljs-variable">$TMPLINE</span> |awk -F\| <span class="hljs-string">'{print $1}'</span>`
 <span class="hljs-built_in">set</span> RemoteHost = `who am i |awk  <span class="hljs-string">'{print $NF}'</span> | awk -F\( <span class="hljs-string">'{print $2}'</span>  | awk -F\) <span class="hljs-string">'{print $1}'</span> | awk -F. <span class="hljs-string">'{print $1}'</span> `
</code></pre>
</li>
<li><p>接收用户输入</p>
<ul>
<li>存入一个变量<pre><code class="nullbash"><span class="hljs-built_in">echo</span> CPNO:
<span class="hljs-built_in">set</span> CPNO = $&lt;
</code></pre>
</li>
<li><p>存入数组，小写转换为大写，获取字符串长度，设置变量</p>
<pre><code class="nullbash"><span class="hljs-built_in">echo</span>   CPNO Flotno WaferNum PROBERIP TESTGROUP UP 
<span class="hljs-built_in">set</span> tempfile    = $&lt;
<span class="hljs-built_in">set</span> file    = (<span class="hljs-variable">$tempfile</span>)

<span class="hljs-keyword">if</span> ( <span class="hljs-variable">$#file</span> == 6 ) <span class="hljs-keyword">then</span>  
  <span class="hljs-built_in">set</span> CPNO         = `<span class="hljs-built_in">echo</span> <span class="hljs-variable">$file</span>[1] | tr <span class="hljs-string">"[:lower:]"</span> <span class="hljs-string">"[:upper:]"</span> `  
  <span class="hljs-built_in">set</span> equip        = <span class="hljs-variable">$file</span>[4]
  <span class="hljs-built_in">set</span> numchar      = ` <span class="hljs-built_in">echo</span> <span class="hljs-variable">$WAFERNUM</span> | awk <span class="hljs-string">'{print length($1)}'</span>`    
endif

<span class="hljs-keyword">if</span> ( <span class="hljs-variable">$numchar</span> == 1 ) <span class="hljs-keyword">then</span>
      <span class="hljs-built_in">set</span> WAFERNUM = 0<span class="hljs-string">"<span class="hljs-variable">$WAFERNUM</span>"</span>
endif
</code></pre>
</li>
</ul>
</li>
<li><p>if 判断</p>
<pre><code class="nullbash"> <span class="hljs-keyword">if</span> (-e <span class="hljs-variable">$tmpfile</span>) <span class="hljs-keyword">then</span>
     <span class="hljs-built_in">echo</span> `date <span class="hljs-string">'+%H:%M:%S'</span>` &gt;&gt; <span class="hljs-variable">$tdtplogfile</span>    
 endif

 <span class="hljs-keyword">if</span> ( ! -d <span class="hljs-variable">$LOGS</span> ) <span class="hljs-keyword">then</span> 
     mkdir -p <span class="hljs-variable">$LOGS</span>
 endif

 <span class="hljs-keyword">if</span> ( ! -d <span class="hljs-variable">$FTP_SRC_DIR</span> ) <span class="hljs-keyword">then</span>
     mkdir <span class="hljs-variable">$FTP_SRC_DIR</span>
     chmod 777 <span class="hljs-variable">$FTP_SRC_DIR</span>
 endif
</code></pre>
<pre><code class="nullbash"> <span class="hljs-keyword">if</span> ( <span class="hljs-variable">$USER_COUNTS</span> &gt; 3 ) <span class="hljs-keyword">then</span> 
     <span class="hljs-built_in">echo</span> <span class="hljs-string">"Too Many User Execute TDTP manual(Default:3 users), Please wait..."</span>
     <span class="hljs-built_in">echo</span> <span class="hljs-string">"You can contact with user, and list as follows:"</span>
     who | grep klt
     ps -ef | grep <span class="hljs-string">" klt "</span>
     <span class="hljs-built_in">exit</span>
 endif

 <span class="hljs-keyword">if</span> (<span class="hljs-variable">$os</span> =~ [Ll][Ii][Nn][Uu][Xx]) <span class="hljs-keyword">then</span>
     <span class="hljs-built_in">set</span> wget = <span class="hljs-variable">$srcpath</span><span class="hljs-string">"download-Linux"</span>    
 <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable">$os</span> =~ [Ss][Uu][Nn][Oo][Ss]) <span class="hljs-keyword">then</span>
     <span class="hljs-keyword">if</span> ( `hostname` =~ [Jj]995*) <span class="hljs-keyword">then</span>
         <span class="hljs-built_in">set</span> wget = <span class="hljs-variable">$srcpath</span><span class="hljs-string">"download-SunOS41"</span>
     <span class="hljs-keyword">else</span>
         <span class="hljs-built_in">set</span> wget = <span class="hljs-variable">$srcpath</span><span class="hljs-string">"download-SunOS"</span> 
     endif
 endif

 <span class="hljs-keyword">if</span> (<span class="hljs-variable">$os</span> !~ [Ll][Ii][Nn][Uu][Xx]) <span class="hljs-keyword">then</span>
     unsetenv <span class="hljs-variable">$PGM_WGETPATH</span>
 endif
</code></pre>
<pre><code class="nullbash"> <span class="hljs-comment"># $status : </span>
 <span class="hljs-comment"># grep 找到所寻找的模式 0; 找不到该模式 1; 找不到文件 2 ;</span>
 <span class="hljs-comment"># awk / sed 不论搜索的模式是否成功 0 ; 语法错误 非0</span>

  grep <span class="hljs-string">"tw.com.kyec.cim.cp.task.TaskTDTPProber: true"</span> <span class="hljs-variable">$tmpfile</span>  &gt; &amp;  /dev/null
   <span class="hljs-keyword">if</span> (<span class="hljs-variable">$status</span> == 0 ) <span class="hljs-keyword">then</span>
       <span class="hljs-built_in">echo</span> TDTP have <span class="hljs-keyword">done</span> <span class="hljs-variable">$proberfile</span>
   <span class="hljs-keyword">else</span> 
      <span class="hljs-built_in">echo</span> failed to <span class="hljs-keyword">do</span> TDTP <span class="hljs-variable">$proberfile</span>
   endif

  <span class="hljs-built_in">set</span> fproberfile = `ls /db/prober/map/<span class="hljs-variable">$testertype</span>/up/<span class="hljs-variable">$templotno</span>/<span class="hljs-variable">$partlotno</span>=* | tail -1`
  <span class="hljs-built_in">set</span> fpfilelength = ` <span class="hljs-built_in">echo</span> <span class="hljs-variable">$fproberfile</span> | awk <span class="hljs-string">'{print length($1)}'</span>`
</code></pre>
</li>
<li><p>foreach 循环</p>
<pre><code class="nullbash"> foreach FTP_SERVER ( `<span class="hljs-built_in">echo</span> <span class="hljs-variable">$FTP_FTSERVER</span>`)
     /usr/sbin/ping <span class="hljs-variable">$FTP_SERVER</span> | grep alive                 &gt;&amp; /dev/null
     <span class="hljs-keyword">if</span> ( <span class="hljs-variable">$status</span> != 0 ) <span class="hljs-keyword">then</span>
         <span class="hljs-built_in">echo</span> Server can\<span class="hljs-string">'t connect to $FTP_SERVER           &gt;&gt; $FTP_LOG
         continue
     endif
 end</span>
</code></pre>
<pre><code class="nullbash"> <span class="hljs-built_in">set</span> count = 1
 foreach filename (`cat <span class="hljs-variable">$FileList</span>`)
     <span class="hljs-built_in">set</span> klotno = `<span class="hljs-built_in">echo</span> <span class="hljs-variable">$filename</span> | cut -d<span class="hljs-string">'-'</span> -f1`
     <span class="hljs-built_in">set</span> barcode = `<span class="hljs-built_in">echo</span> <span class="hljs-variable">$filename</span> | cut -d<span class="hljs-string">'_'</span> -f1`
     <span class="hljs-built_in">set</span> filetime = `<span class="hljs-built_in">echo</span> <span class="hljs-variable">$filename</span> | cut -d<span class="hljs-string">'_'</span> -f2 | cut -c 1-12`

     <span class="hljs-keyword">if</span> ( <span class="hljs-variable">$klotno</span> == <span class="hljs-variable">$lotno</span> ) <span class="hljs-keyword">then</span>
         <span class="hljs-built_in">set</span> cmdStr = <span class="hljs-string">"<span class="hljs-variable">$ServletURL</span>/chkWfrStatus?CUST=ZKT&amp;2DBARCODE=<span class="hljs-variable">${barcode}</span>&amp;STNO=1&amp;FILETIME=<span class="hljs-variable">${filetime}</span>&amp;TESTER=E320_BDB01&amp;HEAD=1"</span>
         <span class="hljs-variable">$WGET</span> -q -O <span class="hljs-variable">$tmpfile</span> <span class="hljs-string">"<span class="hljs-variable">$cmdStr</span>"</span>
         @ count++
     <span class="hljs-keyword">else</span>
         <span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$klotno</span> != <span class="hljs-variable">$lotno</span>"</span> &gt;&gt; <span class="hljs-variable">$logfile</span>
     endif     
 end
</code></pre>
</li>
<li><p>while 循环</p>
<pre><code class="nullbash"> <span class="hljs-built_in">set</span> waferno = 1
 <span class="hljs-keyword">while</span> ( <span class="hljs-variable">$waferno</span> &lt; 26 ) 
     @ waferno = <span class="hljs-variable">$waferno</span> + 1
     <span class="hljs-keyword">if</span> (<span class="hljs-variable">$waferno</span> &lt; 10 ) <span class="hljs-keyword">then</span>
         <span class="hljs-built_in">continue</span>
     endif
 end
</code></pre>
<pre><code class="nullbash"> <span class="hljs-keyword">while</span> ( <span class="hljs-variable">$#argv</span> &gt; 0 )
     <span class="hljs-built_in">set</span> args = <span class="hljs-string">"<span class="hljs-variable">$args</span> <span class="hljs-variable">$argv</span>[1]"</span>
     <span class="hljs-built_in">shift</span> argv
 end
</code></pre>
</li>
<li><p>压缩/解压缩</p>
<pre><code class="nullbash"> unzip -o <span class="hljs-variable">$FTP_AIM_DIR</span>/<span class="hljs-variable">$LOTNO</span>/<span class="hljs-variable">$TEMP_FILE</span> -d <span class="hljs-variable">$FTP_AIM_DIR</span>/<span class="hljs-variable">$LOTNO</span>/
 unzip <span class="hljs-variable">$TEMP_ZIP1</span>.zip -d <span class="hljs-variable">$TEMP_ZIP1</span>.ZIP 
 uncompress &lt; <span class="hljs-variable">$FTP_AIM_DIR</span>/<span class="hljs-variable">$LOTNO</span>/<span class="hljs-variable">$TEMP_FILE</span> | tar xf -

 tar -cvf <span class="hljs-variable">$DirName</span><span class="hljs-string">".tar"</span> <span class="hljs-variable">$DirName</span>
 compress <span class="hljs-variable">$DirName</span><span class="hljs-string">".tar"</span>
</code></pre>
</li>
<li><p>环境变量设置</p>
<pre><code class="nullbash"> <span class="hljs-built_in">set</span> srcpath = <span class="hljs-string">"/cim/pgm/prod/"</span>
 setenv PGM_WGETPATH <span class="hljs-variable">$srcpath</span>

 setenv CIM_AUTO_INVOKED_PRCESS /home/asx/bin/auto_prober_klt.sh
 setenv CDC_PROBERD_LICENSE <span class="hljs-string">"O54k43jL7aI2LGaBo6bf6IxaLPQtc2"</span>
</code></pre>
</li>
<li><p>FTP</p>
<pre><code class="nullbash"> <span class="hljs-comment"># ftp -inv $FTP_SERVER</span>
 <span class="hljs-built_in">echo</span> user <span class="hljs-variable">$FTP_USER</span> <span class="hljs-variable">$FTP_PASSWORD</span>    &gt;&gt; <span class="hljs-variable">$FTP_CMD_FILE</span>
 <span class="hljs-built_in">echo</span> <span class="hljs-built_in">cd</span> /down                        &gt;&gt; <span class="hljs-variable">$FTP_CMD_FILE</span>
 <span class="hljs-built_in">echo</span> bin                             &gt;&gt; <span class="hljs-variable">$FTP_CMD_FILE</span>            
 <span class="hljs-built_in">echo</span> put <span class="hljs-variable">$file</span>                       &gt;&gt; <span class="hljs-variable">$FTP_CMD_FILE</span>
 <span class="hljs-built_in">echo</span> <span class="hljs-built_in">bye</span>                             &gt;&gt; <span class="hljs-variable">$FTP_CMD_FILE</span>

 ftp -inv <span class="hljs-variable">$FTP_SERVER</span> &lt; <span class="hljs-variable">$FTP_CMD_FILE</span>
 <span class="hljs-built_in">echo</span> <span class="hljs-string">"OK\!"</span>
</code></pre>
<pre><code class="nullbash"> <span class="hljs-built_in">echo</span> user <span class="hljs-variable">$FTP_USER</span> <span class="hljs-variable">$FTP_PASSWD</span>           &gt;   <span class="hljs-variable">$FTP_CMD_FILE</span>
 <span class="hljs-built_in">echo</span> <span class="hljs-built_in">cd</span> <span class="hljs-variable">$FTP_DIR_A</span>                        &gt;&gt;  <span class="hljs-variable">$FTP_CMD_FILE</span>
 <span class="hljs-built_in">echo</span> bin                                  &gt;&gt;  <span class="hljs-variable">$FTP_CMD_FILE</span>

 <span class="hljs-built_in">echo</span> <span class="hljs-string">"mget C*.TXT"</span>                         &gt;&gt;  <span class="hljs-variable">$FTP_CMD_FILE</span>
 <span class="hljs-built_in">echo</span> <span class="hljs-string">"mdir C*.TXT <span class="hljs-variable">$DB_LOG</span>"</span>                 &gt;&gt;  <span class="hljs-variable">$FTP_CMD_FILE</span> 
 foreach TEMP_FILE ( C*.TXT )
     <span class="hljs-built_in">echo</span> <span class="hljs-string">"del <span class="hljs-variable">$TEMP_FILE</span>"</span>                  &gt;&gt;   <span class="hljs-variable">$FTP_CMD_FILE</span> 
 end
 ls *.zip | awk <span class="hljs-string">'{printf "del %s\n",$1}'</span>     &gt;&gt;   <span class="hljs-variable">$FTP_CMD_FILE</span>    
 <span class="hljs-built_in">echo</span> <span class="hljs-built_in">bye</span>                                    &gt;&gt;  <span class="hljs-variable">$FTP_CMD_FILE</span>

 <span class="hljs-built_in">echo</span> <span class="hljs-string">"## start get emap data from csmc ftp Server at `date` ##"</span>  &gt;&gt;  <span class="hljs-variable">$FTP_LOG</span>
 (ftp -inv <span class="hljs-variable">$FTP_SERVER</span> &lt; <span class="hljs-variable">$FTP_CMD_FILE</span>)       &gt;&gt;  <span class="hljs-variable">$FTP_LOG</span>
 <span class="hljs-built_in">echo</span> <span class="hljs-string">"## end get emap data from csmc ftp Server at`date` ##"</span>     &gt;&gt;  <span class="hljs-variable">$FTP_LOG</span>
</code></pre>
</li>
<li><p>特殊命令</p>
<pre><code class="nullbash"> java -classpath .:/home/asx/proberlog/classes12.jar probLogScan <span class="hljs-variable">$proberfile</span> /home/asx/proberlog/  
 unix2dos   <span class="hljs-variable">$LLOTNO</span><span class="hljs-variable">$WAFNUM</span>.asc     <span class="hljs-variable">$LLOTNO</span><span class="hljs-variable">$WAFNUM</span>.asc
 <span class="hljs-built_in">exec</span> /home/asx/bin/cdc_proberd &gt; /home/asx/bin/cdc_screen.log.`date <span class="hljs-string">'+%Y%m%d'</span>` 
 last | grep logged | grep tsk | grep <span class="hljs-variable">$RemoteHost</span> &gt;&amp; /dev/null 
 /home/asx/bin/auto_prober_real_klt.sh <span class="hljs-variable">$1</span>  <span class="hljs-variable">$2</span> &amp;

 sed -n 17,<span class="hljs-string">"<span class="hljs-variable">$FILE_LENGTH</span>"</span>p <span class="hljs-variable">$FILE</span> &gt; <span class="hljs-variable">$tmpfile</span>
 <span class="hljs-built_in">set</span> CAT_X = `perl -e <span class="hljs-string">'while(&lt;&gt;){$count+= s/X//g;} print "$count";'</span> <span class="hljs-variable">$tmpfile</span>` 

 <span class="hljs-built_in">set</span> lineSting =  `sed -n <span class="hljs-variable">$line</span><span class="hljs-string">"p"</span> <span class="hljs-variable">$FILE_SHARE_TMP</span>`
</code></pre>
</li>
<li><p>使用wget 触发 Servlet</p>
<pre><code class="nullbash"><span class="hljs-built_in">set</span> WGET = /cim/bin/wget/ADVAN/wget
<span class="hljs-variable">$WGET</span> -q -O <span class="hljs-variable">$tmpfile</span>  <span class="hljs-string">"<span class="hljs-variable">$ServletURL</span>/CpTrigger?TASK=<span class="hljs-variable">$TASK</span>"</span>
</code></pre>
</li>
<li><p>调用java</p>
<pre><code class="nullbash"><span class="hljs-meta">#! /bin/csh</span>
<span class="hljs-comment">#classpath=.:$JAVA_HOME/lib/tools.jar:/home/cim1tdtp/oracle.jar</span>
<span class="hljs-built_in">set</span> srcPath=<span class="hljs-string">"/db/data/CGSPGM/exec"</span>
<span class="hljs-built_in">cd</span> <span class="hljs-variable">$srcPath</span>
<span class="hljs-built_in">echo</span> `java ParseRawForCGS` &gt;&gt; insertResult.txt
<span class="hljs-built_in">exit</span>
</code></pre>
</li>
</ol>
<h3 id="header-25">K Shell</h3>
<ol>
<li><p><code>#!/bin/ksh</code></p>
</li>
<li><p>读取用户输入<code>read</code></p>
<pre><code class="nullbash"> <span class="hljs-built_in">read</span>                <span class="hljs-comment"># $REPLY</span>
 <span class="hljs-built_in">read</span> answer
 <span class="hljs-built_in">print</span> <span class="hljs-variable">$answer</span>
 <span class="hljs-built_in">read</span> first middle last
 <span class="hljs-built_in">read</span> -u3 name        <span class="hljs-comment"># -u 从文件描述符中读取一行存储到变量name中</span>

 <span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> -u3 line1 &amp;&amp; <span class="hljs-built_in">read</span> -u4 line2
 <span class="hljs-keyword">do</span>
     <span class="hljs-built_in">print</span> <span class="hljs-string">"<span class="hljs-variable">$line1</span>:<span class="hljs-variable">$line2</span>"</span>
 <span class="hljs-keyword">done</span> 3&lt;<span class="hljs-variable">$1</span> 4&lt;<span class="hljs-variable">$2</span>
</code></pre>
</li>
<li><p>只读 <code>readonly</code></p>
<pre><code class="nullbash"> &gt; <span class="hljs-built_in">readonly</span> name=Tom
 &gt; <span class="hljs-built_in">print</span> <span class="hljs-variable">$name</span>
 Tom
 &gt; name=Joe
 ksh: name: is <span class="hljs-built_in">read</span> only
</code></pre>
</li>
<li><p><code>typeset</code>  设置变量属性</p>
<ul>
<li><code>-u</code> 将变量值中所有字母全部转换成大写</li>
<li><code>-l</code> 将变量值中所有字母全部转换成小写</li>
<li><code>-i</code> 将变量值设为整数类型</li>
<li><code>-L</code> width 在width宽度之内左对齐</li>
<li><code>-R</code> width 在width宽度之内右对齐，前面空位用空格填充</li>
<li><code>-Z</code> width 在width宽度之内右对齐</li>
<li><code>-x</code> 设置一个全局变量。相当于 export</li>
<li><p><code>-r</code> 设置一个变量具有只读属性，相当于readonly</p>
<pre><code class="nullbash">&gt; <span class="hljs-built_in">typeset</span> -i num        <span class="hljs-comment"># 整数</span>
&gt; <span class="hljs-built_in">typeset</span> -i2 num        <span class="hljs-comment"># 将数值num转换为二进制,i后面为进制数</span>
&gt; <span class="hljs-built_in">print</span> <span class="hljs-variable">$num</span>
2<span class="hljs-comment">#111</span>

&gt; kk=5.6
&gt; <span class="hljs-built_in">typeset</span> -i kk
&gt; <span class="hljs-built_in">echo</span> <span class="hljs-variable">$kk</span>
</code></pre>
</li>
</ul>
</li>
<li><p>history</p>
<pre><code class="nullbash"> <span class="hljs-built_in">history</span>
 <span class="hljs-built_in">history</span> -n            <span class="hljs-comment"># print without line numbers</span>
 <span class="hljs-built_in">history</span> 8            <span class="hljs-comment"># list form 8th command to present</span>
 <span class="hljs-built_in">history</span> -3            <span class="hljs-comment"># list this command and  the 3 preceding it</span>
 <span class="hljs-built_in">history</span> -1 -5          <span class="hljs-comment"># list last 5 commands,preceding this one in reversed order</span>
 <span class="hljs-built_in">history</span> -5 -1          <span class="hljs-comment"># list last 5 commands,preceding this one in order</span>
 <span class="hljs-built_in">history</span> ls <span class="hljs-built_in">echo</span>     <span class="hljs-comment"># display from most recent "ls" command to most recent "echo" command</span>
 <span class="hljs-built_in">history</span> -r ls <span class="hljs-built_in">echo</span>     <span class="hljs-comment"># -r reverses the list</span>
</code></pre>
</li>
<li><p><code>r</code> 重新执行命令</p>
<pre><code class="nullbash"> r date
 r 3
 r vi
 r vi file1=file2
</code></pre>
</li>
<li><p>别名 <code>alias</code></p>
<pre><code class="nullbash"> <span class="hljs-built_in">alias</span> c1=<span class="hljs-string">'clear'</span>
 <span class="hljs-built_in">alias</span> l=<span class="hljs-string">'ls -laF'</span>
 <span class="hljs-built_in">unalias</span> c1
 <span class="hljs-built_in">alias</span> -t
</code></pre>
</li>
<li><p>命令行变元</p>
<pre><code class="nullbash"> &gt; <span class="hljs-built_in">set</span> tom joe sam
 &gt; <span class="hljs-built_in">echo</span> $*
 tom joe sam

 &gt; <span class="hljs-built_in">shift</span>
 &gt; <span class="hljs-built_in">echo</span> $*
 joe sam
 &gt; <span class="hljs-built_in">echo</span> <span class="hljs-variable">$#</span>
 2

 &gt; <span class="hljs-built_in">set</span> $(date)
 &gt; <span class="hljs-built_in">print</span> $*
 Wed Feb 8 14:41:11 CST 2012
 &gt; <span class="hljs-built_in">shift</span> 3
 &gt; <span class="hljs-built_in">print</span> $*
 14:41:11 CST 2012
</code></pre>
</li>
<li><p>算数运算</p>
<pre><code class="nullbash"> num=5
 <span class="hljs-built_in">let</span> num=num+2        <span class="hljs-comment"># (( num=num+2))</span>
 <span class="hljs-built_in">print</span> <span class="hljs-variable">$num</span>
</code></pre>
</li>
<li><p>数组</p>
<ul>
<li><code>set -A var ...</code> 创建数组</li>
<li><code>${var[*]}</code> 打印数组</li>
<li><code>${var[..]}</code> 获取数组某元素值</li>
</ul>
<pre><code class="nullbash">&gt; <span class="hljs-built_in">typeset</span> -i names[4]
&gt; names[0]=30

&gt; <span class="hljs-built_in">set</span> -A fruit apples pears bananana
&gt; <span class="hljs-built_in">print</span> <span class="hljs-variable">$fruit</span>
apples
&gt; <span class="hljs-built_in">print</span> <span class="hljs-variable">${fruit[1]}</span>
pears

&gt; <span class="hljs-built_in">print</span> <span class="hljs-variable">${fruit[*]}</span>
apples pears bananana
&gt; <span class="hljs-built_in">print</span> <span class="hljs-variable">${#fruit[*]}</span>  <span class="hljs-comment"># 数组长度</span>
3
</code></pre>
</li>
<li><p>函数</p>
<pre><code class="nullbash"><span class="hljs-keyword">function</span> funcName { cmd;}
<span class="hljs-variable">$funcName</span>
</code></pre>
<pre><code class="nullbash"><span class="hljs-keyword">function</span> funCName {<span class="hljs-built_in">print</span> <span class="hljs-string">"Hi <span class="hljs-variable">$1</span> and <span class="hljs-variable">$2</span>"</span>;)
<span class="hljs-variable">$funcName</span> tom joe

&gt; <span class="hljs-built_in">typeset</span> -f funCName                <span class="hljs-comment"># list function define</span>
&gt; <span class="hljs-built_in">typeset</span> +f funCName                <span class="hljs-comment"># list function name</span>
&gt; <span class="hljs-built_in">unset</span> -f funCName                  <span class="hljs-comment"># clear funtion</span>
</code></pre>
</li>
<li><p>条件判断</p>
<ul>
<li>整数测试: <code>-eq</code>,<code>-ne</code>,<code>-gt</code>,<code>-ge</code>,<code>-lt</code>,<code>-le</code></li>
<li>文件测试: <code>-r</code>,<code>-w</code>,<code>-x</code>,<code>-d</code>,<code>-f</code>, <code>-s</code>,<code>-e,</code>-a`</li>
<li>逻辑操作符: <code>&amp;&amp;</code>,<code>||</code>,<code>!</code></li>
<li><code>[]</code> 等价于旧 test 命令 (<code>[</code> 后面必须有空格)</li>
<li><code>[[]]</code> / <code>(())</code> 等价于新test 命令,允许使用Shell元字符扩展<pre><code class="nullbash">&gt; name=Tom
&gt; <span class="hljs-built_in">test</span> <span class="hljs-variable">$name</span>=Tome
&gt; [ <span class="hljs-variable">$name</span> = Tom ]
&gt; [[ <span class="hljs-variable">$name</span> = [Tt]?m ]]
</code></pre>
</li>
</ul>
</li>
<li><p>判断</p>
<ul>
<li><code>if/elif/else/fi</code><pre><code class="nullbash"><span class="hljs-keyword">if</span> [[ ... ]]
<span class="hljs-keyword">then</span>
  cmd
<span class="hljs-keyword">elif</span> [[ ... ]]
  cmd
<span class="hljs-keyword">else</span>
  cmd
<span class="hljs-keyword">fi</span>
</code></pre>
</li>
<li><code>case/esac</code><pre><code class="nullbash"><span class="hljs-keyword">case</span> var <span class="hljs-keyword">in</span>
value1)
  cmd
  ;;
value2)
  cmd
  ;;
*)
  cmd
  ;;
<span class="hljs-keyword">esac</span>
</code></pre>
</li>
</ul>
</li>
<li><p>循环</p>
<ul>
<li><p><code>for var in list do cmd done</code></p>
<pre><code class="nullbash">  <span class="hljs-keyword">for</span> person <span class="hljs-keyword">in</span> `cat mylist`    <span class="hljs-comment"># for person in $(&lt;mylist)</span>
  <span class="hljs-keyword">do</span>
      <span class="hljs-built_in">print</span> <span class="hljs-variable">$person</span>
  <span class="hljs-keyword">done</span>
</code></pre>
<p>-<code>while [[expr]] do cmd done</code></p>
<pre><code class="nullbash">  <span class="hljs-keyword">while</span> (( num &lt; 10 ))
  <span class="hljs-keyword">do</span>
      <span class="hljs-built_in">print</span> <span class="hljs-variable">$num</span>
      (( num=num+1))
  <span class="hljs-keyword">done</span>
</code></pre>
<pre><code class="nullbash">  <span class="hljs-keyword">while</span> [[ <span class="hljs-variable">$answer</span> != <span class="hljs-string">"Tom"</span> ]]
  <span class="hljs-keyword">do</span>
      <span class="hljs-built_in">print</span> <span class="hljs-string">"wrong!"</span>
      <span class="hljs-built_in">read</span> answer
  <span class="hljs-keyword">done</span>
</code></pre>
<pre><code class="nullbash">  cat <span class="hljs-variable">$1</span> | <span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> line
  <span class="hljs-keyword">do</span>
      <span class="hljs-built_in">print</span> <span class="hljs-variable">$line</span>

  <span class="hljs-keyword">done</span> &gt; tmp$$
</code></pre>
</li>
<li><code>until [[expr]] do cmd done</code><pre><code class="nullbash">  until who | grep linda
  <span class="hljs-keyword">do</span>    
      sleep 5
  <span class="hljs-keyword">done</span>
</code></pre>
</li>
<li><code>select</code><pre><code class="nullbash"> select var <span class="hljs-keyword">in</span> wordlist
 <span class="hljs-keyword">do</span>
     cmd
 <span class="hljs-keyword">done</span>
</code></pre>
</li>
</ul>
</li>
<li><p><code>IFS</code> : shell 内部分隔符</p>
<pre><code class="nullbash">names=Tom:Dick:Sam:John
OldIFS=<span class="hljs-string">"<span class="hljs-variable">$IFS</span>"</span>
IFS=<span class="hljs-string">":"</span>
<span class="hljs-keyword">for</span> person <span class="hljs-keyword">in</span> <span class="hljs-variable">$names</span>
<span class="hljs-keyword">do</span>
    <span class="hljs-built_in">print</span> Hi <span class="hljs-variable">$preson</span>
<span class="hljs-keyword">done</span>
IFS=<span class="hljs-string">"<span class="hljs-variable">$OldIFS</span>"</span>
</code></pre>
</li>
</ol>
<p>使用示例：</p>
<ol>
<li><p>压缩备份资料(压缩文件夹)</p>
<pre><code class="nullbash"> <span class="hljs-comment">#!/bin/ksh</span>
 <span class="hljs-built_in">read</span> zipPath
 <span class="hljs-built_in">echo</span> <span class="hljs-variable">$zipPath</span>
 <span class="hljs-built_in">cd</span>     <span class="hljs-variable">$zipPath</span>

 <span class="hljs-comment"># tar, compress</span>
 <span class="hljs-keyword">for</span> DirName <span class="hljs-keyword">in</span> `ls `
 <span class="hljs-keyword">do</span>
     tar -cvf <span class="hljs-variable">$DirName</span><span class="hljs-string">".tar"</span> <span class="hljs-variable">$DirName</span>
     compress <span class="hljs-variable">$DirName</span><span class="hljs-string">".tar"</span>
 <span class="hljs-keyword">done</span>

 <span class="hljs-comment"># zip</span>
 <span class="hljs-keyword">for</span> DirName <span class="hljs-keyword">in</span> `ls `
     <span class="hljs-keyword">do</span>
         <span class="hljs-built_in">echo</span> <span class="hljs-variable">$DirName</span>
         zip -r <span class="hljs-variable">$DirName</span><span class="hljs-string">".zip"</span> <span class="hljs-variable">$DirName</span>
         rm -r <span class="hljs-variable">$DirName</span>
     <span class="hljs-keyword">done</span>

 <span class="hljs-comment">#collectData=$zipPath/1.txt</span>
 <span class="hljs-comment">#echo $collectData</span>
 <span class="hljs-comment">#while read DirName</span>
 <span class="hljs-comment">#do</span>
 <span class="hljs-comment">#        echo $DirName</span>
 <span class="hljs-comment">#        zip -r $DirName".zip" $DirName</span>
 <span class="hljs-comment">#        rm -r $DirName</span>
 <span class="hljs-comment">#done &lt; $collectData</span>

 <span class="hljs-built_in">echo</span> OK
 <span class="hljs-built_in">exit</span>
</code></pre>
</li>
<li><p>If</p>
<pre><code class="nullbash"> <span class="hljs-keyword">if</span> [ ! -d <span class="hljs-variable">$generatePath</span> ]
 <span class="hljs-keyword">then</span>
     mkdir <span class="hljs-variable">$generatePath</span>
 <span class="hljs-keyword">fi</span>

 <span class="hljs-keyword">if</span> [ -f <span class="hljs-variable">$filePathWithName</span> ]
 <span class="hljs-keyword">then</span>
     <span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$cpno</span> -eq 1 ]] 
     <span class="hljs-keyword">then</span>
         awk <span class="hljs-string">'NR&gt;21 {print $3" "$4" "$5" "$6" "$7" "$8}'</span> <span class="hljs-variable">$filePathWithName</span> &gt; <span class="hljs-variable">$generatePath</span>/<span class="hljs-variable">$wafid</span>
     <span class="hljs-keyword">else</span>
         awk <span class="hljs-string">'NR&gt;21 {print $3" "$4" "$5" "$6" "$7}'</span> <span class="hljs-variable">$filePathWithName</span> &gt; <span class="hljs-variable">$generatePath</span>/<span class="hljs-variable">$wafid</span>
     <span class="hljs-keyword">fi</span>
     <span class="hljs-built_in">echo</span> <span class="hljs-string">"OK : <span class="hljs-variable">$wafid</span> "</span> &gt;&gt; <span class="hljs-variable">$resultLog</span>
 <span class="hljs-keyword">else</span>
     <span class="hljs-built_in">echo</span> <span class="hljs-string">"FAIL : <span class="hljs-variable">$count</span> <span class="hljs-variable">$filePathWithName</span> unfound"</span> &gt;&gt; <span class="hljs-variable">$resultLog</span>
     <span class="hljs-built_in">echo</span> <span class="hljs-string">"FAIL : <span class="hljs-variable">$count</span> <span class="hljs-variable">$filePathWithName</span> unfound"</span> &gt;&gt;<span class="hljs-variable">$FailLog</span>
 <span class="hljs-keyword">fi</span>
</code></pre>
<pre><code class="nullbash"> <span class="hljs-keyword">if</span> [ <span class="hljs-variable">$TEMPMAXNUM</span> -lt 50 ]
 <span class="hljs-keyword">if</span> [ <span class="hljs-variable">$NUM</span> -eq <span class="hljs-string">"0"</span> ]
 <span class="hljs-keyword">if</span> [ -f <span class="hljs-variable">$FTP_SRC_DIR</span>/<span class="hljs-variable">$CUSTOMER</span>/<span class="hljs-variable">$FILE</span> ]
 <span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$LOCAL_SIZE</span> == <span class="hljs-variable">$REMOTE_SIZE</span> ]]
</code></pre>
<pre><code class="nullbash"> <span class="hljs-keyword">if</span> [ -f <span class="hljs-variable">$FTP_SRC_DIR</span>/<span class="hljs-variable">$CUSTOMER</span>/<span class="hljs-variable">$FYLE_TYPE</span>/*H2T340* ]
 <span class="hljs-keyword">then</span>
     <span class="hljs-keyword">if</span> [ ! -d <span class="hljs-variable">$FTP_SRC_DIR</span>/<span class="hljs-variable">$CUSTOMER</span>/<span class="hljs-variable">$FYLE_TYPE</span>/stdfFilter ] 
     <span class="hljs-keyword">then</span>
         mkdir <span class="hljs-variable">$FTP_SRC_DIR</span>/<span class="hljs-variable">$CUSTOMER</span>/<span class="hljs-variable">$FYLE_TYPE</span>/stdfFilter
     <span class="hljs-keyword">fi</span>
     <span class="hljs-built_in">echo</span> <span class="hljs-variable">$FTP_SRC_DIR</span>/<span class="hljs-variable">$CUSTOMER</span>/<span class="hljs-variable">$FYLE_TYPE</span>/*H2T340*
     mv <span class="hljs-variable">$FTP_SRC_DIR</span>/<span class="hljs-variable">$CUSTOMER</span>/<span class="hljs-variable">$FYLE_TYPE</span>/*H2T340* <span class="hljs-variable">$FTP_SRC_DIR</span>/<span class="hljs-variable">$CUSTOMER</span>/<span class="hljs-variable">$FYLE_TYPE</span>/stdfFilter/
     <span class="hljs-built_in">echo</span> <span class="hljs-string">"move to stdfFilter ok"</span>
 <span class="hljs-keyword">fi</span>
</code></pre>
</li>
<li><p>while</p>
<pre><code class="nullbash"> count=1
 <span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> line
 <span class="hljs-keyword">do</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-variable">$count</span> `date <span class="hljs-string">'+%m%d%H%M'</span>` :<span class="hljs-variable">$line</span>    &gt;&gt; <span class="hljs-variable">$resultLog</span>
    filename=`<span class="hljs-built_in">echo</span> <span class="hljs-variable">$line</span> | awk  <span class="hljs-string">'{print $6}'</span>`
    generatePath=<span class="hljs-variable">$resultPath</span>/<span class="hljs-variable">$klotNo</span>

    <span class="hljs-built_in">let</span> i=count%5 
    <span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$i</span> == 0 ]] 
    <span class="hljs-keyword">then</span>
         <span class="hljs-built_in">echo</span> <span class="hljs-string">"********************************************"</span> &gt;&gt; <span class="hljs-variable">$resultLog</span>
         <span class="hljs-built_in">echo</span> <span class="hljs-variable">$count</span>
    <span class="hljs-keyword">fi</span> 
    <span class="hljs-built_in">let</span> count=count+1 
 <span class="hljs-keyword">done</span> &lt; <span class="hljs-variable">$collectData</span>
</code></pre>
<pre><code class="nullbash"> usedFilePathLength=1 
 <span class="hljs-keyword">while</span> (( <span class="hljs-variable">$usedFilePathLength</span> &lt; <span class="hljs-variable">${#arrayFileDir[*]}</span>-1 ))  
 <span class="hljs-keyword">do</span>
      <span class="hljs-built_in">echo</span> mkdir <span class="hljs-variable">${arrayFileDir[$usedFilePathLength]}</span> &gt;&gt; <span class="hljs-variable">$FTP_CMD_FILE</span>
      <span class="hljs-built_in">echo</span> <span class="hljs-built_in">cd</span> <span class="hljs-variable">${arrayFileDir[$usedFilePathLength]}</span>    &gt;&gt; <span class="hljs-variable">$FTP_CMD_FILE</span> 
      <span class="hljs-built_in">cd</span> <span class="hljs-variable">${arrayFileDir[$usedFilePathLength]}</span> 
      <span class="hljs-built_in">let</span> usedFilePathLength=usedFilePathLength+1
 <span class="hljs-keyword">done</span>
</code></pre>
</li>
</ol>
<h3 id="header-26">B Shell</h3>
<ol>
<li><p><code>#!/bin/bash</code></p>
</li>
<li><p>read</p>
<pre><code class="nullbash"><span class="hljs-built_in">read</span> -p <span class="hljs-string">"Please input your first name: "</span> firstname  <span class="hljs-comment"># 提示使用者输入</span>
<span class="hljs-built_in">read</span> -p <span class="hljs-string">"Please input your last name:  "</span> lastname   <span class="hljs-comment"># 提示使用者输入</span>
<span class="hljs-built_in">echo</span> -e <span class="hljs-string">"\nYour full name is: <span class="hljs-variable">$firstname</span> <span class="hljs-variable">$lastname</span>"</span> <span class="hljs-comment"># 结果输出</span>
</code></pre>
</li>
<li><p>数值运算 ( bash shell 默认仅支持到整数的数据 )</p>
<pre><code class="nullbash">var=$((运算内容))
<span class="hljs-built_in">echo</span> $(( 13 % 3 ))
</code></pre>
</li>
</ol>
<p>更多可参考：<a href="http://vbird.dic.ksu.edu.tw/linux_basic/0320bash.php" target="_blank" rel="noopener">鸟哥的Linux私房菜</a></p>
  </section>
</article>

      <hr/>
      
<section class="post-comment">
	
		<div id="gitment_container"></div>

<link rel="stylesheet" href="/gitment/default.css">
<script src="/gitment/gitment.browser.js"></script>


<script type="text/javascript">
	var gitment = new Gitment({
	  owner: 'sixDegree',
	  repo: 'blogComment',
	  oauth: {
	    client_id: '36a09bb7399efe69c6ce',
	    client_secret: 'f28f2c5fff964d8e5d1a6ebdee77e6a890a8ac94',
	  },
	})
	gitment.render('gitment_container')
</script>
	
</section>

    </div>
  </div>
</body>

<script src="/jquery/dist/jquery.min.js"></script>
<script src="/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/highlight/highlight.pack.js"></script>
<script type="text/javascript">
  hljs.initHighlightingOnLoad();
  
  $(document).ready(function(){
    var sidebarCtrl=$("#sidebar-ctrl");
    var sidebar=$("#sidebar");
    var wrapper=$("#wrapper");
    sidebarCtrl.on("click",function(event){
        //alert("click");
        sidebar.toggleClass("sidebar-toggle");
        wrapper.toggleClass("sidebar-toggle");
        sidebarCtrl.toggleClass("sidebar-toggle");
        sidebarCtrl.toggleClass("active");
    })
  });
</script>


</html>
