<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>ReactJS基础</title>
  
  <!-- Meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
    <meta name="keywords" content="reactJs,browserify,webpack,jsx,isomorphic">
  
  
    <meta name="description" content="using reactJS build front view (web component)">
  

  <!-- Feed -->
  
    <link rel="alternative" href="/atom.xml" title="SixDegree" type="application/atom+xml">
  

  <!-- CSS -->
  <link rel="stylesheet" href="/bootstrap/dist/css/bootstrap.css">
  
	
		<link rel="stylesheet" href="/highlight/demo/styles/tomorrow-night-bright.css">
	
    
  
  <link rel="stylesheet" href="/css/fontello.css">
  <link rel="stylesheet" href="/css/style.css">

  <!-- Site Analyse -->
  
	<script>
	var userID='2bbb83cc0f781dd7502e9d5e19661866';
	var _hmt = _hmt || [];
	(function() {
	  var hm = document.createElement("script");
	  hm.src = "//hm.baidu.com/hm.js?"+userID;
	  var s = document.getElementsByTagName("script")[0]; 
	  s.parentNode.insertBefore(hm, s);
	})();
	</script>


</head>

<body data-spy="scroll" data-target="#nav-catalog">
  <div id="top-push"></div>
<a href="#top-push" id="go-top">
	<span class="glyphicon glyphicon-chevron-up"></span>
</a>
  <aside id="sidebar">
    <section class="sidebar-header">Catalog</section>
     <nav id="nav-catalog">
        <ol class="sidebar-nav nav"><li class="sidebar-nav nav-item sidebar-nav nav-level-2"><a class="sidebar-nav nav-link" href="#header-1"><span class="sidebar-nav nav-text">Starter</span></a><ol class="sidebar-nav nav-child"><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-2"><span class="sidebar-nav nav-text">Using Directly</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-3"><span class="sidebar-nav nav-text">Using Builded JS Depend on npm</span></a><ol class="sidebar-nav nav-child"><li class="sidebar-nav nav-item sidebar-nav nav-level-4"><a class="sidebar-nav nav-link" href="#header-4"><span class="sidebar-nav nav-text">Build by browserify</span></a></li></ol></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-5"><span class="sidebar-nav nav-text">Build by webpack</span></a></li></ol></li><li class="sidebar-nav nav-item sidebar-nav nav-level-2"><a class="sidebar-nav nav-link" href="#header-6"><span class="sidebar-nav nav-text">Basic Features</span></a><ol class="sidebar-nav nav-child"><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-7"><span class="sidebar-nav nav-text">Component</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-8"><span class="sidebar-nav nav-text">Element</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-9"><span class="sidebar-nav nav-text">Render</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-10"><span class="sidebar-nav nav-text">LifeCycle</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-11"><span class="sidebar-nav nav-text">Props</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-12"><span class="sidebar-nav nav-text">State</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-13"><span class="sidebar-nav nav-text">Refs</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-14"><span class="sidebar-nav nav-text">Form</span></a></li></ol></li><li class="sidebar-nav nav-item sidebar-nav nav-level-2"><a class="sidebar-nav nav-link" href="#header-15"><span class="sidebar-nav nav-text">Isomorphic</span></a><ol class="sidebar-nav nav-child"><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-16"><span class="sidebar-nav nav-text">一个简单示例</span></a></li></ol></li><li class="sidebar-nav nav-item sidebar-nav nav-level-2"><a class="sidebar-nav nav-link" href="#header-17"><span class="sidebar-nav nav-text">Use Extra JS in React</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-2"><a class="sidebar-nav nav-link" href="#header-18"><span class="sidebar-nav nav-text">Reference</span></a></li></ol>
    </nav>
  </aside>
  <span id="sidebar-ctrl" class="glyphicon glyphicon-list-alt circle"></span>
  <div id="wrapper">
    <header>
  <nav class="navbar navbar-default">
    <div class="container-fluid">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#nav-menu" aria-expanded="false">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="/">SixDegree</a>
      </div>
      <div class="collapse navbar-collapse" id="nav-menu">
        <ul class="nav navbar-nav navbar-right">
          
              <li  >
                <a href="/">Blogs</a>
              </li>
          
              <li  >
                <a href="/tags.html">Tags</a>
              </li>
          
              <li  >
                <a href="/about.html">About</a>
              </li>
          
          
              <li>
                <a href="/atom.xml" target="_blank">
                  <span class="icon-rss"></span>
                </a>
              </li>
          
              <li>
                <a href="http://github.com/sixdegree" target="_blank">
                  <span class="icon-github"></span>
                </a>
              </li>
          
        </ul>
      </div>
    </div>
  </nav>
</header>



    <div class="container">
      <article class="detail" role="main">
  <section class="post-header">
    <h1 class="post-title">ReactJS基础</h1>
    <ul class="post-meta">
      <li>
        <span class="glyphicon glyphicon-calendar"></span>
        <time datetime="2016-01-02T16:00:00.000Z">2016-01-03</time>
      </li>
      
        <li>
         <span class="glyphicon glyphicon-tags"></span>
          
            <a href="/tags.html#tag-ReactJs">ReactJs</a>
          
        </li>
      
    </ul>
  </section>
  <section class="post-content">
    <h2 id="header-1">Starter</h2>
<h3 id="header-2">Using Directly</h3>
<pre><code class="lang-vim">&gt; bower install react react-dom babel
</code></pre>
<pre><code class="lang-js">&lt;div id=&quot;example&quot;&gt;&lt;/div&gt;

&lt;script type=&quot;text/javascript&quot; src=&quot;bower_components/react/react.js&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;text/javascript&quot; src=&quot;bower_components/react/react-dom.js&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;text/javascript&quot; src=&quot;bower_components/babel/browser.min.js&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;text/babel&quot;&gt;
    // write your reactjs here
    ReactDOM.render(
      &lt;h1&gt;Hello, world!&lt;/h1&gt;,
      document.getElementById(&#39;example&#39;)
    );
&lt;/script&gt;
</code></pre>
<h3 id="header-3">Using Builded JS Depend on npm</h3>
<ol>
<li><p>下载ReactJS依赖包：</p>
<pre><code class="lang-vim"> &gt; npm install react react-dom --save
</code></pre>
</li>
<li><p>编写React：</p>
<pre><code class="lang-javascript"> // ./src/xx.jsx
 var React=require(&quot;react&quot;);
 var ReactDOM=require(&quot;react-dom&quot;);

 ReactDOM.render(&lt;h1&gt;Hello, world!&lt;/h1&gt;,document.getElementById(&#39;app&#39;));

 var element = React.createElement(&#39;h1&#39;, null, &#39;Hello, world!&#39;);
 ReactDOM.render(element,document.getElementById(&#39;example&#39;));
</code></pre>
</li>
<li><p>编译生成可直接在浏览器执行的JS (这里提供两种方法，参考下文)</p>
<ul>
<li>Method1: Build By Browserify</li>
<li>Method2: Build By Webpack</li>
</ul>
</li>
<li><p>HTML页面中直接调用生成的JS文件：</p>
<pre><code class="lang-html"> &lt;div id=&quot;app&quot; class=&quot;container&quot;&gt;&lt;/div&gt;
 &lt;script type=&quot;text/javascript&quot; src=&quot;xxx.js&quot;&gt;&lt;/script&gt;
</code></pre>
</li>
<li>可通过Gulp或Webpack插件实现Server热加载实时预览等功能，eg：<ul>
<li>gulp插件： <code>gulp-server-livereload</code></li>
<li>webpack插件：<code>webpack-dev-server</code> （还可结合使用<code>react-hot</code>高效react热加载功能）</li>
</ul>
</li>
</ol>
<h4 id="header-4">Build by browserify</h4>
<ul>
<li><p>下载依赖包：</p>
<pre><code class="lang-vim">  &gt; npm install browserify -g
  &gt; npm install babelify --save
  &gt; npm install watchify -g
</code></pre>
<p>  <a href="https://github.com/babel/babelify"><code>babelify</code></a> ：合并模块时对 ES6 和 ES7 进行编译转换，同时还可以对 JSX 进行编译转换，也可使用 <a href="https://www.npmjs.com/package/reactify">reactify</a></p>
<p>   <a href="https://github.com/substack/watchify"> <code>watchify</code></a> ：监听，配合 <code>browserify</code> 实现实时合并 (是一个<code>browserify</code>的封装，配置同<code>browserify</code>)</p>
</li>
</ul>
<ul>
<li><p>执行</p>
<ul>
<li><p><code>browserify</code> 合并模块</p>
<pre><code class="lang-vim">&gt; browserify ./src/app.jsx -t babelify -o ./dist/bundle.js

//如果require的module的后缀不为.js,.json，需添加-extension参数，eg：
&gt; browserify ./src/app.jsx -t babelify -o ./dist/bundle.js --extension .jsx
</code></pre>
</li>
<li><p><code>watchify</code> 监听</p>
<pre><code>&gt; watchify ./src/app.jsx -t babelify --extension .jsx  -o ./dist/bundle.js -v
</code></pre></li>
<li><p>可在<code>package.json</code>中配置<code>browserify</code></p>
<pre><code class="lang-json">&quot;browserify&quot; : {
      &quot;transform&quot;: [
          [&quot;reactify&quot;, {&quot;es6&quot;: true}]
      ]，
      &quot;extensions&quot;:[&quot;.jsx&quot;]
  }
</code></pre>
<pre><code class="lang-vim">&gt; browserify xxx.jsx -o xxx.js
&gt; watchify xxx.jsx -o xxx.js
</code></pre>
</li>
<li><p>可使用 <code>gulp</code> </p>
<pre><code class="lang-js">var gulp=require(&quot;gulp&quot;);
var gutil=require(&quot;gulp-util&quot;);
var source = require(&#39;vinyl-source-stream&#39;);
var watchify=require(&quot;watchify&quot;);
var browserify = require(&#39;browserify&#39;);
var babelify=require(&quot;babelify&quot;);
var argv=require(&quot;yargs&quot;).argv;

function doBuild(filename){
  if(!filename)
      filename=&quot;app&quot;;

  var b=watchify(browserify({
      entries:[&quot;./src/&quot;+filename+&quot;.jsx&quot;],
      transform:[babelify],
      extensions:[&quot;.jsx&quot;],
      debug: true,
      cache: {},
      packageCache: {},
      fullPaths: true
  }));

  function build(file){
      if(file)
          gutil.log(&#39;Recompiling &#39; + file);
      b.bundle()
      .on(&#39;error&#39;,gutil.log.bind(gutil,&quot;Browserify Error&quot;))
      .pipe(source(filename+&quot;.js&quot;))
      .pipe(gulp.dest(&#39;./dist&#39;));
  };

  build();
  b.on(&#39;update&#39;,build);
}

gulp.task(&#39;build&#39;,function(){
  var filename=argv.n || &quot;app&quot;;
  doBuild(filename);
})
</code></pre>
<pre><code class="lang-vim">&gt; gulp build
</code></pre>
</li>
</ul>
</li>
</ul>
<h3 id="header-5">Build by webpack</h3>
<ul>
<li><p>下载依赖包</p>
<pre><code class="lang-vim">  &gt; npm install jsx-loader --save
</code></pre>
</li>
<li><p>编写webpack.config.js</p>
<pre><code class="lang-javascript">  //webpack.config.js
  module.exports = {
      entry: &quot;./src/questionApp.jsx&quot;,
      output: {
          path: __dirname+&quot;/dist&quot;,
          filename: &quot;questionApp-webpack.js&quot;
          publicPath:&quot;/dist&quot;
      },
      resolve: {
          extensions: [&#39;&#39;,&#39;.js&#39;,&#39;.jsx&#39;]
      },
      module: {
          loaders: [
              //{ test: /\.jsx$/, loader: &quot;babel-loader!jsx-loader?harmony&quot; }
              { test: /\.jsx$/, loader: &quot;jsx&quot; }
          ]
      }
  };
</code></pre>
</li>
<li><p>执行</p>
<pre><code class="lang-vim">  &gt; webpack
</code></pre>
<p>  或通过webpack-dev-server Visit <a href="http://127.0.0.1:8080">http://127.0.0.1:8080</a> with your browser.（先下载包： <code>npm install webpack-dev-server -g</code>）</p>
<pre><code class="lang-vim">  &gt; webpack-dev-server
  //启动热加载
  &gt; webpack-dev-server --hot --inline
</code></pre>
</li>
</ul>
<h2 id="header-6">Basic Features</h2>
<h3 id="header-7">Component</h3>
<pre><code class="lang-javascript">var reactComponent=React.createClass({
    ...
    render:function(){
        ...
        return ...
    },
    ...
});
</code></pre>
<h3 id="header-8">Element</h3>
<pre><code class="lang-javascript">var reactElement = React.createElement(type, props, children);
</code></pre>
<p>或通过Factory创建Element：</p>
<pre><code class="lang-javascript">var tag = React.createFactory(type);
var reactElement = tag(props, children);
</code></pre>
<p>使用示例：</p>
<pre><code class="lang-javascript">var element=React.createElement(&#39;div&#39;, {className:&#39;my-div&#39;}, &#39;Hello, world!&#39;);

//或：
var div = React.createFactory(&#39;div&#39;);
var element = div({ className: &#39;my-div&#39; },&#39;Hello, world!&#39;);
</code></pre>
<h3 id="header-9">Render</h3>
<pre><code class="lang-javascript">ReactDOM.render(reactElement,domContainerNode,callback);
</code></pre>
<p>使用示例：</p>
<pre><code class="lang-javascript">var Question=require(&quot;./components/question&quot;);
var propOpts={...};

//use createElement:
var element=React.createElement(Question, propOpts);
ReactDOM.render(element,document.getElementById(&#39;app&#39;));

//or use createFactory:
var QuestionFactory=React.createFactory(Question);
ReactDOM.render(QuestionFactory(propOpts),document.getElementById(&#39;app&#39;));

//or use JSX:
ReactDOM.render(&lt;Question {...propOpts} /&gt;,document.getElementById(&#39;app&#39;));
</code></pre>
<pre><code class="lang-javascript">// ./components/question.jsx:
var React=require(&quot;react&quot;);
module.exports=React.createClass({
    ...
    render:function(){
        ...
        //use JSX:
        return (&lt;div className=&#39;my-div&#39;&gt;Question System&lt;/div&gt;);
        //or use createElement:
        //return React.createElement(&#39;div&#39;,{className:my-div},&#39;Question System&#39;);
    },
    ...
})
</code></pre>
<h3 id="header-10">LifeCycle</h3>
<p><strong>Component Lifecycle :</strong></p>
<ul>
<li>Mounting :<ul>
<li>void componentWillMount()</li>
<li>void componentDidMount()</li>
</ul>
</li>
<li>Updating :<ul>
<li>receive new props<ul>
<li>void componentWillReceiveProps (object nextProps)</li>
</ul>
</li>
<li>boolean shouldComponentUpdate(object nextProps, object nextState)</li>
<li>void componentWillUpdate( object nextProps, object nextState)</li>
<li>void componentDidUpdate(object prevProps, object prevState)</li>
</ul>
</li>
<li>UnMount :<ul>
<li>void componentWillUnmount()</li>
</ul>
</li>
</ul>
<p><strong>note:</strong>
    shouldComponentUpdate(nextProps,nextStates) &amp; render()
    should in mixin or component (only in one place)</p>
<p><strong>Initial (第一次 render ) :</strong></p>
<ul>
<li>-&gt; getDefaultProps</li>
<li>-&gt; getInitialState</li>
<li>-&gt; componentWillMount</li>
<li>-&gt; render<ul>
<li>sub component (do same initial cycle)</li>
</ul>
</li>
<li>-&gt; componentDidmount</li>
<li>-&gt; RenderFinished!</li>
</ul>
<p><strong>Update (第n次 render )：</strong></p>
<ul>
<li>-&gt; shouldComponentUpdate(nextProps,nextState)<ul>
<li>return false -- stop here</li>
<li>return true -- go to next</li>
</ul>
</li>
<li>-&gt; componentWillUpdate(nextProps,nextState)</li>
<li>-&gt; render<ul>
<li>Sub Component： componentWillReceiveProps(nextProps)</li>
<li>Sub Component： shouldComponentUpdate(nextProps,nextState)</li>
<li>Sub Component： componentWillUpdate(nextProps,nextState)</li>
<li>Sub Component： componentDidUpdate(prevProps,prevState)</li>
</ul>
</li>
<li>-&gt; componentDidUpdate(prevProps,prevState)</li>
</ul>
<p><strong>Initial （has Mixins）:</strong></p>
<ul>
<li>-&gt; getDefaultProps -- Mixins + Component (merge return) -- can&#39;t set same property</li>
<li>-&gt; getInitialState -- Mixins + Component (merge return) -- can&#39;t set same property</li>
<li>-&gt; Mixins: componentWillMount</li>
<li>-&gt; componentWillMount</li>
<li>-&gt; render -- in Mixins or Component</li>
<li>-&gt; Mixins: componentDidMount</li>
<li>-&gt; componentDidMount</li>
<li>-&gt; RenderFinished!</li>
</ul>
<p><strong>update （has Mixins）:</strong></p>
<ul>
<li>-&gt; shouldComponentUpdate -- in Mixins or Component</li>
<li>-&gt; Mixins: componentWillUpdate</li>
<li>-&gt; componentWillUpdate</li>
<li>-&gt; render -- in Mixins or Component</li>
<li>-&gt; Mixins: componentDidUpdate</li>
<li>-&gt; componentDidUpdate</li>
</ul>
<h3 id="header-11">Props</h3>
<p>初始化props：</p>
<pre><code>getDefaultProps:function(){
    return {...}
},
</code></pre><p>可通过定义propTypes限定props，eg：</p>
<pre><code>propTypes: {
    value: React.PropTypes.object.isRequired,
    onChange: React.PropTypes.func.isRequired,
    onSubmit: React.PropTypes.func.isRequired,
},
</code></pre><p>使用时传入props参数：</p>
<pre><code>&lt;Tag {...opts} /&gt;
&lt;Tag xxx=&#39;...&#39; yyy={...} zzz=...  ... /&gt;
</code></pre><p>当传入新的props参数时，会触发Component的以下方法：</p>
<pre><code>void componentWillReceiveProps (object nextProps)
boolean shouldComponentUpdate(object nextProps, object nextState)
void componentWillUpdate( object nextProps, object nextState)
void render()
void componentDidUpdate(object prevProps, object prevState)
</code></pre><p>注意</p>
<ul>
<li><code>this.props.children</code>是获取当前节点的全部子内容</li>
<li><code>this.props.xxx</code>获取参数值（注意不可这样修改props）</li>
<li>Component间传递：<ul>
<li>Father state/props to Children&#39; props</li>
<li>refs</li>
</ul>
</li>
</ul>
<h3 id="header-12">State</h3>
<p>初始化state：</p>
<pre><code>getInitialState:function(){
    return {...}
}
</code></pre><p>获取state值：</p>
<ul>
<li><code>this.state.xxx</code></li>
</ul>
<p>设置state值：</p>
<ul>
<li><code>this.setState({...})</code></li>
<li><code>this.state.xxx=...;</code>,还需调用<code>this.forceUpdate()</code>生效</li>
</ul>
<p>当state变化时会触发以下方法：</p>
<pre><code>boolean shouldComponentUpdate(object nextProps, object nextState)
void componentWillUpdate( object nextProps, object nextState)
void render()
void componentDidUpdate(object prevProps, object prevState)
</code></pre><h3 id="header-13">Refs</h3>
<p>设置ref（可以绑定到 render() 输出的任何组件上去），eg：</p>
<pre><code>&lt;input type=&quot;text&quot; defaultValue={this.state.inputValue} ref=&quot;goodInput&quot;/&gt;
</code></pre><p>获取：</p>
<ul>
<li>access the component instance: <code>this.refs.xxx</code> or <code>this.refs[xxx]</code></li>
<li>access the DOM <code>ReactDOM.findDOMNode(componentInstance)</code></li>
</ul>
<p>eg：</p>
<pre><code>//在function中抓取我們動態render的某個UI元素
this.refs.goodInput

this.refs.goodInput.value
this.refs.goodInput.focus()
ReactDOM.findDOMNode(this.refs.goodInput).focus();
</code></pre><h3 id="header-14">Form</h3>
<ul>
<li>Interactive props: <code>value</code>,<code>checked</code>,<code>selected</code></li>
<li>SyntheticEvent ：React对Event进行了封装</li>
<li>Form Events: <code>onChange</code>, <code>onInput</code>,<code>onClick</code>, <code>onSubmit</code>,<code>onReset</code>,...</li>
</ul>
<p>eg:</p>
<pre><code class="lang-javascript">render:function(){
    return (
    &lt;form onSubmit={this.submitHandler}&gt;
        &lt;input type=&quot;text&quot; value={this.state.inputValue} onChange={this.inputHandler}/&gt;
        &lt;br/&gt;
        &lt;input type=&quot;radio&quot; name=&quot;goodRadio&quot; value=&quot;A&quot; defaultChecked onChange={this.radioHandler}/&gt;A
        &lt;input type=&quot;radio&quot; name=&quot;goodRadio&quot; value=&quot;B&quot; onChange={this.radioHandler}/&gt;B
        &lt;input type=&quot;radio&quot; name=&quot;goodRadio&quot; value=&quot;C&quot; onChange={this.radioHandler}/&gt;C
        &lt;button type=&quot;reset&quot; &gt;Reset&lt;/button&gt; &lt;button type=&quot;submit&quot;&gt;Submit&lt;/button&gt;
    &lt;/form&gt;
    )
},

submitHandler:function(e){
    // React对event进行了优化，若未使用则e填充值都为null
    console.log(e);
    console.log(e.target);
    console.log(e.type);
    console.log(this.state);
    e.preventDefault();
},
resetHandler:function(e){
    if(e) e.preventDefault();
    ReactDOM.findDOMNode(this.refs.regForm).reset();
},
inputHandler:function(e){
    this.setState({inputValue:e.target.value});
},
radioHandler:function(e){
    this.setState({radioValue:e.target.value});
},
...
</code></pre>
<h2 id="header-15">Isomorphic</h2>
<p>同构，可在client或server端渲染React对象，统一使用，提供渲染速度，利于SEO</p>
<p>使用 <code>ReactDOMServer</code> (in <code>react-dom/server</code> package)</p>
<ul>
<li><code>string renderToString(ReactElement element)</code></li>
<li><code>string renderToStaticMarkup(ReactElement element)</code> //doesn&#39;t create extra DOM attributes such as data-react-id, that React uses internally</li>
</ul>
<h3 id="header-16">一个简单示例</h3>
<ol>
<li><p><code>messageBox.jsx</code> 定义需要同构的React Component：</p>
<pre><code class="lang-javascript"> var MessageBox = React.createClass({
   getInitialState: function() {
     return {value: &#39;Hello!&#39;};
   },
   handleChange: function(event) {
     this.setState({value: event.target.value});
   },
   render: function () {
     var value = this.state.value;
     return (
       &lt;div&gt;
           &lt;h1&gt;This is Isomorphic Test:&lt;/h1&gt;
         &lt;input type=&quot;text&quot; value={value} onChange={this.handleChange} /&gt;
         &lt;p&gt;Inputed:{value}&lt;/p&gt;
       &lt;/div&gt;
     );
   }
 });
 module.exports=MessageBox;
</code></pre>
</li>
<li><p><code>app.jsx</code> 实现Client端渲染：</p>
<pre><code class="lang-javascript"> var MessageBox=require(&#39;messageBox.jsx&#39;);
 ReactDOM.render(&lt;MessageBox/&gt;,document.getElementById(&#39;app&#39;));
</code></pre>
</li>
<li><p><code>app.js</code> 编译生成的Client端可执行的js文件</p>
<pre><code class="lang-vim"> &gt; browserify app.jsx -t babelify --presets react -o app.js --extension .jsx
</code></pre>
<p> 生成的js如下：</p>
<pre><code class="lang-javascript"> (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==&quot;function&quot;&amp;&amp;require;if(!u&amp;&amp;a)return a(o,!0);if(i)return i(o,!0);var f=new Error(&quot;Cannot find module &#39;&quot;+o+&quot;&#39;&quot;);throw f.code=&quot;MODULE_NOT_FOUND&quot;,f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==&quot;function&quot;&amp;&amp;require;for(var o=0;o&lt;r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
 &#39;use strict&#39;;

 var MessageBox = React.createClass({
   displayName: &#39;MessageBox&#39;,

   getInitialState: function getInitialState() {
     return { value: &#39;Hello!&#39; };
   },
   handleChange: function handleChange(event) {
     this.setState({ value: event.target.value });
   },
   render: function render() {
     var value = this.state.value;
     return React.createElement(
       &#39;div&#39;,
       null,
       React.createElement(
         &#39;h1&#39;,
         null,
         &#39;This is Isomorphic Test:&#39;
       ),
       React.createElement(&#39;input&#39;, { type: &#39;text&#39;, value: value, onChange: this.handleChange }),
       React.createElement(
         &#39;p&#39;,
         null,
         &#39;Inputed:&#39;,
         value
       )
     );
   }
 });

 ReactDOM.render(React.createElement(MessageBox, null), document.getElementById(&#39;app&#39;));

 },{}]},{},[1]);
</code></pre>
</li>
<li><p><code>index.html</code> 定义主页面，加载上面生成的Client的js文件<code>app.js</code></p>
<pre><code class="lang-html"> &lt;!DOCTYPE html&gt;
 &lt;html lang=&quot;en&quot;&gt;
 &lt;head&gt;
   &lt;meta charset=&quot;UTF-8&quot;&gt;
   &lt;title&gt;Hello React!&lt;/title&gt;
 &lt;/head&gt;
 &lt;body&gt;

   &lt;div id=&quot;app&quot;&gt;{content}&lt;/div&gt;

   &lt;script type=&quot;text/javascript&quot; src=&quot;libs/react/react.js&quot;&gt;&lt;/script&gt;
   &lt;script type=&quot;text/javascript&quot; src=&quot;libs/react/react-dom.js&quot;&gt;&lt;/script&gt;
   &lt;script type=&quot;text/javascript&quot; src=&quot;app.js&quot;&gt;&lt;/script&gt;

 &lt;/body&gt;
 &lt;/html&gt;
</code></pre>
</li>
<li><p><code>server.js</code> 定义Server端响应渲染</p>
<pre><code class="lang-javascript"> require(&quot;babel-core/register&quot;);

 var React=require(&quot;react&quot;);
 var ReactDOMServer=require(&quot;react-dom/server&quot;);
 var http=require(&quot;http&quot;);
 var fs=require(&quot;fs&quot;);

 var server=http.createServer(function(req,res){
     console.log(req.url);
     if(req.url==&#39;/&#39; || req.url==&#39;/index.html&#39;){
         var element = React.createElement(require(&quot;./messageBox.jsx&quot;));
         var reactHtml = ReactDOMServer.renderToString(element);

         fs.readFile(&quot;./index.html&quot;,function(err,data){
             if (err) throw err;
             res.writeHead(200,{&#39;Content-Type&#39;:&#39;text/html&#39;});
               res.end(data.toString().replace(&quot;{content}&quot;,reactHtml));
         });
     }else if(req.url.startsWith(&quot;/libs&quot;)){
         fs.readFile(&quot;.&quot;+req.url,function(err,data){
             if(err) throw err;
             res.writeHead(200);
               res.end(data);
         })
     }else{
         res.writeHead(400,{&#39;Content-Type&#39;:&#39;text/plain&#39;});
         res.end(&quot;not found&quot;);
     }
 });

 server.listen(3000, &#39;localhost&#39;, function (err, result) {
   if (err) console.log(err);
   console.log(&#39;Listening at localhost:3000&#39;);
 });
</code></pre>
</li>
<li><p>执行<code>node server</code>启动服务查看效果</p>
</li>
</ol>
<p><strong>PS:</strong>
如果出现无法识别解析JSX的错误，请检查使用的<code>babel-core</code>版本，6和5的使用上会有些不同，具体可参考<a href="http://jamesknelson.com/the-six-things-you-need-to-know-about-babel-6/">The Six Things You Need To Know About Babel 6</a></p>
<h2 id="header-17">Use Extra JS in React</h2>
<p><strong>eg:</strong> Using JQuery in React</p>
<pre><code class="lang-javascript">var $=require(&quot;jquery&quot;);
module.exports=React.createClass({
    componentDidMount:function(){
        //一般在这里进行初始化绑定dom
        //eg: $(&#39;#xxx&#39;).modal(&#39;hide&#39;);
    },
    ...
    //可在其他方法中调用操作
    //eg: $(&#39;#xxx&#39;).modal(&#39;show&#39;);
});
</code></pre>
<p><strong>eg:</strong> Using highlight.js in React <a href="https://github.com/isagalaev/highlight.js/issues/925">Issue on Github</a></p>
<pre><code class="lang-javascript">var hljs =require(&quot;highlight.js&quot;);
var Pretty = React.createClass({
    componentDidMount: function(){
        var current = React.findDOMNode(this);
        hljs.highlightBlock(current);
    },
    render: function() {
        return &lt;pre className=&quot;custom-json-body&quot;&gt;
                    &lt;code className=&quot;json&quot;&gt;{JSON.stringify(this.props.json, null, 2)}&lt;/code&gt;
               &lt;/pre&gt;;
    }
});
</code></pre>
<p><strong>PS:</strong>
一般不推荐在React中注入其他作用域的代码，推荐使用相应的React Plugins或自行扩展实现功能（尽量保持都在React的作用域）</p>
<h2 id="header-18">Reference</h2>
<ul>
<li>ReactJS<ul>
<li><a href="https://facebook.github.io/react/docs">Doc En</a> | <a href="http://reactjs.cn/react/docs">Doc Cn</a> | <a href="https://github.com/facebook/react">Github</a></li>
<li><a href="http://react-china.org/">React China</a> | <a href="http://wiki.jikexueyuan.com/project/react/">中文版开发手册</a> </li>
<li><a href="https://github.com/ruanyf/react-demos">Demos from ruanyf</a></li>
</ul>
</li>
<li>Build<ul>
<li>Browserify<ul>
<li><a href="http://browserify.org/">官网</a> | <a href="https://github.com/substack/node-browserify#usage">Usage</a></li>
<li><a href="http://segmentfault.com/a/1190000002941361">前端模块及依赖管理的新选择：Browserify</a></li>
<li><a href="https://github.com/substack/watchify">watchify on Github</a></li>
</ul>
</li>
<li>Webpack<ul>
<li><a href="http://webpack.github.io/docs/">Doc</a></li>
<li><a href="https://www.gitbook.com/book/zhaoda/webpack/details">中文指南</a> | <a href="https://www.gitbook.com/book/wohugb/react-webpack-cookbook/details">react-webpack-cookbook</a> | <a href="https://christianalfoni.github.io/react-webpack-cookbook">Cookbook</a></li>
<li><a href="http://segmentfault.com/a/1190000002551952">入门指迷</a> | <a href="http://www.07net01.com/2015/08/webpack%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0">学习笔记</a> | <a href="http://segmentfault.com/a/1190000002767365">轻松入门React和Webpack</a></li>
<li><a href="https://github.com/ruanyf/webpack-demos">Demos from ruanyf</a></li>
</ul>
</li>
<li>Babel<ul>
<li><a href="http://babeljs.io">官网</a></li>
<li><a href="https://cnodejs.org/topic/56460e0d89b4b49902e7fbd3">在node中使用babel6的一些简单分享</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="https://github.com/sixDegree/react-starter">My Demos</a></li>
</ul>
  </section>
</article>

      <hr/>
      
<section class="post-comment">
	
		<div id="gitment_container"></div>

<link rel="stylesheet" href="/gitment/default.css">
<script src="/gitment/gitment.browser.js"></script>


<script type="text/javascript">
	var gitment = new Gitment({
	  id: document.location.pathname,
	  owner: 'chenjin-zero',
	  repo: 'blogComment',
	  oauth: {
	    client_id: '36a09bb7399efe69c6ce',
	    client_secret: 'ad9ad546b23b708c71d92e513dc36e0486179dea',
	  }
	})
      
	gitment.render('gitment_container')
</script>
	
</section>

    </div>
  </div>
</body>

<script src="/jquery/dist/jquery.min.js"></script>
<script src="/bootstrap/dist/js/bootstrap.min.js"></script>


	<script src="/highlight/highlight.pack.js"></script>
	<script type="text/javascript">
		hljs.initHighlightingOnLoad();
	</script>






<script type="text/javascript">

  $(document).ready(function(){
    var sidebarCtrl=$("#sidebar-ctrl");
    var sidebar=$("#sidebar");
    var wrapper=$("#wrapper");
    sidebarCtrl.on("click",function(event){
        //alert("click");
        sidebar.toggleClass("sidebar-toggle");
        wrapper.toggleClass("sidebar-toggle");
        sidebarCtrl.toggleClass("sidebar-toggle");
        sidebarCtrl.toggleClass("active");
    })
  });
</script>


</html>
