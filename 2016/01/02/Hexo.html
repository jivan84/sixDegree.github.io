<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Hexo搭建说明</title>
  
  <!-- Meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
    <meta name="keywords" content="hexo,static-generator,blog,seo,nodejs,markdown">
  
  

  <!-- Feed -->
  
    <link rel="alternative" href="/atom.xml" title="SixDegree" type="application/atom+xml">
  

  <!-- CSS -->
  <link rel="stylesheet" href="/bootstrap/dist/css/bootstrap.css">
  
    <link rel="stylesheet" href="/highlight/demo/styles/tomorrow-night-bright.css">
  
  <link rel="stylesheet" href="/css/fontello.css">
  <link rel="stylesheet" href="/css/style.css">

  <!-- Site Analyse -->
  
	<script>
	var userID='2bbb83cc0f781dd7502e9d5e19661866';
	var _hmt = _hmt || [];
	(function() {
	  var hm = document.createElement("script");
	  hm.src = "//hm.baidu.com/hm.js?"+userID;
	  var s = document.getElementsByTagName("script")[0]; 
	  s.parentNode.insertBefore(hm, s);
	})();
	</script>


</head>

<body data-spy="scroll" data-target="#nav-catalog">
  <div id="top-push"></div>
<a href="#top-push" id="go-top">
	<span class="glyphicon glyphicon-chevron-up"></span>
</a>
  <aside id="sidebar">
    <section class="sidebar-header">Catalog</section>
     <nav id="nav-catalog">
        <ol class="sidebar-nav nav"><li class="sidebar-nav nav-item sidebar-nav nav-level-2"><a class="sidebar-nav nav-link" href="#header-1"><span class="sidebar-nav nav-text">1. Hexo Start</span></a><ol class="sidebar-nav nav-child"><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-2"><span class="sidebar-nav nav-text">1.1 安装</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-3"><span class="sidebar-nav nav-text">1.2 搭建测试环境</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-4"><span class="sidebar-nav nav-text">1.3 启用命令</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-5"><span class="sidebar-nav nav-text">1.4 常用命令扩展</span></a></li></ol></li><li class="sidebar-nav nav-item sidebar-nav nav-level-2"><a class="sidebar-nav nav-link" href="#header-6"><span class="sidebar-nav nav-text">2. 一些使用说明</span></a><ol class="sidebar-nav nav-child"><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-7"><span class="sidebar-nav nav-text">Scaffold （文章脚手架）</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-8"><span class="sidebar-nav nav-text">draft （草稿）</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-9"><span class="sidebar-nav nav-text">assert （资源文件）</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-10"><span class="sidebar-nav nav-text">Skip Render</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-11"><span class="sidebar-nav nav-text">front-matter</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-12"><span class="sidebar-nav nav-text">Read More</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-13"><span class="sidebar-nav nav-text">Data （数据文件）</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-14"><span class="sidebar-nav nav-text">EJS</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-15"><span class="sidebar-nav nav-text">Theme</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-16"><span class="sidebar-nav nav-text">Highlight</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-17"><span class="sidebar-nav nav-text">Marked</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-18"><span class="sidebar-nav nav-text">使用MathJax解析Latex</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-19"><span class="sidebar-nav nav-text">Scripts</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-20"><span class="sidebar-nav nav-text">Deploy</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-21"><span class="sidebar-nav nav-text">Migrate （迁移）</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-22"><span class="sidebar-nav nav-text">Config （配置说明）</span></a></li></ol></li><li class="sidebar-nav nav-item sidebar-nav nav-level-2"><a class="sidebar-nav nav-link" href="#header-23"><span class="sidebar-nav nav-text">3. 应用扩展</span></a><ol class="sidebar-nav nav-child"><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-24"><span class="sidebar-nav nav-text">tagCloud</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-25"><span class="sidebar-nav nav-text">toc</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-26"><span class="sidebar-nav nav-text">feed</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-27"><span class="sidebar-nav nav-text">sitemap</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-28"><span class="sidebar-nav nav-text">Comments</span></a><ol class="sidebar-nav nav-child"><li class="sidebar-nav nav-item sidebar-nav nav-level-4"><a class="sidebar-nav nav-link" href="#header-29"><span class="sidebar-nav nav-text">Disqus</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-4"><a class="sidebar-nav nav-link" href="#header-30"><span class="sidebar-nav nav-text">多说</span></a></li></ol></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-31"><span class="sidebar-nav nav-text">Search</span></a><ol class="sidebar-nav nav-child"><li class="sidebar-nav nav-item sidebar-nav nav-level-4"><a class="sidebar-nav nav-link" href="#header-32"><span class="sidebar-nav nav-text">Swiftype</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-4"><a class="sidebar-nav nav-link" href="#header-33"><span class="sidebar-nav nav-text">TinySou</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-4"><a class="sidebar-nav nav-link" href="#header-34"><span class="sidebar-nav nav-text">Google</span></a></li></ol></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-35"><span class="sidebar-nav nav-text">Share</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-36"><span class="sidebar-nav nav-text">Analytics</span></a></li></ol></li><li class="sidebar-nav nav-item sidebar-nav nav-level-2"><a class="sidebar-nav nav-link" href="#header-37"><span class="sidebar-nav nav-text">4. 源码概要</span></a><ol class="sidebar-nav nav-child"><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-38"><span class="sidebar-nav nav-text">4.1 基础目录</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-39"><span class="sidebar-nav nav-text">4.2 Hexo Core</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-40"><span class="sidebar-nav nav-text">4.3 Hexo model</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-41"><span class="sidebar-nav nav-text">4.4 Hexo Processor</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-42"><span class="sidebar-nav nav-text">4.5 Hexo Generator</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-43"><span class="sidebar-nav nav-text">4.6 Hexo Renderer</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-44"><span class="sidebar-nav nav-text">4.7 Hexo Theme</span></a></li></ol></li><li class="sidebar-nav nav-item sidebar-nav nav-level-2"><a class="sidebar-nav nav-link" href="#header-45"><span class="sidebar-nav nav-text">5. Hexo Variables</span></a><ol class="sidebar-nav nav-child"><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-46"><span class="sidebar-nav nav-text">5.1. config 配置变量</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-47"><span class="sidebar-nav nav-text">5.2 site 网站变量</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-48"><span class="sidebar-nav nav-text">5.3 page 页面变量</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-49"><span class="sidebar-nav nav-text">5.4 其他</span></a></li></ol></li><li class="sidebar-nav nav-item sidebar-nav nav-level-2"><a class="sidebar-nav nav-link" href="#header-50"><span class="sidebar-nav nav-text">6. Hexo Helper</span></a><ol class="sidebar-nav nav-child"><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-51"><span class="sidebar-nav nav-text">6.1 URL</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-52"><span class="sidebar-nav nav-text">6.2 HTML</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-53"><span class="sidebar-nav nav-text">6.3.Condition</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-54"><span class="sidebar-nav nav-text">6.4 String &amp; Date &amp; Number</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-55"><span class="sidebar-nav nav-text">6.5 Parse</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-56"><span class="sidebar-nav nav-text">6.6 List</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-57"><span class="sidebar-nav nav-text">6.7 Special</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-3"><a class="sidebar-nav nav-link" href="#header-58"><span class="sidebar-nav nav-text">6.8 其他</span></a></li></ol></li><li class="sidebar-nav nav-item sidebar-nav nav-level-2"><a class="sidebar-nav nav-link" href="#header-59"><span class="sidebar-nav nav-text">Hexo标签插件</span></a></li><li class="sidebar-nav nav-item sidebar-nav nav-level-2"><a class="sidebar-nav nav-link" href="#header-60"><span class="sidebar-nav nav-text">References</span></a></li></ol>
    </nav>
  </aside>
  <span id="sidebar-ctrl" class="glyphicon glyphicon-list-alt circle"></span>
  <div id="wrapper">
    <header>
  <nav class="navbar navbar-default">
    <div class="container-fluid">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#nav-menu" aria-expanded="false">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="/">SixDegree</a>
      </div>
      <div class="collapse navbar-collapse" id="nav-menu">
        <ul class="nav navbar-nav navbar-right">
          
              <li  >
                <a href="/">Blogs</a>
              </li>
          
              <li  >
                <a href="/tags.html">Tags</a>
              </li>
          
              <li  >
                <a href="/about.html">About</a>
              </li>
          
          
              <li>
                <a href="/atom.xml" target="_blank">
                  <span class="icon-rss"></span>
                </a>
              </li>
          
              <li>
                <a href="http://github.com/sixdegree" target="_blank">
                  <span class="icon-github"></span>
                </a>
              </li>
          
        </ul>
      </div>
    </div>
  </nav>
</header>



    <div class="container">
      <article class="detail" role="main">
  <section class="post-header">
    <h1 class="post-title">Hexo搭建说明</h1>
    <ul class="post-meta">
      <li>
        <span class="glyphicon glyphicon-calendar"></span>
        <time datetime="2016-01-01T16:00:00.000Z">2016-01-02</time>
      </li>
      
        <li>
         <span class="glyphicon glyphicon-tags"></span>
          
            <a href="/tags.html#tag-NodeJs">NodeJs</a>
          
        </li>
      
    </ul>
  </section>
  <section class="post-content">
    <h2 id="header-1">1. Hexo Start</h2>
<h3 id="header-2">1.1 安装</h3>
<pre><code class="nullvim">&gt; npm install hexo-cli -g
&gt; hexo <span class="hljs-keyword">version</span>
&gt; hexo <span class="hljs-keyword">help</span>
</code></pre>
<h3 id="header-3">1.2 搭建测试环境</h3>
<pre><code class="nullvim">&gt; hexo init [project]
&gt; <span class="hljs-keyword">cd</span> [project]
&gt; npm install
&gt; hexo <span class="hljs-keyword">new</span> [layout] <span class="hljs-symbol">&lt;title&gt;</span>
</code></pre>
<h3 id="header-4">1.3 启用命令</h3>
<pre><code class="nullvim">&gt; hexo server    # run        localhos<span class="hljs-variable">t:4000</span>/
&gt; hexo clean    # clean        public/, db.json
&gt; hexo g         # generate     public/xxx
&gt; hexo d         # deploy    deploy/xxx
</code></pre>
<h3 id="header-5">1.4 常用命令扩展</h3>
<pre><code class="nullvim">&gt; npm install <span class="hljs-symbol">&lt;plugin-name&gt;</span> --save            #安装插件
&gt; git clone <span class="hljs-symbol">&lt;repository&gt;</span> themes/<span class="hljs-symbol">&lt;theme-name&gt;</span>    #下载主题

&gt; hexo server -<span class="hljs-keyword">p</span> xxx    # --port <span class="hljs-keyword">set</span> port at xxx
&gt; hexo server --<span class="hljs-keyword">debug</span>    # console out (<span class="hljs-built_in">log</span> leve<span class="hljs-variable">l:</span> <span class="hljs-keyword">debug</span>,info,warn,error)

&gt; hexo <span class="hljs-keyword">list</span> <span class="hljs-symbol">&lt;type&gt;</span>        # <span class="hljs-keyword">list</span> site information (<span class="hljs-built_in">type</span>: page, post, route, <span class="hljs-keyword">tag</span>)

&gt; hexo render <span class="hljs-symbol">&lt;file&gt;</span>    # use renderer plugins render
&gt; hexo publish <span class="hljs-symbol">&lt;filename&gt;</span>    # <span class="hljs-keyword">move</span> _drafts/xxx <span class="hljs-keyword">to</span> _post/xxx

&gt; hexo <span class="hljs-symbol">&lt;cmd&gt;</span> --config <span class="hljs-symbol">&lt;configFile&gt;</span> # 指定全局配置文件
(<span class="hljs-keyword">e</span><span class="hljs-variable">g:</span> hexo server --config _config-test.yml)
</code></pre>
<p><strong>PS:</strong>命令行可参考代码：<code>node_modules\hexo\lib\plugins\console\index.js</code></p>
<h2 id="header-6">2. 一些使用说明</h2>
<h3 id="header-7">Scaffold （文章脚手架）</h3>
<p>在<code>/scaffolds</code>下可配置对应layout的<code>front-matter</code>，在使用命令新建或发布文章时会自动匹配结合<code>front-matter</code>部分</p>
<pre><code>hexo new [layout] &lt;title&gt;
hexo publish &lt;title&gt;
</code></pre><p>( 源码： node_modules\hexo\lib\plugins\console\new.js调用node_modules\hexo\lib\hexo\post.js的create,publish方法)</p>
<h3 id="header-8">draft （草稿）</h3>
<ul>
<li>放在<code>/source/_drafts</code>下</li>
<li>可使用命令<code>hexo new draft &lt;title&gt;</code>创建草稿</li>
<li>通过命令<code>hexo publish &lt;title&gt;</code>可将_drafts下的文章移动到<code>_posts</code>下<ul>
<li>会按配置的<code>new_post_name</code>命名文章</li>
<li>如果配置了<code>post_asset_folder: true</code>，对应的asset目录也会移动</li>
</ul>
</li>
<li>当然这些也可以自己手动操作</li>
<li>草稿会被解析到<code>model(&#39;Post&#39;)</code>中，字段published为0 （默认情况下不会传递给布局页面进行渲染）</li>
<li><code>_config.yml</code>中设置<code>render_drafts: true</code><ul>
<li>会传递给布局页面进行渲染</li>
<li>在generate或deploy时会自动将<code>_drafts/</code>下的文件解析生成到目标文件夹下 （但不会移动到<code>/source/_posts</code>下）</li>
</ul>
</li>
</ul>
<h3 id="header-9">assert （资源文件）</h3>
<ul>
<li>在<code>_config.yml</code>中配置<code>post_asset_folder: true</code><ul>
<li>在使用命令新建文章时，会自动在同一路径下创建一个同文件名的文件夹<br>可以将该文章的一些资源文件放在里面</li>
<li>例如：<br>使用<code>&gt; hexo new post test</code>，则在<code>/source/_posts</code>下，会创建文件<code>2016-01-01-test.md</code>和文件夹<code>2016-01-01-test/</code>，且改文件夹下的文件不会被<code>renderer</code>解析，<code>generate</code>或<code>deploy</code>时会直接copy到目标目录下<br>（这里有日期，是因为我在<code>_config.yml</code>中配置了<code>new_post_name: :year-:month-:day-:title.md</code>）</li>
<li>当然也可以自己创建</li>
</ul>
</li>
</ul>
<h3 id="header-10">Skip Render</h3>
<p>可在<code>_config.yml</code>文件中配置<code>skip_render</code>参数</p>
<pre><code class="nullyml"><span class="hljs-attr">skip_render:</span>
<span class="hljs-bullet">    -</span> <span class="hljs-string">test1/*.html</span>
<span class="hljs-bullet">    -</span> <span class="hljs-string">test2/*</span>
<span class="hljs-bullet">    -</span> <span class="hljs-string">test3/**</span>
</code></pre>
<ul>
<li><code>skip_render</code>使用<code>minimatch</code>，配置时可使用简易表达式</li>
<li>这里的<code>skip_render</code>是匹配基于<code>source_dir</code>下的文件的，一般为<code>/source</code><ul>
<li>注意是根目录下的source目录 （对于theme的source目录是无效的）</li>
<li>必须是<code>source_dir</code>下可被识别为<code>model(&#39;Page&#39;)</code>的文件，即非<code>_</code>开头、非<code>~</code>结尾、非<code>%</code>结尾的文件或文件夹下</li>
<li><code>skip_render</code>的文件虽然不会使用<code>renderer</code>渲染，但依旧会被<code>processor</code>解析入<code>model(&#39;Page&#39;)</code>中</li>
</ul>
</li>
</ul>
<h3 id="header-11">front-matter</h3>
<p>是文件最上方以 <code>---</code> 分隔的区域，用于指定文章的一些属性，内容格式遵循<code>yml</code>，例如：</p>
<pre><code class="nullmarkdown">title: Hello World
date: 2016-01-29 10:57:44
<span class="hljs-section">tags: [test,hexo]
---</span>
</code></pre>
<ul>
<li>这块内容由node module <code>hexo-front-matter</code>处理</li>
<li>除了使用Hexo预定义的一些属性，还可以随意添加自定义的</li>
<li>这些信息都会根据layout解析进入对应的<code>model</code>记录中</li>
<li>在布局页面中可通过Hexo变量<code>page.xxx</code>获取<br>（关于<code>model</code>和<code>Hexo变量</code>在后面章节中会介绍）</li>
</ul>
<h3 id="header-12">Read More</h3>
<p>在文章正文中使用<code>&lt;!-- more --&gt;</code>进行分割，则正文解析后，分割的前后段部分会分别设置到<code>excerpt</code>和<code>more</code>字段，<code>content</code>字段不变</p>
<h3 id="header-13">Data （数据文件）</h3>
<p>此功能会载入 <code>source/_data</code> 内的 YAML 或 JSON 文件到全局变量<code>site.data</code>中<br>例如：</p>
<p>在 <code>/source/_data</code> 文件夹中新建 <code>menu.yml</code> 文件：</p>
<pre><code class="nullyml"><span class="hljs-attr">Home:</span> <span class="hljs-string">/</span>
<span class="hljs-attr">Gallery:</span> <span class="hljs-string">/gallery/</span>
<span class="hljs-attr">Archives:</span> <span class="hljs-string">/archives/</span>
</code></pre>
<p>在模板中使用这些资料：</p>
<pre><code class="nullhtml"><span class="hljs-comment">{% for link in site.data.menu %}  
  {{ loop.key }}  
{% endfor %}</span>
</code></pre>
<h3 id="header-14">EJS</h3>
<p>布局文件可以使用普通多种模板文件，Hexo默认的使用的是<code>ejs</code></p>
<p>页面中使用：</p>
<pre><code class="nullhtml"><span class="hljs-comment">&lt;!-- js逻辑代码--&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%</span> <span class="hljs-attr">xxx</span> %&gt;</span>

<span class="hljs-comment">&lt;!-- 输出内容（转换成字符串）--&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%=xxx%</span>&gt;</span>

<span class="hljs-comment">&lt;!-- 页面中输出内容（原样输出）--&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%-</span> <span class="hljs-attr">xxx</span> %&gt;</span>
</code></pre>
<p>单独js中使用举例：</p>
<pre><code class="nulljavascript"><span class="hljs-keyword">var</span> ejs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'ejs'</span>);
<span class="hljs-keyword">var</span> target = fs.readFileSync(path, <span class="hljs-string">'utf8'</span>);
<span class="hljs-keyword">var</span> locals={<span class="hljs-attr">title</span>:test};
<span class="hljs-keyword">var</span> html = ejs.render(target, locals);    <span class="hljs-comment">// target为ejs模板文件，locals为传入参数</span>
</code></pre>
<p>gulp中使用举例：</p>
<pre><code class="nulljavascript"><span class="hljs-keyword">var</span> gulp = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp'</span>);
<span class="hljs-keyword">var</span> rename=<span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-rename'</span>);
<span class="hljs-keyword">var</span> ejs=<span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-ejs'</span>);

gulp.task(<span class="hljs-string">"ejs"</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
    gulp.src(<span class="hljs-string">"./templates/about.ejs"</span>)
        .pipe(ejs({<span class="hljs-attr">title</span>:<span class="hljs-string">"About"</span>,<span class="hljs-attr">menuLinks</span>:menuLinks}))
        .pipe(rename(<span class="hljs-string">"about.html"</span>))
        .pipe(gulp.dest(<span class="hljs-string">"../build"</span>));
})
</code></pre>
<h3 id="header-15">Theme</h3>
<p>Hexo的theme放置在<code>/themes</code>下，在<code>_config.yml</code>中配置<code>theme: xxx</code>，可下载自己喜欢的<a href="http://hexo.io/themes/" target="_blank" rel="noopener">theme</a>或自己编写theme</p>
<ul>
<li><p>theme目录结构：</p>
<pre><code>  └── themes/
      └── xxxx/
              └── layout
              └── scripts
              └── source
              └──_config.yml
</code></pre></li>
<li><p>下载：</p>
<pre><code class="nullvim">  &gt; <span class="hljs-keyword">cd</span> project/themes
  &gt; git clone xxxx
</code></pre>
</li>
<li>theme的相关配置可写在theme下的<code>_config.yml</code>文件中，在模板中可通过<code>theme.xxx</code>获取配置信息</li>
<li>若想针对此theme扩展hexo功能，可在theme的<code>scripts</code>文件夹下编写js代码</li>
<li>一些资源文件比如<code>css</code>，<code>js</code>可以放置在theme的<code>source</code>目录下，hexo会使用匹配的<code>hexo-renderer-xxx</code>解析生成</li>
<li>扩展举例：Hexo默认使用Styl编写CSS样式，这里扩展使用sass<ul>
<li>下载node module <code>hexo-renderer-sass</code>，使用命令<code>npm install hexo-renderer-sass --save</code> (注意不要使用<code>--save-dev</code>)</li>
<li>可配置项：<pre><code class="nullyml"><span class="hljs-attr">node_sass:</span>
<span class="hljs-attr">  outputStyle:</span> <span class="hljs-string">nested</span>
<span class="hljs-attr">  precision:</span> <span class="hljs-number">5</span>
<span class="hljs-attr">  sourceComments:</span> <span class="hljs-literal">false</span>
</code></pre>
</li>
<li>在theme的source目录下编写<code>.scss</code>文件</li>
</ul>
</li>
</ul>
<h3 id="header-16">Highlight</h3>
<p>hexo中的默认配置：</p>
<pre><code class="nullyml"><span class="hljs-attr">highlight:</span> <span class="hljs-string">{</span>
<span class="hljs-attr">    enable:</span> <span class="hljs-literal">true</span><span class="hljs-string">,</span>
<span class="hljs-attr">    auto_detect:</span> <span class="hljs-literal">true</span><span class="hljs-string">,</span> <span class="hljs-string">//</span> <span class="hljs-string">Maintain</span> <span class="hljs-string">consistent</span> <span class="hljs-string">with</span> <span class="hljs-string">previous</span> <span class="hljs-string">version.</span>
<span class="hljs-attr">    line_number:</span> <span class="hljs-literal">true</span><span class="hljs-string">,</span>
<span class="hljs-attr">    tab_replace:</span> <span class="hljs-string">''</span>
  <span class="hljs-string">}</span>
</code></pre>
<p><strong>注意：</strong><br>Hexo默认是开启highlight功能的，在<code>filter:before_post_render</code>时解析，若配置highlight的enable为false，则会设置<code>options.highlight=null</code>，覆盖其他的配置（<code>assign(...,options)</code>），所以即便在<code>hexo-renderer-marked</code>中设置highlight，实际上也是无用的。</p>
<p>在前端使用highlight渲染：</p>
<ul>
<li>关闭hexo的highlight功能，设置<code>enable: false</code></li>
<li>配置marked的<code>langPrefix: &quot;hljs &quot;</code></li>
<li>在需使用highlight的模板页面中：<pre><code class="nulljavascript">  &lt;% <span class="hljs-keyword">if</span>(page.layout==<span class="hljs-string">'post'</span>)&lt;!--￼<span class="hljs-number">1</span>--&gt;%&gt;
  ...
  &lt;%- js(<span class="hljs-string">'highlight/highlight.pack'</span>) %&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="undefined">
      hljs.initHighlightingOnLoad();
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
</li>
</ul>
<h3 id="header-17">Marked</h3>
<p>Hexo内置使用的是<code>hexo-renderer-marked</code>解析markdown文章（内部调用node module <code>marked</code>来解析）<br>可配置项举例：</p>
<pre><code class="nullyaml"><span class="hljs-attr">marked:</span>
<span class="hljs-attr">  gfm:</span> <span class="hljs-literal">true</span>
<span class="hljs-attr">  pedantic:</span> <span class="hljs-literal">false</span>
<span class="hljs-attr">  sanitize:</span> <span class="hljs-literal">false</span>
<span class="hljs-attr">  tables:</span> <span class="hljs-literal">true</span>
<span class="hljs-attr">  breaks:</span> <span class="hljs-literal">true</span>
<span class="hljs-attr">  smartLists:</span> <span class="hljs-literal">true</span>
<span class="hljs-attr">  smartypants:</span> <span class="hljs-literal">true</span>
  <span class="hljs-string">...</span>
</code></pre>
<h3 id="header-18">使用MathJax解析Latex</h3>
<p>在模板页面中配置：</p>
<pre><code class="nullhtml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/MathJax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/x-mathjax-config"</span>&gt;</span><span class="actionscript">
    MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ [<span class="hljs-string">'$'</span>,<span class="hljs-string">'$'</span>], [<span class="hljs-string">"\\("</span>,<span class="hljs-string">"\\)"</span>]  ],
            <span class="hljs-comment">/*
            processEscapes: true,
              //skipTags remove 'pre' entry
              skipTags: ['script', 'noscript', 'style', 'textarea','code']
            */</span>
        }
    });
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p>如果想给公式添加css class（比如都加上<code>has-jax</code>），可以增加如下配置：</p>
<pre><code class="nullhtml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/x-mathjax-config"</span>&gt;</span><span class="actionscript">
    MathJax.Hub.Queue(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">var</span> all = MathJax.Hub.getAllJax(), i;
      <span class="hljs-keyword">for</span> (i=<span class="hljs-number">0</span>; i &lt; all.length; i += <span class="hljs-number">1</span>) {
        all[i].SourceElement().parentNode.className += <span class="hljs-string">' has-jax'</span>;
      }
    });
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p>使用的Latex表达式可能会和<code>Nunjucks</code>有冲突，hexo解析时可能会报错<br>（例如：在Latex中使用了两个连续的<code>{</code>，且在其中使用了<code>\xxx\</code>）<br>报错在post render 中进行标签插件的渲染时（<code>node_modules/hexo/lib/hexo/post.js</code>的render函数中）：</p>
<pre><code class="nulljavascript"><span class="hljs-comment">//在触发onRenderEnd的tagFilter函数时报错</span>
<span class="hljs-keyword">return</span> ctx.render.render({
      <span class="hljs-attr">text</span>: data.content,
      <span class="hljs-attr">path</span>: source,
      <span class="hljs-attr">engine</span>: data.engine,
      <span class="hljs-attr">toString</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">onRenderEnd</span>: tagFilter
    }, options);
</code></pre>
<h3 id="header-19">Scripts</h3>
<p>若要自己扩展Hexo，可在<code>/scripts</code>或theme的<code>/scripts</code>目录下编写js</p>
<p>比如，扩展一个命令，新建一个js文件在<code>/scripts</code>文件夹下：</p>
<pre><code class="nulljavascript">hexo.extend.console.register(<span class="hljs-string">'test'</span>, <span class="hljs-string">'Test Cmd'</span>, {
    <span class="hljs-attr">usage</span>: <span class="hljs-string">'[name] [value]'</span>,
    <span class="hljs-attr">arguments</span>: [
      {<span class="hljs-attr">name</span>: <span class="hljs-string">'name'</span>, <span class="hljs-attr">desc</span>: <span class="hljs-string">'Setting name.'</span>},
      {<span class="hljs-attr">name</span>: <span class="hljs-string">'value'</span>, <span class="hljs-attr">desc</span>: <span class="hljs-string">'New value of a setting.'</span>}
    ]
  }, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">args</span>)</span>{
      <span class="hljs-built_in">console</span>.log(args);
      <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">this</span>.config);
});
</code></pre>
<p>执行命令：<code>hexo test run 123</code>，可看到执行结果</p>
<h3 id="header-20">Deploy</h3>
<ul>
<li>下载插件<code>npm install hexo-deployer-git --save</code></li>
<li><code>_config.yml</code>配置部署到github上（也可配置部署到其他地方）：<pre><code class="nullyaml"><span class="hljs-attr">  deploy:</span>
<span class="hljs-attr">    type:</span> <span class="hljs-string">git</span> 
<span class="hljs-attr">    repository:</span> <span class="hljs-attr">https://github.com/xxx/xxx.github.io</span>
<span class="hljs-attr">    branch:</span> <span class="hljs-string">master</span>
</code></pre>
</li>
<li>执行 <code>hexo deploy</code></li>
</ul>
<h3 id="header-21">Migrate （迁移）</h3>
<p>可参考<a href="https://hexo.io/zh-cn/docs/migration.html" target="_blank" rel="noopener">官方文档</a></p>
<ul>
<li>从Jekyll，Octopress，Middleman等静态博客迁移，只需按照文章的规则进行手动修改和copy</li>
<li>RSS，WordPress,Joomla等可以使用相关插件</li>
<li>注意：如果使用导出的文件路径或网站来进行博客迁移，必须保证迁移使用的源是完整的（例如使用RSS，则RSS中必须包含所有文章信息），否则导入会不全</li>
<li>评论等配件功能的迁移，注意修改相关配置，具体参考各功能配件</li>
</ul>
<h3 id="header-22">Config （配置说明）</h3>
<p>默认配置在<code>/node_modules/hexo/lib/hexo/default_config.js</code><br>在<code>/_config.yml</code>中的一些可配置项列举如下：</p>
<ol>
<li><p>Site</p>
<ul>
<li>title    : 网站的标题</li>
<li>subtitle : 网站的子标题 </li>
<li>description : 网站的描述</li>
<li>author : 你的名字</li>
<li>language : 网站的语言</li>
<li>timezone : 网站的时区，默认电脑的设置，可以在<a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones" target="_blank" rel="noopener">here</a>找到时区列表，例如America/New_York, Japan, and UTC.</li>
</ul>
</li>
<li><p>URL</p>
<ul>
<li>url : 网站的url  </li>
<li>root: 网站的根目录 </li>
<li>permalink: 文件保存在public中得目录格式,默认为    :year/:month/:day/:title/ </li>
<li>permalink_default: permalink每部分的默认值</li>
</ul>
</li>
<li><p>Directory</p>
<ul>
<li>source_dir:    内容存放的源码文件夹目录 （默认：source）</li>
<li>public_dir:    静态网页生成目录    （默认：public）</li>
<li>tag_dir:    标签目录    （默认：tags））</li>
<li>archive_dir:    存档目录    （默认：archives））</li>
<li>category_dir:    类别目录    （默认：categories））</li>
<li>code_dir:    引入的代码目录    （默认：download/code））</li>
<li>i18n_dir:    i18n目录（默认：    :lang）</li>
<li>skip_render:    跳过指定文件的渲染，您可使用 glob 来配置路径。（默认：[]）     </li>
</ul>
</li>
<li><p>Writing</p>
<ul>
<li>new_post_name    ：新提交所使用的格式化文件名（    :title.md）</li>
<li>default_layout：默认格局    （post）</li>
<li>titlecase    ：把标题转换成title case    （false）</li>
<li>external_link：    使用新标签打开一个连接（true）</li>
<li>filename_case    ：转换文件名1小写;2大写    （0）</li>
<li>render_drafts    ：显示草稿    （false）</li>
<li>post_asset_folder：    是否开启Assert文件夹    （false）</li>
<li>relative_link    ：是否创建一个文件夹关联根目录    （false）</li>
<li>future：显示特性提交?    （true）</li>
<li>highlight：代码块设置     </li>
</ul>
</li>
<li><p>Category&amp;Tag</p>
<ul>
<li>default_category：默认类别    （默认为：uncategorized）</li>
<li>category_map：分类别名     </li>
<li>tag_map:标签别名     </li>
</ul>
</li>
<li><p>Date/Time format (Hero使用Moment.js来处理数据)</p>
<ul>
<li>date_format    ：日期格式（MMMM D YYYY）</li>
<li>time_format    时间格式（H:mm:ss）</li>
</ul>
</li>
<li><p>Pagination</p>
<ul>
<li>per_page：    每页最大文章数，0隐藏页数    （10）</li>
<li>pagination：    Pagination目录    （page）</li>
</ul>
</li>
<li><p>Extensions</p>
<ul>
<li>theme    ：背景名，false隐藏背景</li>
<li>deploy：部署设置</li>
</ul>
</li>
</ol>
<p>一些配置中可使用变量：</p>
<ul>
<li><code>:year</code> ：4位的年，比如2015</li>
<li><code>:month</code>：2位的月，比如06</li>
<li><code>:i_month</code>：去掉前面0的月，比如9代表9月</li>
<li><code>:day</code> ：两位的天，比如05代表5号</li>
<li><code>:i_day</code>： 同理</li>
<li><code>:title</code> ：文件名</li>
<li><code>:id</code> ：文章ID</li>
<li><code>:category</code>： 类别；如果文章没有指定，那么就是default_category字段设置的那个。</li>
<li><code>:lang</code>：语言</li>
</ul>
<p>一些generator配置举例：</p>
<ul>
<li>hexo-generator-archive<pre><code class="nullyaml"><span class="hljs-attr">archive_generator:</span>
<span class="hljs-attr">  per_page:</span> <span class="hljs-number">10</span>
<span class="hljs-attr">  yearly:</span> <span class="hljs-literal">true</span>
<span class="hljs-attr">  monthly:</span> <span class="hljs-literal">false</span>
<span class="hljs-attr">  daily:</span> <span class="hljs-literal">false</span>
</code></pre>
</li>
<li>hexo-generator-tag<pre><code class="nullyaml"><span class="hljs-attr">tag_generator:</span>
<span class="hljs-attr">  per_page:</span> <span class="hljs-number">0</span>
</code></pre>
</li>
</ul>
<h2 id="header-23">3. 应用扩展</h2>
<h3 id="header-24">tagCloud</h3>
<p>Hexo的Helper功能已有内置的生成tagcloud的方法<code>tagcloud([tags], [options])</code>可直接调用，比如：</p>
<pre><code class="nulljavascript">&lt;%- tagcloud({<span class="hljs-attr">min_font</span>: <span class="hljs-number">12</span>, <span class="hljs-attr">max_font</span>: <span class="hljs-number">30</span>, <span class="hljs-attr">amount</span>: <span class="hljs-number">200</span>, <span class="hljs-attr">color</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">start_color</span>: <span class="hljs-string">'#ccc'</span>, <span class="hljs-attr">end_color</span>: <span class="hljs-string">'#111'</span>})%&gt;
</code></pre>
<h3 id="header-25">toc</h3>
<p>Hexo的Helper功能已有内置的toc的方法<code>toc(str, [options])</code>可直接调用，比如：</p>
<pre><code class="nulljavascript">&lt;%-toc(page.content, { <span class="hljs-string">"class"</span>: <span class="hljs-string">"nav"</span>, <span class="hljs-attr">list_number</span>: theme.toc.number })%&gt;
</code></pre>
<h3 id="header-26">feed</h3>
<ul>
<li>下载插件：<pre><code class="nullvim">&gt; npm install hexo-generator-feed --save
</code></pre>
</li>
<li><p><code>_config.yml</code>中配置：</p>
<pre><code class="nullyaml"><span class="hljs-attr">sitemap:</span>
<span class="hljs-attr">  path:</span> <span class="hljs-string">sitemap.xml</span>
</code></pre>
</li>
<li><p>模板文件中添加Link：</p>
<pre><code>&lt;a href="&lt;%- url_for(site.data.about.rss)%&gt;" target="_blank"&gt;
  &lt;span class="icon-rss"&gt;&lt;/span&gt;
&lt;/a&gt;
</code></pre></li>
<li>可以修改<code>hexo-generator-feed</code>下的模板文件<code>atom.ejs</code>或<code>rss2.ejs</code></li>
</ul>
<h3 id="header-27">sitemap</h3>
<ul>
<li>下载插件：<pre><code class="nullvim">&gt; npm install hexo-generator-sitemap --save
</code></pre>
</li>
<li>配置：<pre><code class="nullyaml"><span class="hljs-attr">feed:</span>
<span class="hljs-attr">type:</span> <span class="hljs-string">atom</span>
<span class="hljs-attr">path:</span> <span class="hljs-string">atom.xml</span>
<span class="hljs-comment">#limit: 20</span>
</code></pre>
</li>
<li>模板文件中添加Link：<pre><code>&lt;a href="&lt;%- url_for(site.data.about.rss)%&gt;" target="_blank"&gt;
  &lt;span class="icon-rss"&gt;&lt;/span&gt;
&lt;/a&gt;
</code></pre></li>
<li>可以修改<code>hexo-generator-sitemap</code>下的模板文件<code>sitemap.ejs</code></li>
</ul>
<h3 id="header-28">Comments</h3>
<h4 id="header-29">Disqus</h4>
<p><a href="https://disqus.com/" target="_blank" rel="noopener">官网</a> | <a href="http://segmentfault.com/a/119000000280767" target="_blank" rel="noopener">Disqus进阶使用</a></p>
<pre><code class="nullhtml">
// disqus默认将数据加载到id为'disqus_thread'的容器中，可配置disqus_container_id改变
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"disqus_thread"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">noscript</span>&gt;</span>Please enable JavaScript to view the <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://disqus.com/?ref_noscript"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"nofollow"</span>&gt;</span>comments powered by Disqus.<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">noscript</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="javascript">
    <span class="hljs-comment">/* * *配置变量：可被添加在embed.js脚本之前的任何地方* * */</span>
    <span class="hljs-comment">// Required - Replace example with your forum shortname （在Dsiqus上设置的论坛短名）</span>
    <span class="hljs-keyword">var</span> disqus_shortname = <span class="hljs-string">'example'</span>; 

    <span class="hljs-comment">//Recomand - a unique URL for each page where Disqus is present（文章网址）</span>
    <span class="hljs-keyword">var</span> disqus_url =<span class="hljs-string">'xxxx'</span> 

    <span class="hljs-comment">//Recomand - a unique identifier for each page where Disqus is present（可以配置为article.id）</span>
    <span class="hljs-keyword">var</span> disqus_identifier =<span class="hljs-string">'xxxx'</span>;

     <span class="hljs-comment">// a unique title for each page where Disqus is present（可配置为article.title ）</span>
    <span class="hljs-keyword">var</span> disqus_title = <span class="hljs-string">'xxx'</span>;

    <span class="hljs-comment">//可以在Settings &gt; advanced页面或者使用我们的（分类）API来创建新分类</span>
    <span class="hljs-keyword">var</span> disqus_category_id = <span class="hljs-string">'123456'</span>; 

    <span class="hljs-comment">/* * * DON'T EDIT BELOW THIS LINE * * */</span>
    (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> dsq = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'script'</span>); dsq.type = <span class="hljs-string">'text/javascript'</span>; dsq.async = <span class="hljs-literal">true</span>;
        dsq.src = <span class="hljs-string">'//'</span> + disqus_shortname + <span class="hljs-string">'.disqus.com/embed.js'</span>;
        (<span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">'head'</span>)[<span class="hljs-number">0</span>] || <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">'body'</span>)[<span class="hljs-number">0</span>]).appendChild(dsq);
    })();
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p><strong>评论计数</strong></p>
<pre><code class="nullhtml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"disqus-comment-count"</span> <span class="hljs-attr">data-disqus-url</span>=<span class="hljs-string">"http://example.com/path-to-thread/"</span>&gt;</span> <span class="hljs-comment">&lt;!-- Count will be inserted here --&gt;</span> <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
或
<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"disqus-comment-count"</span> <span class="hljs-attr">data-disqus-identifier</span>=<span class="hljs-string">"your_disqus_identifier"</span>&gt;</span> <span class="hljs-comment">&lt;!-- Count will be inserted here --&gt;</span> <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
</code></pre>
<h4 id="header-30">多说</h4>
<p><a href="http://duoshuo.com/" target="_blank" rel="noopener">官网</a> | <a href="http://dev.duoshuo.com/docs/512d6e2e418847315a000001" target="_blank" rel="noopener">API</a></p>
<pre><code class="nullhtml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="javascript">
    <span class="hljs-keyword">var</span> duoshuoQuery = {<span class="hljs-attr">short_name</span>:<span class="hljs-string">"xxx"</span>};
    (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{ 
    <span class="hljs-keyword">var</span> ds = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'script'</span>); 
    ds.type = <span class="hljs-string">'text/javascript'</span>;ds.async = <span class="hljs-literal">true</span>; 
    ds.src = (<span class="hljs-built_in">document</span>.location.protocol == <span class="hljs-string">'https:'</span> ? <span class="hljs-string">'https:'</span> : <span class="hljs-string">'http:'</span>) + <span class="hljs-string">'//static.duoshuo.com/embed.js'</span>; 
    ds.charset = <span class="hljs-string">'UTF-8'</span>;
    (<span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">'head'</span>)[<span class="hljs-number">0</span>] || <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">'body'</span>)[<span class="hljs-number">0</span>]).appendChild(ds); })(); 
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ds-thread"</span> 
    <span class="hljs-attr">data-thread-key</span>=<span class="hljs-string">"请将此处替换成文章在你的站点中的ID"</span> 
    <span class="hljs-attr">data-title</span>=<span class="hljs-string">"请替换成文章的标题"</span> 
    <span class="hljs-attr">data-url</span>=<span class="hljs-string">"请替换成文章的网址"</span>
    <span class="hljs-attr">data-limit</span>=<span class="hljs-string">"单页显示评论数，取值范围:1～200"</span> 
    <span class="hljs-attr">data-order</span>=<span class="hljs-string">"排序方式，取值：asc(从旧到新),desc(从新到旧)"</span>
    <span class="hljs-attr">...</span>
    &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p>使用示例：</p>
<pre><code class="nullhtml">var duoshuoQuery = {short_name:"xxx"};
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span> <span class="hljs-attr">async</span>=<span class="hljs-string">""</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"http://static.duoshuo.com/embed.js"</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"ds-thread"</span> 
    <span class="hljs-attr">data-thread-key</span>=<span class="hljs-string">"&lt;%= page.path %&gt;"</span> 
    <span class="hljs-attr">data-title</span>=<span class="hljs-string">"&lt;%= page.title %&gt;"</span> 
    <span class="hljs-attr">data-url</span>=<span class="hljs-string">"&lt;%= page.permalink %&gt;"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p><strong>文章评论数：</strong></p>
<pre><code class="nullhtml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ds-thread-count"</span> 
    <span class="hljs-attr">data-thread-key</span>=<span class="hljs-string">"文章在原站点中的id或其他唯一标识"</span> 
    <span class="hljs-attr">data-count-type</span>=<span class="hljs-string">"comments"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
</code></pre>
<p><strong>最新评论：</strong></p>
<pre><code class="nullhtml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ds-recent-comments"</span> 
    <span class="hljs-attr">data-num-items</span>=<span class="hljs-string">"5"</span> 
    <span class="hljs-attr">data-show-avatars</span>=<span class="hljs-string">"1"</span> 
    <span class="hljs-attr">data-show-time</span>=<span class="hljs-string">"1"</span> 
    <span class="hljs-attr">data-show-title</span>=<span class="hljs-string">"1"</span> 
    <span class="hljs-attr">data-show-admin</span>=<span class="hljs-string">"1"</span>
    <span class="hljs-attr">data-excerpt-length</span>=<span class="hljs-string">"70"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p><strong>热评文章</strong></p>
<pre><code class="nullhtml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ds-top-threads"</span> <span class="hljs-attr">data-range</span>=<span class="hljs-string">"daily"</span> <span class="hljs-attr">data-num-items</span>=<span class="hljs-string">"5"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<h3 id="header-31">Search</h3>
<p>站内搜索功能 （注意：尽量完善网站的sitemap）</p>
<h4 id="header-32">Swiftype</h4>
<p><a href="https://swiftype.com/" target="_blank" rel="noopener">官网</a> | <a href="http://opiece.me/2015/04/16/site-search-by-swiftype/" target="_blank" rel="noopener">使用swiftype实现站内搜索</a> | <a href="http://www.jerryfu.net/post/search-engine-for-hexo-with-swiftype.html" target="_blank" rel="noopener">利用swiftype为hexo添加站内搜索</a></p>
<p>注意：配置搜索方式和搜索框等内容（在官网上配置）</p>
<pre><code class="nullhtml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="javascript">
  (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">w,d,t,u,n,s,e</span>)</span>{w[<span class="hljs-string">'SwiftypeObject'</span>]=n;w[n]=w[n]||<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
  (w[n].q=w[n].q||[]).push(<span class="hljs-built_in">arguments</span>);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[<span class="hljs-number">0</span>];s.async=<span class="hljs-number">1</span>;s.src=u;e.parentNode.insertBefore(s,e);
  })(<span class="hljs-built_in">window</span>,<span class="hljs-built_in">document</span>,<span class="hljs-string">'script'</span>,<span class="hljs-string">'//s.swiftypecdn.com/install/v2/st.js'</span>,<span class="hljs-string">'_st'</span>);

  _st(<span class="hljs-string">'install'</span>,<span class="hljs-string">'xxxx'</span>,<span class="hljs-string">'2.0.0'</span>);  <span class="hljs-comment">//xxxx为userID</span>
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p>比如：<br>在官网上配置了使用searchfield的selector为<code>#hexoTest-search-field</code>，则在页面中可以这样写</p>
<pre><code class="nullhtml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"hexoTest-search-field"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span>&gt;</span>Search<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
</code></pre>
<h4 id="header-33">TinySou</h4>
<p><a href="http://tinysou.com/" target="_blank" rel="noopener">微搜索</a> (与Swiftype设置类似)</p>
<pre><code>&lt;script&gt;
    var customRenderActFunction = function(item) {
      var out = '&lt;p class="title"&gt;' + item['document']['title'].split(" // ")[0] + '&lt;/p&gt;';
      return out;
    };
    var option = {
      engineKey: 'xxxx',     // 设置自己的 tinysou_Key
      renderActFunction: customRenderActFunction
    };
    (function(w,d,t,u,n,s,e){
      s = d.createElement(t);
      s.src = u;
      s.async = 1;
      w[n] = function(r){
        w[n].opts = r;
      };
      e = d.getElementsByTagName(t)[0];
      e.parentNode.insertBefore(s, e);
    })(window,document,'script','//tinysou-cdn.b0.upaiyun.com/ts.js','_ts');
    _ts(option);
&lt;/script&gt;
</code></pre><pre><code>&lt;form&gt;
  &lt;input type="text" id="ts-search-input"&gt;
&lt;/form&gt;
</code></pre><h4 id="header-34">Google</h4>
<p><a href="https://cse.google.com/cse/create/new?hl=zh-CN" target="_blank" rel="noopener">官网</a> | <a href="http://lulee007.gitcafe.io/2016/01/23/Hexo%E5%8D%9A%E5%AE%A2%E4%BC%98%E5%8C%96%E9%85%8D%E7%BD%AE%E4%B9%8B-%E4%B8%BA%E8%87%AA%E5%B7%B1%E5%8D%9A%E5%AE%A2%E6%B7%BB%E5%8A%A0%E7%AB%99%E5%86%85%E6%90%9C%E7%B4%A2/" target="_blank" rel="noopener">Google 站内搜索博文</a></p>
<ul>
<li><p>在搜索引擎中配置自己的网站，上传sitemap</p>
</li>
<li><p>搜索功能嵌入自己网站中</p>
<ul>
<li>添加JS代码<pre><code>&lt;script&gt;
(function() {
  var cx = 'xxx';     // 生成的唯一id
  var gcse = document.createElement('script');
  gcse.type = 'text/javascript';
  gcse.async = true;
  gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
      '//cse.google.com/cse.js?cx=' + cx;
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(gcse, s);
})();
&lt;/script&gt;
</code></pre></li>
<li><p>页面中添加：</p>
<pre><code class="nullhtml"><span class="hljs-comment">&lt;!--搜索框-&gt;
&lt;gcse:searchbox-only&gt;&lt;/gcse:searchbox-only&gt;

&lt;!--搜索结果--&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">gcse:searchresults-only</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">gcse:searchresults-only</span>&gt;</span>
</code></pre>
</li>
<li><p>可自己添加Search样式，例如：</p>
<pre><code>.gsc-resultsHeader {
display: none !important;
}
.gsc-result .gs-title {
height: 1.5em !important;
}
.gsc-webResult .gsc-result {
padding: 0px 0 16px 0 !important;
}
.article-entry table {
margin: 0px 0 !important;
}
</code></pre></li>
</ul>
</li>
<li><p>不嵌入到网站中（link到搜索引擎页面进行搜索）</p>
<ul>
<li>Hexo的Helper已有此功能：<pre><code class="nullhtml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"search-form-wrap"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">%-</span> <span class="hljs-attr">search_form</span>() %&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
</li>
<li>或自己添加<pre><code class="nullhtml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">"//google.com/search"</span> <span class="hljs-attr">method</span>=<span class="hljs-string">"get"</span> <span class="hljs-attr">accept-charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"search"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"q"</span> <span class="hljs-attr">results</span>=<span class="hljs-string">"0"</span> &gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"hidden"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"sitesearch"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"xxx"</span>&gt;</span> 
  <span class="hljs-comment">&lt;!-- 这里value为自己site的url --&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
</code></pre>
</li>
</ul>
</li>
</ul>
<p><strong>PS：</strong><a href="http://zhanzhang.baidu.com/guide/index" target="_blank" rel="noopener">百度站内搜索</a>设置和此类似</p>
<h3 id="header-35">Share</h3>
<p>可以自己拼接分享URL来实现分享功能，这里介绍两种现有的分享功能</p>
<p><a href="http://share.baidu.com/code" target="_blank" rel="noopener">百度分享</a></p>
<pre><code class="nullhtml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"bdsharebuttonbox"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"#"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"bds_qzone"</span> <span class="hljs-attr">data-cmd</span>=<span class="hljs-string">"qzone"</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"分享到QQ空间"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"#"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"bds_tsina"</span> <span class="hljs-attr">data-cmd</span>=<span class="hljs-string">"tsina"</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"分享到新浪微博"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"#"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"bds_tqq"</span> <span class="hljs-attr">data-cmd</span>=<span class="hljs-string">"tqq"</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"分享到腾讯微博"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"#"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"bds_renren"</span> <span class="hljs-attr">data-cmd</span>=<span class="hljs-string">"renren"</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"分享到人人网"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"#"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"bds_weixin"</span> <span class="hljs-attr">data-cmd</span>=<span class="hljs-string">"weixin"</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"分享到微信"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"#"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"bds_fbook"</span> <span class="hljs-attr">data-cmd</span>=<span class="hljs-string">"fbook"</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"分享到Facebook"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"#"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"bds_twi"</span> <span class="hljs-attr">data-cmd</span>=<span class="hljs-string">"twi"</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"分享到Twitter"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"#"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"bds_more"</span> <span class="hljs-attr">data-cmd</span>=<span class="hljs-string">"more"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"#"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"bds_count"</span> <span class="hljs-attr">data-cmd</span>=<span class="hljs-string">"count"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-built_in">window</span>._bd_share_config={
    <span class="hljs-string">"common"</span>:{
        <span class="hljs-string">"bdSnsKey"</span>:{},
        <span class="hljs-string">"bdText"</span>:<span class="hljs-string">""</span>,
        <span class="hljs-string">"bdMini"</span>:<span class="hljs-string">"1"</span>,
        <span class="hljs-string">"bdMiniList"</span>:<span class="hljs-literal">false</span>,
        <span class="hljs-string">"bdPic"</span>:<span class="hljs-string">""</span>,
        <span class="hljs-string">"bdStyle"</span>:<span class="hljs-string">"0"</span>,
        <span class="hljs-string">"bdSize"</span>:<span class="hljs-string">"16"</span>
        },
<span class="hljs-string">"slide"</span>:{
    <span class="hljs-string">"type"</span>:<span class="hljs-string">"slide"</span>,
    <span class="hljs-string">"bdImg"</span>:<span class="hljs-string">"3"</span>,
    <span class="hljs-string">"bdPos"</span>:<span class="hljs-string">"left"</span>,
    <span class="hljs-string">"bdTop"</span>:<span class="hljs-string">"250"</span>
    }
};
<span class="hljs-keyword">with</span>(<span class="hljs-built_in">document</span>)<span class="hljs-number">0</span>[
(getElementsByTagName(<span class="hljs-string">'head'</span>)[<span class="hljs-number">0</span>]||body)
.appendChild(createElement(<span class="hljs-string">'script'</span>))
.src=<span class="hljs-string">'http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='</span>+~(-<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>()/<span class="hljs-number">36e5</span>)
];
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p><a href="http://dev.duoshuo.com/docs/4ff28d6f552860f21f00000c" target="_blank" rel="noopener">多说分享</a></p>
<pre><code class="nullhtml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ds-share-inline"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>  <span class="hljs-attr">class</span>=<span class="hljs-string">"ds-share-icons-16"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">data-toggle</span>=<span class="hljs-string">"ds-share-icons-more"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ds-more"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"javascript:void(0);"</span>&gt;</span>分享到：<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ds-weibo"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"javascript:void(0);"</span> <span class="hljs-attr">data-service</span>=<span class="hljs-string">"weibo"</span>&gt;</span>微博<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ds-qzone"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"javascript:void(0);"</span> <span class="hljs-attr">data-service</span>=<span class="hljs-string">"qzone"</span>&gt;</span>QQ空间<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ds-qqt"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"javascript:void(0);"</span> <span class="hljs-attr">data-service</span>=<span class="hljs-string">"qqt"</span>&gt;</span>腾讯微博<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ds-wechat"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"javascript:void(0);"</span> <span class="hljs-attr">data-service</span>=<span class="hljs-string">"wechat"</span>&gt;</span>微信<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ds-share-icons-more"</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="actionscript">
<span class="hljs-comment">//JS代码（同多说评论）</span>
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h3 id="header-36">Analytics</h3>
<p>Google Analytics <a href="https://www.google.com/analytics/" target="_blank" rel="noopener">官网</a> | <a href="https://support.google.com/analytics/answer/1008080?hl=zh-Hans" target="_blank" rel="noopener">Doc</a> | <a href="https://maskray.me/blog/2013-08-19-popular-posts-with-google-analytics-api" target="_blank" rel="noopener">博文</a></p>
<ul>
<li>在Google Analytics官网上注册，配置（网站域名），获取JS代码</li>
<li>将JS代码Copy到Hexo的模板文件中</li>
<li><p>一些Theme已集成了Google Analytics，比如 landscape （放置在<code>&lt;head&gt;</code>中）：</p>
<pre><code class="nullhtml">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="javascript">
      (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">i,s,o,g,r,a,m</span>)</span>{i[<span class="hljs-string">'GoogleAnalyticsObject'</span>]=r;i[r]=i[r]||<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
      (i[r].q=i[r].q||[]).push(<span class="hljs-built_in">arguments</span>)},i[r].l=<span class="hljs-number">1</span>*<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();a=s.createElement(o),
      m=s.getElementsByTagName(o)[<span class="hljs-number">0</span>];a.async=<span class="hljs-number">1</span>;a.src=g;m.parentNode.insertBefore(a,m)
      })(<span class="hljs-built_in">window</span>,<span class="hljs-built_in">document</span>,<span class="hljs-string">'script'</span>,<span class="hljs-string">'//www.google-analytics.com/analytics.js'</span>,<span class="hljs-string">'ga'</span>);

      ga(<span class="hljs-string">'create'</span>, <span class="hljs-string">'xxxx'</span>, <span class="hljs-string">'auto'</span>);  <span class="hljs-comment">// xxx为注册配置后生成的唯一id</span>
      ga(<span class="hljs-string">'send'</span>, <span class="hljs-string">'pageview'</span>);

  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
</li>
</ul>
<hr>
<h2 id="header-37">4. 源码概要</h2>
<p>可参考Hexo官方<a href="https://hexo.io/zh-cn/api/" target="_blank" rel="noopener">API</a></p>
<h3 id="header-38">4.1 基础目录</h3>
<pre><code class="nullvim">├── _config.yml
├── package.json
├── scaffolds/
├── scripts/
├── <span class="hljs-keyword">source</span>/
|   ├── _drafts
|   └── _posts
└── themes/
    └── landscape/
                └── layout
                └── scripts
                └── <span class="hljs-keyword">source</span>
                └──_config.yml
</code></pre>
<h3 id="header-39">4.2 Hexo Core</h3>
<p>主要在 <code>/node_modules/hexo/lib/hexo</code>下：<br>index.js 核心： (默认配置文件default_config.js)</p>
<pre><code class="nulljavascript">  <span class="hljs-keyword">return</span> loadDatabase(<span class="hljs-keyword">this</span>).then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Promise</span>.all([
      <span class="hljs-comment">//调用processor</span>
      self.source.process(),
      self.theme.process()
    ]);
  }).then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">return</span> self._generate({<span class="hljs-attr">cache</span>: <span class="hljs-literal">true</span>});
  }).nodeify(callback);
</code></pre>
<ul>
<li>=&gt; Load Database (build models)</li>
<li>=&gt; Processor ( insert models) </li>
<li>=&gt; Post Render (parse article main content )</li>
<li>=&gt; Generator (expand model datas)</li>
<li>=&gt; Theme Renderer (combine data and template to output)</li>
</ul>
<h3 id="header-40">4.3 Hexo model</h3>
<ol>
<li><p>Hexo中的 <code>database</code>,<code>model</code>类是由 node module <code>warehouse</code>  定义的（具体可参考warehouse的源码）</p>
<ul>
<li>在Hexo中创建database和注册models对象的代码如下 （index.js中）<pre><code class="nulljavascript"><span class="hljs-keyword">this</span>.database = <span class="hljs-keyword">new</span> Database({
  <span class="hljs-attr">version</span>: dbVersion,
  <span class="hljs-attr">path</span>: pathFn.join(base, <span class="hljs-string">'db.json'</span>)
});
registerModels(<span class="hljs-keyword">this</span>);
</code></pre>
</li>
<li>在<code>filter:before_exit</code>时save database对象到<code>file:/db.json</code></li>
<li>可在<code>/db.json</code>中查看解析的models对象，也可自行扩展导入到其他DB中</li>
<li><strong>注意：</strong>model的Schema中定义为CacheString类型的字段不会<code>save</code>到<code>/db.json</code></li>
</ul>
</li>
<li><p>Hexo的主要model为（定义在<code>／node_modules/hexo/lib/models</code>下）：</p>
<ul>
<li><code>Page</code><ul>
<li>Schema包含：title,date,updated,comments,layout,_content,source,path,raw,content,excerpt</li>
<li>virtual path （即Reference）: permalink,full_source</li>
<li>Schema中的content,excerpt,more字段为CacheString类型</li>
</ul>
</li>
<li><code>Post</code><ul>
<li>Schema包含page中所有properties，再加slug,photos,link,published</li>
<li>virtual path包含page中所有，再加 path,asset_dir,tags,categories</li>
</ul>
</li>
<li><code>Tag</code><ul>
<li>Schema包含：name</li>
<li>virtual path: slug,path,permalink,posts,link,</li>
</ul>
</li>
<li><code>Category</code><ul>
<li>Schema包含：name,parent</li>
<li>virtual path: slug,path,permalink,posts,length</li>
</ul>
</li>
<li><code>Data</code><ul>
<li>Schema包含：_id,data</li>
</ul>
</li>
<li><code>Assert</code><ul>
<li>Schema包含：_id,path,modified</li>
</ul>
</li>
</ul>
</li>
<li><p>这些models会被设置到<code>／node_modules/hexo/lib/hexo/locals.js</code>中定义的<code>Locals</code>对象中</p>
<ul>
<li><code>locals.set</code>: <code>posts</code>,<code>pages</code>,<code>categories</code>,<code>tags</code>,<code>data</code> (会对model进行处理后再设置到locals，具体参看index.js下的_bindLocals方法)<ul>
<li>例如：若<code>_config.yml</code>设置了<code>render_drafts: true</code>，则通过locals获取<code>posts</code>时会自动过滤掉草稿，即<code>published</code>字段为<code>true</code>的记录</li>
</ul>
</li>
<li><p>在布局页面渲染时会将<code>Locals</code>传入，这样就可在布局页面中使用这些变量</p>
<ul>
<li><p>例如：后面介绍的Hexo Variables中的全局对象<code>site</code>，是通过如下代码设置的</p>
<pre><code class="nulljavascript"><span class="hljs-comment">//after do filter:before_generate</span>
self.locals.invalidate();
siteLocals = self.locals.toObject();
Locals.prototype.site = siteLocals;
<span class="hljs-comment">//Run Generators （每个generator.call(self,siteLocals) ）</span>
...
</code></pre>
</li>
<li>Locals.prototype.toObject 返回 {key,item} (item是存放在locals的对象)</li>
<li>还有其他Hexo Variables也是在｀index.js｀中设置到Locals</li>
</ul>
</li>
</ul>
</li>
</ol>
<h3 id="header-41">4.4 Hexo Processor</h3>
<ol>
<li><p><code>self.source.process()</code>  解析File（/source下的文件），更新对应Model：<br>（调用<code>/node_modules/hexo/lib/plugins/processor</code>下regist的processor）</p>
<ul>
<li>asset.js：<ul>
<li>处理非临时(<code>%</code>,<code>~</code>结尾)和隐藏(<code>_</code>开头)文件</li>
<li>解析<code>front-matter</code>更新<code>model(&#39;Page&#39;)</code>中对应记录的属性（若为不可渲染文件，则更新<code>model(&#39;Asset&#39;)</code>）</li>
<li>若无对应记录，则插入一条新记录</li>
</ul>
</li>
<li>post.js：<ul>
<li>处理<code>_posts/</code>,<code>_drafts/</code>下的非临时和隐藏文件</li>
<li>解析基本同上，只是操作的是<code>model(&#39;Post&#39;)</code>中的记录</li>
</ul>
</li>
<li>data.js： <ul>
<li>处理<code>_data/</code>下文件</li>
<li>render后更新<code>model(&#39;Data&#39;)</code>中的记录</li>
</ul>
</li>
</ul>
</li>
<li><p><code>self.theme.process()</code>  解析File（／themes/[themeName]下文件），更新相关配置：<br>（调用<code>/node_modules/hexo/lib/theme/processors</code>下的processor）</p>
<ul>
<li>config.js：<ul>
<li>处理<code>_config.xxx</code>文件</li>
<li>render后更新box.config</li>
</ul>
</li>
<li>i18n.js：<ul>
<li>处理<code>languages/</code>下文件</li>
<li>render后更新box.i18n</li>
</ul>
</li>
<li>source.js：<ul>
<li>处理<code>source/</code>下文件</li>
<li>更新<code>model(&#39;Assert&#39;)</code>中对应记录的属性</li>
</ul>
</li>
<li>view.js：<ul>
<li>处理<code>layout/</code>下文件</li>
<li>更新box.view</li>
</ul>
</li>
</ul>
</li>
<li><p>source和theme对象是通过<code>Box</code>调用执行对应的processor （具体可参看<code>/node_modules/hexo/lib/box</code>）</p>
<ul>
<li>event:<code>processBefore</code></li>
<li><code>processor.pattern.match(path)</code> 判断是否可处理</li>
<li>可处理则调用<code>processor.process</code>方法</li>
<li>event:<code>processAfter</code></li>
</ul>
</li>
</ol>
<p><strong>PS:</strong></p>
<ul>
<li><code>/source/_post</code>,<code>/source/_draft</code> <ul>
<li>isRenderable:true =&gt;  <code>model(&#39;Post&#39;)</code>,<code>model(&#39;Category&#39;)</code>,<code>model(&#39;Tag&#39;)</code>,<code>model(&#39;PostTag&#39;)</code>,<code>model(&#39;PostCategory&#39;)</code></li>
<li><code>asset_dir/</code> =&gt; <code>model(&#39;PostAssert&#39;)</code></li>
</ul>
</li>
<li><code>/source/_data</code> =&gt; do Render =&gt; <code>model(&#39;Data&#39;)</code></li>
<li><code>/source</code>下非<code>_</code>开头、非<code>%</code>、非<code>~</code>结尾的文件或文件夹<ul>
<li>isRenderable:true =&gt; <code>model(&#39;Page&#39;)</code></li>
<li>isRenderable:false =&gt; <code>model(&#39;Assert&#39;)</code></li>
</ul>
</li>
<li><code>/themes/[themeName]/source</code>下非<code>_</code>开头、非<code>%</code>、非<code>~</code>结尾的文件或文件夹  =&gt; <code>model(&#39;Assert&#39;)</code></li>
</ul>
<h3 id="header-42">4.5 Hexo Generator</h3>
<p><strong>1. 过程：</strong></p>
<ul>
<li>filter: <code>before_generate</code> (event: generateBefore)<ul>
<li><strong>render_post</strong>,call <code>/node_modules/hexo/lib/hexo/post.js</code>  (处理<code>model(&#39;Post&#39;)</code> , <code>model(&#39;page&#39;)</code> )</li>
</ul>
</li>
<li>Run <strong>Generators</strong> <ul>
<li>每个Generator返回一个key-value或数组对象</li>
<li>都要包含path和data字段，可包含其他自定义扩展字段</li>
<li>即<code>{path:xxx,data:xxx,...}</code>或<code>[{path:xxx,data:xxx,...},...]</code></li>
</ul>
</li>
<li>Add Routes<ul>
<li>filter: <code>template_locals</code> (i18n)</li>
<li><strong>Theme Render</strong> (合并render布局文件和上面Generator返回的数据 )</li>
</ul>
</li>
<li>filter: <code>after_generate</code> (event: generateAfter)</li>
</ul>
<p><strong>2. hexo本身regist generator plugin:</strong> （会更新对应model的记录）</p>
<ul>
<li>asset.js:  处理<code>model(&#39;Assert&#39;)</code>和<code>model(&#39;PostAsset&#39;)</code>的记录</li>
<li>page:js:  处理<code>model(&#39;Page&#39;)</code>的记录</li>
<li>post.js:  处理<code>model(&#39;Post&#39;)</code>的记录</li>
</ul>
<p><strong>3. hexo通过package.json加入的generator plugin：</strong></p>
<ul>
<li>hexo-generator-index</li>
<li>hexo-generator-archive</li>
<li>hexo-generator-tag</li>
<li>hexo-generator-category</li>
</ul>
<p><strong>PS：</strong>对于这些plugin，可在_config.yml中通过xxx_generator配置一些参数<br>【具体参看对应generator plugin的源码】</p>
<h3 id="header-43">4.6 Hexo Renderer</h3>
<p><strong>1.处理：</strong></p>
<ul>
<li><strong>render post</strong> 调用匹配的render解析文章 (<code>/node_modules/hexo/lib/hexo/post.js</code>)<ul>
<li>filter: <code>before_post_render</code><ul>
<li>backtick_code_block</li>
<li>titlecase</li>
</ul>
</li>
<li>Skip rendering swig file</li>
<li>Render (!isSwig)<ul>
<li>get matched renderer</li>
<li><strong>call rendererer （更新对应model记录的content字段）</strong></li>
<li>onRenderEnd (tag render)</li>
<li>filter: <code>after_render:xxx</code></li>
</ul>
</li>
<li>isSwig -&gt; tag.render</li>
<li>filter: <code>after_post_render</code><ul>
<li>excerpt （处理 <code>&lt;!-- more --&gt;</code>,填充model的excerpt和more属性内容）</li>
<li>external_link</li>
</ul>
</li>
</ul>
</li>
<li><strong>theme view render</strong> 布局文件和Generator返回的数据合并渲染出最终文件 (<code>/node_modules/hexo/lib/hexo/theme/index.js</code>)</li>
</ul>
<p><strong>2.hexo本身renderer处理:</strong></p>
<ul>
<li><code>htm,html</code> to <code>html</code> [ use plain.js]</li>
<li><code>css</code> to <code>css</code> [ use plain.js ]</li>
<li><code>js</code> to <code>js</code> [ use plain.js ]</li>
<li><code>json</code> to <code>json</code> [ use json.js ]</li>
<li><code>swig</code> to <code>html</code> [ use swig.js ]</li>
<li><code>yml,yaml</code> to <code>json</code> [ use yaml.js ]</li>
</ul>
<p><strong>3.hexo通过package.json加入的renderer:</strong></p>
<ul>
<li>hexo-renderer-ejs: <code>ejs</code> to <code>html</code></li>
<li>hexo-renderer-marked: <code>md,markdown,mkd,mkdn,mdwn,mdtxt,mdtext</code> to <code>html</code></li>
<li>hexo-renderer-stylus: <code>styl,stylus</code> to <code>css</code></li>
</ul>
<h3 id="header-44">4.7 Hexo Theme</h3>
<p><strong>1. 目录结构</strong></p>
<p><code>/themes/[themeName]/</code>下：</p>
<ul>
<li><code>/layout</code> :<ul>
<li>用于存放模版文件(eg: ejs,jade,swig等)</li>
<li>一般有 layout,page,post,tag,category,archive布局文件</li>
<li>可在布局文件中调用hexo的全局变量<ul>
<li>site（site.pages,site.posts,site.categories,site.tags,site.data.xxx）</li>
<li>page ( page.title,page.date,page.layout,page.content,page.tags,…)</li>
<li>config (/_config.yml中定义的)</li>
<li>theme （theme下_config.yml中定义的）</li>
<li>path,url,env</li>
<li>_ lodash函数</li>
</ul>
</li>
</ul>
</li>
<li><code>/scripts</code> :<ul>
<li>用于存放扩展hexo的js代码</li>
<li>可直接使用hexo.xxx调用hexo的功能</li>
</ul>
</li>
<li><code>/source</code> :<ul>
<li>用于存放资源文件（eg：css，js）</li>
<li>hexo会根据文件后缀调用register的renderer处理</li>
<li>执行generate或deploy会全部生成到目标目录下</li>
</ul>
</li>
</ul>
<p><strong>2. Config (注意优先级)</strong></p>
<pre><code>Locals.prototype.theme = _.extend({}, config, theme.config, config.theme_config);
</code></pre><p>修改theme：将<code>_config.yml</code>中theme字段值设为主题名即可</p>
<p><strong>3. Layout</strong></p>
<ul>
<li>每个模板都默认使用<code>layout</code>布局</li>
<li>可在文章的前置申明中指定其他布局</li>
<li>若不需要<code>layout</code>布局，则在文章的<code>front-matter</code>部分设置<code>layout:false</code></li>
</ul>
<p><strong>配置source下文章的<code>front-matter</code>部分：</strong></p>
<ol>
<li>不设置<code>layout</code> =&gt; 使用theme layout下的布局<ul>
<li>文章直接在source目录下 =&gt; 使用 page 布局</li>
<li>文章在source目录下的某folder下 =&gt; 使用同folder名的布局</li>
</ul>
</li>
<li><code>layout: xxx</code> =&gt; 使用theme layout下xxx布局</li>
<li><code>layout: false</code> =&gt; 不使用theme，直接为post render的结果</li>
<li>只要<code>layout</code>未设置为false，theme layout下有layout模板都会和其他布局结合使用</li>
</ol>
<p><strong>4. 举例：某theme的layout目录下</strong></p>
<pre><code class="nullhtml"><span class="hljs-comment">&lt;!-- layout.ejs --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">%-</span> <span class="hljs-attr">body</span> %&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>

<span class="hljs-comment">&lt;!-- index.ejs --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Welcome!<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>

<span class="hljs-comment">&lt;!-- page.ejs --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">%=page.title%</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">%-page.content%</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

<span class="hljs-comment">&lt;!-- post.ejs --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">%=page.title%</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%-</span> <span class="hljs-attr">list_tags</span>(<span class="hljs-attr">page.tags</span>)%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">%-page.content%</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

<span class="hljs-comment">&lt;!-- about.ejs --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>About<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">%-page.content%</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

...
</code></pre>
<table class="table">
<thead>
<tr>
<th>文章</th>
<th><code>front-matter</code>中布局设置</th>
<th>theme下布局</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/source/about.md</code></td>
<td>不设置<code>layout</code></td>
<td><code>page.ejs+layout.ejs</code></td>
</tr>
<tr>
<td><code>/source/about.md</code></td>
<td><code>layout: false</code></td>
<td>不使用布局，直接render的结果</td>
</tr>
<tr>
<td><code>/source/about.md</code></td>
<td><code>layout: about</code></td>
<td><code>about.ejs+layout.ejs</code></td>
</tr>
<tr>
<td><code>/source/about/about.md</code></td>
<td>不设置<code>layout</code></td>
<td><code>about.ejs+layout.ejs</code></td>
</tr>
<tr>
<td><code>/source/about/about.md</code></td>
<td><code>layout: false</code></td>
<td>不使用布局，直接render的结果</td>
</tr>
<tr>
<td><code>/source/about/about.md</code></td>
<td><code>layout: page</code></td>
<td><code>page.ejs+layout.ejs</code></td>
</tr>
</tbody>
</table>
<h2 id="header-45">5. Hexo Variables</h2>
<p>以下这些变量，来自｀Locals｀，在theme的布局文件render时传递进去（具体可参考<code>/node_modules/hexo/lib/theme/view.js</code>）</p>
<pre><code class="nulljavascript">layoutView.render(layoutLocals, callback);
</code></pre>
<h3 id="header-46">5.1. config 配置变量</h3>
<ul>
<li>/_config.yml    =&gt; <code>config.xxx</code> 网站配置</li>
<li>/themes/[themeName]/_config.yml     =&gt; <code>theme.xxx</code> 主题配置，继承自网站配置</li>
</ul>
<h3 id="header-47">5.2 site 网站变量</h3>
<ul>
<li>/source/_data/xxx.yml =&gt; <code>site.data.xxx</code> <ul>
<li>存放的是通过遍历 <code>db.model(&#39;Data&#39;)</code>生成的<code>Key-value</code>对象（即{}对象）</li>
</ul>
</li>
<li><code>site.pages</code><ul>
<li>包含source下非<code>_posts</code>,<code>_drafts</code>,<code>_data</code></li>
<li>存放的是 <code>db.model(&#39;Page&#39;).find(query)</code>返回的<code>Query</code>对象</li>
</ul>
</li>
<li><code>site.posts</code><ul>
<li>包含source下<code>_posts</code>,<code>_drafts</code></li>
<li>存放的是 <code>db.model(&#39;Post&#39;).find(query)</code>返回的<code>Query</code>对象</li>
</ul>
</li>
<li><code>site.tags</code><ul>
<li>存放的是 <code>db.model(&#39;Tag&#39;)</code> 返回的<code>Model</code>对象</li>
<li>Schema字段：name</li>
<li>virtual字段：slug，path，permalink，posts，length</li>
</ul>
</li>
<li><code>site.categories</code><ul>
<li>存放的是 <code>db.model(&#39;Categories&#39;)</code> 返回的<code>Model</code>对象</li>
<li>Schema字段：name，parent</li>
<li>virtual字段：slug，path，permalink，posts，length</li>
</ul>
</li>
</ul>
<h3 id="header-48">5.3 page 页面变量</h3>
<p>针对该页面的内容以及 <code>front-matter</code> 所设定的变量</p>
<ul>
<li>一般包含：<ul>
<li><code>page.title</code> 文章标题</li>
<li><code>page.date</code> 文章建立日期</li>
<li><code>page.updated</code> 文章更新日期</li>
<li><code>page.comments</code> 留言是否开启</li>
<li><code>page.layout</code> 布局名称</li>
<li><code>page.source</code> 文章在项目source/下的路径+文件名</li>
<li><code>page.slug</code> </li>
<li><code>page.path</code> 文章网址（不含根路径），通常在主题中使用url_for(page.path)</li>
<li><code>page.raw</code> 文章原始所有内容</li>
<li><code>page._content</code> 文章正文原始内容</li>
<li><code>page.content</code> 文章正文解析后的内容</li>
<li><code>page.excerpt</code> 文章摘要 (正文<code>&lt;!-- more --&gt;</code>前面的解析内容)</li>
<li><code>page.more</code> 除了摘要的其他内容 (正文<code>&lt;!-- more --&gt;</code>后面的解析内容)</li>
<li>引用类型：<ul>
<li><code>page.permalink</code> 文章永久网址</li>
<li><code>page.full_source</code> 文章完整原始路径</li>
</ul>
</li>
<li>其他定义在<code>front-matter</code>中的字段信息</li>
</ul>
</li>
<li>post页面，新增：<ul>
<li><code>page.published</code> 文章非草稿为true</li>
<li>引用类型：<ul>
<li><code>page.path</code></li>
<li><code>page.asset_dir</code></li>
<li><code>page.tags</code></li>
<li><code>page.categories</code></li>
</ul>
</li>
</ul>
</li>
<li>若使用了Pagination (参考node module： <code>hexo-pagination</code>)，增加：<ul>
<li><code>page.per_page</code> 每一页显示的文章数</li>
<li><code>page.total</code> 文章数量</li>
<li><code>page.current</code> 当前页码</li>
<li><code>page.current_url</code> 当前页的URL</li>
<li><code>page.prev</code> 前一页页码，如果为第一页，该值为0</li>
<li><code>page.next</code> 后一页页码，如果为最后一页，则为0</li>
<li><code>page.prev_link</code> 前一页URL，如果为第一页，则为<code>&#39;&#39;</code></li>
<li><code>page.next_link</code> 后一页URL，如果为最后一页，则为<code>&#39;&#39;</code></li>
<li><code>page.posts</code> 当前页的文章</li>
</ul>
</li>
<li>若使用了Archive （<code>hexo-generator-archive</code>），增加：<ul>
<li><code>page.archive</code> 为true</li>
<li><code>page.year</code> 归档年份（4位）</li>
<li><code>page.month</code> 归档月份（1~12）</li>
<li><code>page.day</code> 归档日（1~31）</li>
</ul>
</li>
<li>若使用了Category （<code>hexo-generator-category</code>），增加：<ul>
<li><code>page.category</code> 分类名称</li>
</ul>
</li>
<li>若使用了Index （<code>hexo-generator-index</code>），增加：<ul>
<li><code>page.__index</code> 为true</li>
</ul>
</li>
</ul>
<h3 id="header-49">5.4 其他</h3>
<ul>
<li><code>path</code> 当前页面的路径（不含根路径）</li>
<li><code>url</code> 当前页面的完整网址</li>
<li><code>env</code> 环境变量</li>
<li><code>_</code> Lodash 函数库</li>
</ul>
<h2 id="header-50">6. Hexo Helper</h2>
<p>源码在<code>/node_modules/hexo/lib/plugins/helper</code>下，可在theme的布局文件中直接使用</p>
<h3 id="header-51">6.1 URL</h3>
<ul>
<li><code>url_for</code> 返回一个带root路径的url，eg：<code>&lt;%= url_for(path) %&gt;</code></li>
<li><code>relative_url</code> 返回from相对的to路径，eg：<code>&lt;%- relative_url(from, to) %&gt;</code></li>
<li><code>gravatar</code> 插入Gravatar图片，eg：<code>&lt;%- gravatar(email, [size])%&gt;</code></li>
</ul>
<h3 id="header-52">6.2 HTML</h3>
<ul>
<li><p><code>partial(name, locals, options)</code> 引入局部模版文件,例如：</p>
<pre><code class="nullhtml">  <span class="hljs-comment">&lt;!--partial/header.ejs--&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"logo"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">%=</span> <span class="hljs-attr">config.title</span> %&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>

  <span class="hljs-comment">&lt;!--index.ejs--&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">%-</span> <span class="hljs-attr">partial</span>('<span class="hljs-attr">partial</span>/<span class="hljs-attr">header</span>') %&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"content"</span>&gt;</span>Home page<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

  <span class="hljs-comment">&lt;!-- 生成后: --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"logo"</span>&gt;</span>My Site<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"content"</span>&gt;</span>Home page<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
</li>
<li><p><code>css(path,...)</code>,<code>js(path,...)</code></p>
<ul>
<li><p>path开头不是/或任何协议，则会自动加上根路径；没有扩展名则会自动加上</p>
<pre><code class="nullhtml"><span class="hljs-tag">&lt;<span class="hljs-name">%-</span> <span class="hljs-attr">css</span>('<span class="hljs-attr">style.css</span>') %&gt;</span>
// <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/style.css"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/css"</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">%-</span> <span class="hljs-attr">css</span>(['<span class="hljs-attr">style.css</span>', '<span class="hljs-attr">screen.css</span>']) %&gt;</span>
// <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/style.css"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/css"</span>&gt;</span>
// <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/screen.css"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/css"</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">%-</span> <span class="hljs-attr">js</span>('<span class="hljs-attr">script.js</span>') %&gt;</span> 
// <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/script.js"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span> 
<span class="hljs-tag">&lt;<span class="hljs-name">%-</span> <span class="hljs-attr">js</span>(['<span class="hljs-attr">script.js</span>', '<span class="hljs-attr">gallery.js</span>']) %&gt;</span> 
// <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/script.js"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span> 
// <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/gallery.js"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
</li>
</ul>
</li>
<li><p><code>link_to(path,[text],[options])</code>,<code>mail_to(path,[text],[options])</code></p>
<pre><code class="nullhtml">  <span class="hljs-tag">&lt;<span class="hljs-name">%-</span> <span class="hljs-attr">link_to</span>(‘<span class="hljs-attr">http:</span>//<span class="hljs-attr">www.google.com</span>‘, ‘<span class="hljs-attr">Google</span>’, {<span class="hljs-attr">external:</span> <span class="hljs-attr">true</span>, <span class="hljs-attr">class:</span> “<span class="hljs-attr">link</span>”}) %&gt;</span>
  // Google

  <span class="hljs-tag">&lt;<span class="hljs-name">%-</span> <span class="hljs-attr">mail_to</span>(‘<span class="hljs-attr">a</span>@<span class="hljs-attr">abc.com</span>’, ‘<span class="hljs-attr">Email</span>’) %&gt;</span>
  // Email
</code></pre>
</li>
<li><p><code>image_tag(path,[options])</code>,<code>favicon_tag(path)</code>,<code>feed_tag(path,[options])</code></p>
</li>
</ul>
<h3 id="header-53">6.3.Condition</h3>
<p>参考 <code>is.js</code></p>
<ul>
<li><code>is_current()</code></li>
<li><code>is_post()</code></li>
<li><code>is_page()</code></li>
<li><code>is_archive()</code></li>
<li><code>is_year()</code></li>
<li>…</li>
</ul>
<h3 id="header-54">6.4 String &amp; Date &amp; Number</h3>
<ul>
<li>String: <ul>
<li><code>trim</code>,<code>strip_html</code>,<code>titlecase</code></li>
<li><code>word_wrap</code> 分割字符串，使每行长度不超过 <code>length</code></li>
<li><code>truncate(text, length)</code> 移除超过 <code>length</code> 长度的字符串</li>
</ul>
</li>
<li>Date: <ul>
<li><code>date(date,[format])</code>,<code>date_xml(date)</code>,<code>time(date,[format])</code>,<code>full_date(date,[format])</code></li>
<li><code>date</code> 可以是 UNIX 时间、ISO 字符串、Date 对象或 [Moment.js] 对象。</li>
</ul>
</li>
<li>Number<ul>
<li><code>number_format(number,[options])</code></li>
<li><code>options</code>:<ul>
<li>precision 数字精度 (false 或非负整数，默认为<code>false</code>)</li>
<li>delimiter 千位数分隔符号 (默认为<code>,</code>)</li>
<li>separator 整数和小数之间的分隔符号 (默认为<code>.</code>)</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code class="nullhtml">&lt;!-- String --&gt;
&lt;%- strip_html('It's not &lt;b&gt;important&lt;/b&gt; anymore!') %&gt; 
// It's not important anymore!

&lt;%- titlecase('this is an apple') %&gt; 
// This is an Apple

&lt;%- word_wrap('Once upon a time', 8) %&gt; 
// Once upon\n a time

&lt;%- truncate('Once upon a time in a world far far away', 16) %&gt; 
// Once upon a time

&lt;!-- Date --&gt;
&lt;%- date(Date.now()) %&gt; 
// Jan 1, 2015 
&lt;%- date(Date.now(), 'YYYY/M/D') %&gt; 
// 2015/1/1

&lt;%- date_xml(Date.now()) %&gt; 
// 2015-01-01T00:00:00.000Z

&lt;%- time(Date.now()) %&gt; 
// 13:05:12 
&lt;%- time(Date.now(), 'h:mm:ss a') %&gt; 
// 1:05:12 pm

&lt;%- full_date(new Date()) %&gt; 
// Jan 1, 2013 0:00:00 

&lt;%- full_date(new Date(), 'dddd, MMMM Do YYYY, h:mm:ss a') %&gt; 
// Tuesday, January 1st 2013, 12:00:00 am
</code></pre>
<h3 id="header-55">6.5 Parse</h3>
<ul>
<li><p>markdown</p>
<ul>
<li><p>使用node module <code>markdown</code> 解析字符串</p>
<pre><code class="nullhtml"><span class="hljs-tag">&lt;<span class="hljs-name">%-</span> <span class="hljs-attr">markdown</span>('<span class="hljs-attr">make</span> <span class="hljs-attr">me</span> **<span class="hljs-attr">strong</span>**') %&gt;</span> 
// make me <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>strong<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span>
</code></pre>
</li>
</ul>
</li>
<li>render<ul>
<li>使用hexo注册的renderer解析字符串</li>
<li><code>render(str, engine, [options])</code></li>
</ul>
</li>
</ul>
<h3 id="header-56">6.6 List</h3>
<ul>
<li><code>list_categories([categories],[options])</code>,<code>list_tags([tags],[options])</code><ul>
<li><code>options</code>相同配置：<ul>
<li>orderby ：默认按name</li>
<li>order ：1, asc 升序；-1, desc 降序，默认为1</li>
<li>show_count ：显示每个标签的文章总数 ，默认true</li>
<li>style ：显示方式。默认为list（无序列表li）</li>
<li>separator： 分隔符号。只有在 style 不是 list 时有用</li>
<li>class ：默认为category或tag</li>
<li>transform ：修正title显示的函数</li>
</ul>
</li>
<li>list_categories 特有的<code>options</code>：<ul>
<li>depth：显示的分类层级 （0 显示所有层级的分类；-1 显示不分层级；1 只显示第一层的分类）</li>
</ul>
</li>
<li>list_tags 特有的<code>options</code>:<ul>
<li>amount: 要显示的标签数量（0 = 无限制）<br>amount | 要显示的标签数量（0 = 无限制） | 0</li>
</ul>
</li>
</ul>
</li>
<li><code>list_archives([options])</code>,<code>list_posts([options])</code><ul>
<li><code>options</code>相同配置:<ul>
<li>order</li>
<li>style</li>
<li>separator</li>
<li>class</li>
<li>transform</li>
<li>class (默认为archive或post)</li>
</ul>
</li>
<li>list_archives 特有的<code>options</code>:<ul>
<li>type:可为 yearly 或 monthly (默认为monthly)</li>
<li>show_count：显示每个归档的文章总数 （默认为true）</li>
<li>format：日期格式</li>
</ul>
</li>
<li>list_posts 特有的<code>options</code>:<ul>
<li>orderby：文章排列方式 （默认按 date）</li>
<li>amount：显示的文章数量（0 = 无限制）</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="header-57">6.7 Special</h3>
<ul>
<li><p><code>tagcloud([tags], [options])</code></p>
<table class="table">
<thead>
<tr>
<th>参数</th>
<th>描述</th>
<th>默认值</th>
</tr>
</thead>
<tbody>
<tr>
<td>min_font</td>
<td>最小字体尺寸</td>
<td>10</td>
</tr>
<tr>
<td>max_font</td>
<td>最大字体尺寸</td>
<td>20</td>
</tr>
<tr>
<td>unit</td>
<td>字体尺寸的单位</td>
<td>px</td>
</tr>
<tr>
<td>amount</td>
<td>标签总量</td>
<td>40</td>
</tr>
<tr>
<td>orderby</td>
<td>标签排列方式</td>
<td>name</td>
</tr>
<tr>
<td>order</td>
<td>标签排列顺序。1, sac 升序；-1, desc 降序</td>
<td>1</td>
</tr>
<tr>
<td>color</td>
<td>使用颜色</td>
<td>false</td>
</tr>
<tr>
<td>start_color</td>
<td>开始的颜色</td>
</tr>
<tr>
<td>end_color</td>
<td>结束的颜色</td>
</tr>
</tbody>
</table>
</li>
<li><p><code>paginator(options)</code> 插入分页链接</p>
<table class="table">
<thead>
<tr>
<th>参数</th>
<th>描述</th>
<th>默认值</th>
</tr>
</thead>
<tbody>
<tr>
<td>base</td>
<td>基础网址</td>
<td>/</td>
</tr>
<tr>
<td>format</td>
<td>网址格式</td>
<td>page/%d/</td>
</tr>
<tr>
<td>total</td>
<td>分页总数</td>
<td>1</td>
</tr>
<tr>
<td>current</td>
<td>目前页数</td>
<td>0</td>
</tr>
<tr>
<td>prev_text</td>
<td>上一页链接的文字</td>
<td>Prev</td>
</tr>
<tr>
<td>next_text</td>
<td>下一页链接的文字</td>
<td>Next</td>
</tr>
<tr>
<td>space</td>
<td>空白文字</td>
<td></td>
</tr>
<tr>
<td>prev_next</td>
<td>显示上一页和下一页的链接</td>
<td>true</td>
</tr>
<tr>
<td>end_size</td>
<td>显示于两侧的页数</td>
<td>1</td>
</tr>
<tr>
<td>mid_size</td>
<td>显示于中间的页数</td>
<td>2</td>
</tr>
<tr>
<td>show_all</td>
<td>显示所有页数</td>
<td>false</td>
</tr>
</tbody>
</table>
</li>
<li><p><code>search_form(options)</code> 插入 Google 搜索框</p>
<table class="table">
<thead>
<tr>
<th>参数</th>
<th>描述</th>
<th>默认值</th>
</tr>
</thead>
<tbody>
<tr>
<td>class</td>
<td>表单的 class name</td>
<td>search-form</td>
</tr>
<tr>
<td>text</td>
<td>搜索提示文字</td>
<td>Search</td>
</tr>
<tr>
<td>button</td>
<td>显示搜索按钮。此参数可为布尔值（boolean）或字符串，当设定是字符串的时候，即为搜索按钮的文字。</td>
<td>false</td>
</tr>
</tbody>
</table>
</li>
<li><p><code>toc(str, [options])</code> 解析内容中的标题标签 (h1~h6) 并插入目录</p>
<table class="table">
<thead>
<tr>
<th>参数</th>
<th>描述</th>
<th>默认值</th>
</tr>
</thead>
<tbody>
<tr>
<td>class</td>
<td>Class 名称</td>
<td>toc</td>
</tr>
<tr>
<td>list_number</td>
<td>显示编号</td>
<td>true</td>
</tr>
</tbody>
</table>
</li>
</ul>
<h3 id="header-58">6.8 其他</h3>
<p> 请参看源码</p>
<h2 id="header-59">Hexo标签插件</h2>
<p>源码在<code>/node_modules/hexo/lib/plugins/tag</code>下</p>
<hr>
<h2 id="header-60">References</h2>
<ul>
<li>Hexo 文档 <ul>
<li><a href="https://hexo.io" target="_blank" rel="noopener">官网</a></li>
<li><a href="https://hexo.io/zh-cn/docs/" target="_blank" rel="noopener">Doc</a> </li>
<li><a href="http://wiki.jikexueyuan.com/project/hexo-document/" target="_blank" rel="noopener">极客学院</a></li>
</ul>
</li>
<li>Hexo 博文<ul>
<li><a href="http://www.ituring.com.cn/minibook/29442" target="_blank" rel="noopener">Hexo Docs &amp; 站点实战</a></li>
<li><a href="http://opiece.me/tags/hexo/" target="_blank" rel="noopener">Chillax’s blog</a></li>
<li><a href="https://xuanwo.org/2014/08/14/hexo-usual-problem/" target="_blank" rel="noopener">Hexo常见问题解决方案</a></li>
</ul>
</li>
</ul>
  </section>
</article>

      <hr/>
      
<section class="post-comment">
	
		<div id="gitment_container"></div>

<link rel="stylesheet" href="/gitment/default.css">
<script src="/gitment/gitment.browser.js"></script>


<script type="text/javascript">
	var gitment = new Gitment({
	  owner: 'sixdegree',
	  repo: 'sixDegree.github.io',
	  oauth: {
	    client_id: '36a09bb7399efe69c6ce',
	    client_secret: 'f28f2c5fff964d8e5d1a6ebdee77e6a890a8ac94',
	  },
	})
	gitment.render('gitment_container')
</script>
	
</section>

    </div>
  </div>
</body>

<script src="/jquery/dist/jquery.min.js"></script>
<script src="/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/highlight/highlight.pack.js"></script>
<script type="text/javascript">
  hljs.initHighlightingOnLoad();
  
  $(document).ready(function(){
    var sidebarCtrl=$("#sidebar-ctrl");
    var sidebar=$("#sidebar");
    var wrapper=$("#wrapper");
    sidebarCtrl.on("click",function(event){
        //alert("click");
        sidebar.toggleClass("sidebar-toggle");
        wrapper.toggleClass("sidebar-toggle");
        sidebarCtrl.toggleClass("sidebar-toggle");
        sidebarCtrl.toggleClass("active");
    })
  });
</script>


</html>
